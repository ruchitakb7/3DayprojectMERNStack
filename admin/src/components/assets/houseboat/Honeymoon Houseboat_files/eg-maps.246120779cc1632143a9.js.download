/*@license For license information please refer to eg-maps.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4997],{39437:function(e){window,e.exports=function(){var e={496:function(e,t,i){e.exports=function(){var e={712:function(e,t){var i=t.O={};i.read=function(e,t){return e.readFields(i._readField,{dictionary:null,content:null},t)},i._readField=function(e,t,r){1===e?t.dictionary=i.Dictionary.read(r,r.readVarint()+r.pos):2===e&&(t.content=i.Content.read(r,r.readVarint()+r.pos))},i.Dictionary={},i.Dictionary.read=function(e,t){return e.readFields(i.Dictionary._readField,{constants:[]},t)},i.Dictionary._readField=function(e,t,i){1===e&&t.constants.push(i.readString())},i.Feature={},i.Feature.read=function(e,t){return e.readFields(i.Feature._readField,{type:0,id:"",latitude:0,longitude:0,name:"",classifiers:[]},t)},i.Feature._readField=function(e,t,i){1===e?t.type=i.readVarint():2===e?t.id=i.readString():3===e?t.latitude=i.readVarint(!0):4===e?t.longitude=i.readVarint(!0):5===e?t.name=i.readString():6===e&&i.readPackedVarint(t.classifiers,!0)},i.Feature.Type={UNKNOWN:{value:0,options:{}},PLACE:{value:1,options:{}},PROPERTY:{value:2,options:{}}},i.Content={},i.Content.read=function(e,t){return e.readFields(i.Content._readField,{features:[]},t)},i.Content._readField=function(e,t,r){1===e&&t.features.push(i.Feature.read(r,r.readVarint()+r.pos))}}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,r),s.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){r.r(n),r.d(n,{EGTSCodec:function(){return u}});var e=i(766),t=r.n(e),s=r(712);function o(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw s}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var i,r,n;return i=e,(r=[{key:"decode",value:function(e){var i=this;return new Promise((function(r){var n,a=new(t())(e),l=s.O.read(a),u=[],h=o(l.content.features);try{for(h.s();!(n=h.n()).done;){var d=n.value;u.push({id:d.id,type:i._getType(d.type),lat:d.latitude/1e6-90,lng:d.longitude/1e6-180,name:d.name,qualifiers:d.classifiers.map((function(e){return l.dictionary.constants[e]}))})}}catch(e){h.e(e)}finally{h.f()}r(u)}))}},{key:"_getType",value:function(e){for(var t in s.O.Feature.Type)if(s.O.Feature.Type[t].value===e)return t.toLowerCase()}}])&&l(i.prototype,r),n&&l(i,n),e}()}(),n}()},223:function(){},908:function(e){e.exports=function(){function e(s,o){if(!(this instanceof e))return new e(s,o);o=Object.assign({},i,o);var a=Math.pow(10,o.precision);this.intValue=s=t(s,o),this.value=s/a,o.increment=o.increment||1/a,o.groups=o.useVedic?n:r,this.s=o,this.p=a}function t(t,i){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=i.decimal,s=i.errorOnInvalid,o=i.fromCents,a=Math.pow(10,i.precision),l=t instanceof e;if(l&&o)return t.intValue;if("number"==typeof t||l)n=l?t.value:t;else if("string"==typeof t)s=new RegExp("[^-\\d"+n+"]","g"),n=new RegExp("\\"+n,"g"),n=(n=t.replace(/\((.*)\)/,"-$1").replace(s,"").replace(n,"."))||0;else{if(s)throw Error("Invalid Input");n=0}return o||(n=(n*a).toFixed(4)),r?Math.round(n):n}var i={symbol:"$",separator:",",decimal:".",errorOnInvalid:!1,precision:2,pattern:"!#",negativePattern:"-!#",format:function(e,t){var i=t.pattern,r=t.negativePattern,n=t.symbol,s=t.separator,o=t.decimal;t=t.groups;var a=(""+e).replace(/^-/,"").split("."),l=a[0];return a=a[1],(0<=e.value?i:r).replace("!",n).replace("#",l.replace(t,"$1"+s)+(a?o+a:""))},fromCents:!1},r=/(\d)(?=(\d{3})+\b)/g,n=/(\d)(?=(\d\d)+\d\b)/g;return e.prototype={add:function(i){var r=this.s,n=this.p;return e((this.intValue+t(i,r))/(r.fromCents?1:n),r)},subtract:function(i){var r=this.s,n=this.p;return e((this.intValue-t(i,r))/(r.fromCents?1:n),r)},multiply:function(t){var i=this.s;return e(this.intValue*t/(i.fromCents?1:Math.pow(10,i.precision)),i)},divide:function(i){var r=this.s;return e(this.intValue/t(i,r,!1),r)},distribute:function(t){var i=this.intValue,r=this.p,n=this.s,s=[],o=Math[0<=i?"floor":"ceil"](i/t),a=Math.abs(i-o*t);for(r=n.fromCents?1:r;0!==t;t--){var l=e(o/r,n);0<a--&&(l=l[0<=i?"add":"subtract"](1/r)),s.push(l)}return s},dollars:function(){return~~this.value},cents:function(){return~~(this.intValue%this.p)},format:function(e){var t=this.s;return"function"==typeof e?e(this,t):t.format(this,Object.assign({},t,e))},toString:function(){var e=this.s,t=e.increment;return(Math.round(this.intValue/this.p/t)*t).toFixed(e.precision)},toJSON:function(){return this.value}},e}()},328:function(e,t){t.read=function(e,t,i,r,n){var s,o,a=8*n-r-1,l=(1<<a)-1,u=l>>1,h=-7,d=i?n-1:0,c=i?-1:1,p=e[t+d];for(d+=c,s=p&(1<<-h)-1,p>>=-h,h+=a;h>0;s=256*s+e[t+d],d+=c,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=r;h>0;o=256*o+e[t+d],d+=c,h-=8);if(0===s)s=1-u;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),s-=u}return(p?-1:1)*o*Math.pow(2,s-r)},t.write=function(e,t,i,r,n,s){var o,a,l,u=8*s-n-1,h=(1<<u)-1,d=h>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,g=r?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=h):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?c/l:c*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=h?(a=0,o=h):o+d>=1?(a=(t*l-1)*Math.pow(2,n),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;e[i+p]=255&a,p+=g,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;e[i+p]=255&o,p+=g,o/=256,u-=8);e[i+p-g]|=128*f}},766:function(e,t,i){e.exports=n;var r=i(328);function n(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,o=1/s,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function l(e){return e.type===n.Bytes?e.readVarint()+e.pos:e.pos+1}function u(e,t,i){return i?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function h(e,t,i){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=e;n--)i.buf[n+r]=i.buf[n]}function d(e,t){for(var i=0;i<e.length;i++)t.writeVarint(e[i])}function c(e,t){for(var i=0;i<e.length;i++)t.writeSVarint(e[i])}function p(e,t){for(var i=0;i<e.length;i++)t.writeFloat(e[i])}function g(e,t){for(var i=0;i<e.length;i++)t.writeDouble(e[i])}function f(e,t){for(var i=0;i<e.length;i++)t.writeBoolean(e[i])}function m(e,t){for(var i=0;i<e.length;i++)t.writeFixed32(e[i])}function y(e,t){for(var i=0;i<e.length;i++)t.writeSFixed32(e[i])}function v(e,t){for(var i=0;i<e.length;i++)t.writeFixed64(e[i])}function b(e,t){for(var i=0;i<e.length;i++)t.writeSFixed64(e[i])}function k(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function M(e,t,i){e[i]=t,e[i+1]=t>>>8,e[i+2]=t>>>16,e[i+3]=t>>>24}function P(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}n.prototype={destroy:function(){this.buf=null},readFields:function(e,t,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,s=this.pos;this.type=7&r,e(n,t,this),this.pos===s&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=k(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=P(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=k(this.buf,this.pos)+k(this.buf,this.pos+4)*s;return this.pos+=8,e},readSFixed64:function(){var e=k(this.buf,this.pos)+P(this.buf,this.pos+4)*s;return this.pos+=8,e},readFloat:function(){var e=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,i,r=this.buf;return t=127&(i=r[this.pos++]),i<128?t:(t|=(127&(i=r[this.pos++]))<<7,i<128?t:(t|=(127&(i=r[this.pos++]))<<14,i<128?t:(t|=(127&(i=r[this.pos++]))<<21,i<128?t:function(e,t,i){var r,n,s=i.buf;if(r=(112&(n=s[i.pos++]))>>4,n<128)return u(e,r,t);if(r|=(127&(n=s[i.pos++]))<<3,n<128)return u(e,r,t);if(r|=(127&(n=s[i.pos++]))<<10,n<128)return u(e,r,t);if(r|=(127&(n=s[i.pos++]))<<17,n<128)return u(e,r,t);if(r|=(127&(n=s[i.pos++]))<<24,n<128)return u(e,r,t);if(r|=(1&(n=s[i.pos++]))<<31,n<128)return u(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(i=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&a?function(e,t,i){return a.decode(e.subarray(t,i))}(this.buf,t,e):function(e,t,i){for(var r="",n=t;n<i;){var s,o,a,l=e[n],u=null,h=l>239?4:l>223?3:l>191?2:1;if(n+h>i)break;1===h?l<128&&(u=l):2===h?128==(192&(s=e[n+1]))&&(u=(31&l)<<6|63&s)<=127&&(u=null):3===h?(s=e[n+1],o=e[n+2],128==(192&s)&&128==(192&o)&&((u=(15&l)<<12|(63&s)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===h&&(s=e[n+1],o=e[n+2],a=e[n+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((u=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,h=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),n+=h}return r}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==n.Bytes)return e.push(this.readVarint(t));var i=l(this);for(e=e||[];this.pos<i;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==n.Bytes)return e.push(this.readSVarint());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==n.Bytes)return e.push(this.readBoolean());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==n.Bytes)return e.push(this.readFloat());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==n.Bytes)return e.push(this.readDouble());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==n.Bytes)return e.push(this.readFixed32());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==n.Bytes)return e.push(this.readSFixed32());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==n.Bytes)return e.push(this.readFixed64());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==n.Bytes)return e.push(this.readSFixed64());var t=l(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===n.Varint)for(;this.buf[this.pos++]>127;);else if(t===n.Bytes)this.pos=this.readVarint()+this.pos;else if(t===n.Fixed32)this.pos+=4;else{if(t!==n.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var i=new Uint8Array(t);i.set(this.buf),this.buf=i,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),M(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),M(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),M(this.buf,-1&e,this.pos),M(this.buf,Math.floor(e*o),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),M(this.buf,-1&e,this.pos),M(this.buf,Math.floor(e*o),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var i,r;if(e>=0?(i=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,r=r+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,i){i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos++]=127&e|128,e>>>=7,i.buf[i.pos]=127&e}(i,0,t),function(e,t){var i=(7&e)<<4;t.buf[t.pos++]|=i|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,i){for(var r,n,s=0;s<t.length;s++){if((r=t.charCodeAt(s))>55295&&r<57344){if(!n){r>56319||s+1===t.length?(e[i++]=239,e[i++]=191,e[i++]=189):n=r;continue}if(r<56320){e[i++]=239,e[i++]=191,e[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(e[i++]=239,e[i++]=191,e[i++]=189,n=null);r<128?e[i++]=r:(r<2048?e[i++]=r>>6|192:(r<65536?e[i++]=r>>12|224:(e[i++]=r>>18|240,e[i++]=r>>12&63|128),e[i++]=r>>6&63|128),e[i++]=63&r|128)}return i}(this.buf,e,this.pos);var i=this.pos-t;i>=128&&h(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeFloat:function(e){this.realloc(4),r.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),r.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var i=0;i<t;i++)this.buf[this.pos++]=e[i]},writeRawMessage:function(e,t){this.pos++;var i=this.pos;e(t,this);var r=this.pos-i;r>=128&&h(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,i){this.writeTag(e,n.Bytes),this.writeRawMessage(t,i)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,d,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,c,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,f,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,p,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,g,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,m,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,y,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,v,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,b,t)},writeBytesField:function(e,t){this.writeTag(e,n.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,n.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,n.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,n.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,n.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,n.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,n.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,n.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,n.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,n.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}}},569:function(e){!function(){var t=function(e){return(e="number"==typeof e?{precision:e}:e||{}).precision=e.precision||5,e.factor=e.factor||Math.pow(10,e.precision),e.dimension=e.dimension||2,e},i={encode:function(e,i){i=t(i);for(var r=[],n=0,s=e.length;n<s;++n){var o=e[n];if(2===i.dimension)r.push(o.lat||o[0]),r.push(o.lng||o[1]);else for(var a=0;a<i.dimension;++a)r.push(o[a])}return this.encodeDeltas(r,i)},decode:function(e,i){i=t(i);for(var r=this.decodeDeltas(e,i),n=[],s=0,o=r.length;s+(i.dimension-1)<o;){for(var a=[],l=0;l<i.dimension;++l)a.push(r[s++]);n.push(a)}return n},encodeDeltas:function(e,i){i=t(i);for(var r=[],n=0,s=e.length;n<s;)for(var o=0;o<i.dimension;++o,++n){var a=e[n].toFixed(i.precision),l=a-(r[o]||0);r[o]=a,e[n]=l}return this.encodeFloats(e,i)},decodeDeltas:function(e,i){i=t(i);for(var r=[],n=this.decodeFloats(e,i),s=0,o=n.length;s<o;)for(var a=0;a<i.dimension;++a,++s)n[s]=Math.round((r[a]=n[s]+(r[a]||0))*i.factor)/i.factor;return n},encodeFloats:function(e,i){i=t(i);for(var r=0,n=e.length;r<n;++r)e[r]=Math.round(e[r]*i.factor);return this.encodeSignedIntegers(e)},decodeFloats:function(e,i){i=t(i);for(var r=this.decodeSignedIntegers(e),n=0,s=r.length;n<s;++n)r[n]/=i.factor;return r},encodeSignedIntegers:function(e){for(var t=0,i=e.length;t<i;++t){var r=e[t];e[t]=r<0?~(r<<1):r<<1}return this.encodeUnsignedIntegers(e)},decodeSignedIntegers:function(e){for(var t=this.decodeUnsignedIntegers(e),i=0,r=t.length;i<r;++i){var n=t[i];t[i]=1&n?~(n>>1):n>>1}return t},encodeUnsignedIntegers:function(e){for(var t="",i=0,r=e.length;i<r;++i)t+=this.encodeUnsignedInteger(e[i]);return t},decodeUnsignedIntegers:function(e){for(var t=[],i=0,r=0,n=0,s=e.length;n<s;++n){var o=e.charCodeAt(n)-63;i|=(31&o)<<r,o<32?(t.push(i),i=0,r=0):r+=5}return t},encodeSignedInteger:function(e){return e=e<0?~(e<<1):e<<1,this.encodeUnsignedInteger(e)},encodeUnsignedInteger:function(e){for(var t,i="";e>=32;)t=63+(32|31&e),i+=String.fromCharCode(t),e>>=5;return t=e+63,i+String.fromCharCode(t)}};if("object"==typeof e.exports&&(e.exports=i),"object"==typeof L){L.Polyline.prototype.fromEncoded||(L.Polyline.fromEncoded=function(e,t){return L.polyline(i.decode(e),t)}),L.Polygon.prototype.fromEncoded||(L.Polygon.fromEncoded=function(e,t){return L.polygon(i.decode(e),t)});var r={encodePath:function(){return i.encode(this.getLatLngs())}};L.Polyline.prototype.encodePath||L.Polyline.include(r),L.Polygon.prototype.encodePath||L.Polygon.include(r),L.PolylineUtil=i}}()}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return function(){i.r(r),i.d(r,{Animation:function(){return s},BaseMap:function(){return xs},BrowserUtils:function(){return n},Cache:function(){return Ii},ConfigHelper:function(){return Bs},ConfigLoader:function(){return Fi},ConsoleLogger:function(){return bi},EGMap:function(){return Gs},EventTypes:function(){return or},EventsManager:function(){return ar},Geo:function(){return o},HtmlUtils:function(){return e},I18n:function(){return Ei},IconUtils:function(){return a},KeyboardFeatures:function(){return Ir},KeyboardListeners:function(){return zr},Labels:function(){return l},Level:function(){return mi},Logger:function(){return vi},MarkerUtils:function(){return u},TilesLoader:function(){return Ws},Utils:function(){return t},debugOptions:function(){return xi},defaultConfig:function(){return zs},defaultIcons:function(){return js},i18nKeys:function(){return fr},icons:function(){return js},identifyUpdates:function(){return Rs},newLogger:function(){return yi},newMapData:function(){return ws},ttlCache:function(){return Ai}});var e={};i.r(e),i.d(e,{addClass:function(){return rt},addClasses:function(){return nt},addNewCssStyle:function(){return Ct},anyChildrenMatching:function(){return ue},anyChildrenWithAriaRoleDescription:function(){return oe},anyChildrenWithClasses:function(){return ne},areRectPointsAndCircleIntersecting:function(){return Ye},areRectsIntersecting:function(){return Qe},changeImgSrc:function(){return $e},changeSpanTextContent:function(){return X},changeStyles:function(){return Ne},changeTextNodeContent:function(){return Y},childNodesAsArray:function(){return te},childrenAsArray:function(){return ee},clearAriaLabel:function(){return He},clearStyle:function(){return ht},createButton:function(){return ke},createCheckbox:function(){return Ce},createDiv:function(){return me},createH1:function(){return Pe},createH2:function(){return Le},createHtml:function(){return G},createImg:function(){return _e},createInput:function(){return fe},createLabel:function(){return be},createLi:function(){return ve},createSpan:function(){return Me},createTextNode:function(){return Q},createUl:function(){return ye},detachElement:function(){return pe},documentIsDefined:function(){return J},eltAsString:function(){return q},eltHashCode:function(){return W},findChildIndex:function(){return le},getClasses:function(){return it},getDistanceBetweenPoints:function(){return mt},getDistanceToMoveRect:function(){return dt},getFirstChildWithAriaRoleDescription:function(){return ae},getFirstChildWithClasses:function(){return se},getIntersection:function(){return vt},getMaxRect:function(){return pt},getMovedRect:function(){return gt},getRect:function(){return ct},getRectCenter:function(){return ft},getRectIntersectionCandidates:function(){return yt},globalObject:function(){return _t},hasAriaLabel:function(){return xe},hasClass:function(){return Ge},insertChild:function(){return bt},intersectionBottomSide:function(){return Lt},intersectionLeftSide:function(){return Pt},intersectionRightSide:function(){return kt},intersectionTopSide:function(){return Mt},inverseClass:function(){return Xe},isAnHtmlElement:function(){return H},isDisplayed:function(){return ze},isPointIntersectingCircle:function(){return Je},reattachElement:function(){return ge},removeAllChildren:function(){return he},removeAriaLabel:function(){return Fe},removeAriaLive:function(){return Se},removeChildById:function(){return ce},removeClass:function(){return st},removeClasses:function(){return ot},removeElementById:function(){return de},replaceClasses:function(){return at},replaceClassesAndStyle:function(){return ut},replaceStyle:function(){return lt},setAriaHidden:function(){return Ee},setAriaLabel:function(){return we},setAriaLabelledBy:function(){return Oe},setAriaLivePolite:function(){return Ie},setButtonRole:function(){return Te},setDisplay:function(){return Ke},setDisplayNone:function(){return Ve},setPosition:function(){return qe},setPositionAttributes:function(){return We},setPresentationRole:function(){return Ae},setRole:function(){return De},setTabIndex:function(){return Re},setWidthAndHeight:function(){return Ze},setZIndex:function(){return Ue},setupTabAccessible:function(){return Be},switchClass:function(){return et},switchClasses:function(){return tt},unsetDisplayNone:function(){return je}});var t={};i.r(t),i.d(t,{arrayEquals:function(){return Ut},camelCaseToKebabCase:function(){return ei},camelCaseToSnakeCase:function(){return ii},capitalizeString:function(){return Et},chunkArray:function(){return Tt},cleanCoordinatesArray:function(){return Nt},compareBounds:function(){return zt},convertToCurrency:function(){return gi},countDecimals:function(){return $t},fastHash:function(){return Yt},firstDefinedKey:function(){return xt},firstDefinedValue:function(){return wt},firstDefinedValueAndKey:function(){return Ft},getBalancedRate:function(){return hi},getMinPrice:function(){return Ht},getMultiLineLabelText:function(){return di},getPaddedZoomAndCenter:function(){return li},getPaddingPixels:function(){return oi},hashCode:function(){return pi},identifyDecimalSeparatorForPrice:function(){return Zt},intToHexString:function(){return Qt},isArray:function(){return St},isObject:function(){return It},kebabCaseToCamelCase:function(){return Jt},listHashKeysSorted:function(){return qt},opacityDecimalToHex:function(){return Gt},parseClientPadding:function(){return ai},randomAlphaNumeric:function(){return Xt},removeDuplicates:function(){return Bt},round:function(){return Vt},roundLatLng:function(){return jt},roundLatOrLng:function(){return Kt},roundZoom:function(){return Rt},snakeCaseToCamelCase:function(){return ti},sortDeeplyObjectAndArray:function(){return At},sortHashKeys:function(){return si},splitLabelTextIntoLines:function(){return ui},stringify:function(){return Dt},transformHistoricalBboxOutput:function(){return ri},undefNullEmpty:function(){return Ot},verifyKeyIsLegal:function(){return ci}});var n={};i.r(n),i.d(n,{getCookieValue:function(){return _i},promiseAllSettled:function(){return Li},timeoutFetch:function(){return Ci}});var s={};i.r(s),i.d(s,{bounce:function(){return Oi}});var o={};i.r(o),i.d(o,{addMeterToLat:function(){return Wi},areBoundsCrossingDateLine:function(){return $i},areCoordinatesCrossingDateLine:function(){return zi},areLongitudesCrossingDateLine:function(){return ji},computeTileDistance:function(){return qi},computeTilesIds:function(){return Ni},computeZoomFromBBox:function(){return Bi},convertGeoJsonPolygonToPath:function(){return Gi},directionFromOrigin:function(){return Zi},furthestLatOrLong:function(){return Ui}});var a={};i.r(a),i.d(a,{areIconsDifferent:function(){return ir},ensureImageIsLoaded:function(){return tr},events:function(){return Qi},extractImgSourcesFromIcons:function(){return Xi},flatIcons:function(){return er},flatSuppIcons:function(){return Ji},preloadIcons:function(){return Yi}});var l={};i.r(l),i.d(l,{createLabels:function(){return En},getLabelVisibilityConfigByFeatureKeyAndZoom:function(){return Sn},getRectOfMarkerLabel:function(){return Tn},hideTextLabelsForZoomLevel:function(){return In},isTextLabelHiddenAtZoomLevel:function(){return On},labelPositions:function(){return xn},textLabelHiddenCssClass:function(){return _n},textSubLabelHiddenCssClass:function(){return wn}});var u={};i.r(u),i.d(u,{bounceMarker:function(){return Wn},cleanMarkerListeners:function(){return fs},cloneObfuscatedPolygon:function(){return cs},createBasicTextMarker:function(){return $n},createClusterMarker:function(){return hs},createCornerIcons:function(){return Qn},createDoubleClickEventCanceller:function(){return ns},createImageIcon:function(){return zn},createInnerIcons:function(){return Xn},createObfuscatedMarker:function(){return ds},createPinMarker:function(){return os},createTextMarker:function(){return ls},events:function(){return jn},fillWithMarkerInfo:function(){return ps},finalizeMarkerCreation:function(){return as},fixMarkerToUse:function(){return ys},haveCornerIconsChanged:function(){return Jn},haveInnerIconsChanged:function(){return es},identifyCornerIcons:function(){return is},identifyInnerIcons:function(){return rs},identifyMarkerProperties:function(){return Zn},prepareCreateMarker:function(){return ms},registerCompListeners:function(){return gs},setMarkerZIndex:function(){return qn},shouldRecreateMarker:function(){return vs},switchHtmlAriaLabel:function(){return ss},updatePinMarkerIcon:function(){return Hn}}),i(223);var h=6371008.8,d={centimeters:637100880,centimetres:637100880,degrees:360/(2*Math.PI),feet:20902260.511392,inches:39.37*h,kilometers:6371.0088,kilometres:6371.0088,meters:h,metres:h,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:h/1852,radians:1,yards:6967335.223679999};function c(e,t,i={}){const r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=t||{},r.geometry=e,r}function p(e,t,i={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!v(e[0])||!v(e[1]))throw new Error("coordinates must contain numbers");return c({type:"Point",coordinates:e},t,i)}function g(e,t,i={}){for(const r of e){if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(r[r.length-1].length!==r[0].length)throw new Error("First and last Position are not equivalent.");for(let e=0;e<r[r.length-1].length;e++)if(r[r.length-1][e]!==r[0][e])throw new Error("First and last Position are not equivalent.")}return c({type:"Polygon",coordinates:e},t,i)}function f(e,t="kilometers"){const i=d[t];if(!i)throw new Error(t+" units is invalid");return e/i}function m(e){return e%(2*Math.PI)*180/Math.PI}function y(e){return e%360*Math.PI/180}function v(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function b(e,t,i,r={}){const n=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return[...e.geometry.coordinates];if("Point"===e.type)return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}(e),s=y(n[0]),o=y(n[1]),a=y(i),l=f(t,r.units),u=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(a));return p([m(s+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(u))),m(u)],r.properties)}var k=function(e,t,i={}){const r=i.steps||64,n=i.properties?i.properties:!Array.isArray(e)&&"Feature"===e.type&&e.properties?e.properties:{},s=[];for(let o=0;o<r;o++)s.push(b(e,t,-360*o/r,i).geometry.coordinates);return s.push(s[0]),g([s],n)};class M{constructor(){}getClustersAndFeatures(e,t,i,r,n,s,o){throw new Error("method getClustersAndFeatures not implemented")}}function P(e,t,i,r,n,s){if(n-r<=i)return;const o=r+n>>1;L(e,t,o,r,n,s%2),P(e,t,i,r,o-1,s+1),P(e,t,i,o+1,n,s+1)}function L(e,t,i,r,n,s){for(;n>r;){if(n-r>600){const o=n-r+1,a=i-r+1,l=Math.log(o),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(o-u)/o)*(a-o/2<0?-1:1);L(e,t,i,Math.max(r,Math.floor(i-a*u/o+h)),Math.min(n,Math.floor(i+(o-a)*u/o+h)),s)}const o=t[2*i+s];let a=r,l=n;for(C(e,t,r,i),t[2*n+s]>o&&C(e,t,r,n);a<l;){for(C(e,t,a,l),a++,l--;t[2*a+s]<o;)a++;for(;t[2*l+s]>o;)l--}t[2*r+s]===o?C(e,t,r,l):(l++,C(e,t,l,n)),l<=i&&(r=l+1),i<=l&&(n=l-1)}}function C(e,t,i,r){_(e,i,r),_(t,2*i,2*r),_(t,2*i+1,2*r+1)}function _(e,t,i){const r=e[t];e[t]=e[i],e[i]=r}function w(e,t,i,r){const n=e-i,s=t-r;return n*n+s*s}const x=e=>e[0],F=e=>e[1];class O{constructor(e,t=x,i=F,r=64,n=Float64Array){this.nodeSize=r,this.points=e;const s=e.length<65536?Uint16Array:Uint32Array,o=this.ids=new s(e.length),a=this.coords=new n(2*e.length);for(let l=0;l<e.length;l++)o[l]=l,a[2*l]=t(e[l]),a[2*l+1]=i(e[l]);P(o,a,r,0,o.length-1,0)}range(e,t,i,r){return function(e,t,i,r,n,s,o){const a=[0,e.length-1,0],l=[];let u,h;for(;a.length;){const d=a.pop(),c=a.pop(),p=a.pop();if(c-p<=o){for(let o=p;o<=c;o++)u=t[2*o],h=t[2*o+1],u>=i&&u<=n&&h>=r&&h<=s&&l.push(e[o]);continue}const g=Math.floor((p+c)/2);u=t[2*g],h=t[2*g+1],u>=i&&u<=n&&h>=r&&h<=s&&l.push(e[g]);const f=(d+1)%2;(0===d?i<=u:r<=h)&&(a.push(p),a.push(g-1),a.push(f)),(0===d?n>=u:s>=h)&&(a.push(g+1),a.push(c),a.push(f))}return l}(this.ids,this.coords,e,t,i,r,this.nodeSize)}within(e,t,i){return function(e,t,i,r,n,s){const o=[0,e.length-1,0],a=[],l=n*n;for(;o.length;){const u=o.pop(),h=o.pop(),d=o.pop();if(h-d<=s){for(let n=d;n<=h;n++)w(t[2*n],t[2*n+1],i,r)<=l&&a.push(e[n]);continue}const c=Math.floor((d+h)/2),p=t[2*c],g=t[2*c+1];w(p,g,i,r)<=l&&a.push(e[c]);const f=(u+1)%2;(0===u?i-n<=p:r-n<=g)&&(o.push(d),o.push(c-1),o.push(f)),(0===u?i+n>=p:r+n>=g)&&(o.push(c+1),o.push(h),o.push(f))}return a}(this.ids,this.coords,e,t,i,this.nodeSize)}}const E={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},I=Math.fround||(S=new Float32Array(1),e=>(S[0]=+e,S[0]));var S;class D{constructor(e){this.options=j(Object.create(E),e),this.trees=new Array(this.options.maxZoom+1)}load(e){const{log:t,minZoom:i,maxZoom:r,nodeSize:n}=this.options;t&&console.time("total time");const s=`prepare ${e.length} points`;t&&console.time(s),this.points=e;let o=[];for(let a=0;a<e.length;a++)e[a].geometry&&o.push(T(e[a],a));this.trees[r+1]=new O(o,z,$,n,Float32Array),t&&console.timeEnd(s);for(let a=r;a>=i;a--){const e=+Date.now();o=this._cluster(o,a),this.trees[a]=new O(o,z,$,n,Float32Array),t&&console.log("z%d: %d clusters in %dms",a,o.length,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let i=((e[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[1]));let n=180===e[2]?180:((e[2]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)i=-180,n=180;else if(i>n){const e=this.getClusters([i,r,180,s],t),o=this.getClusters([-180,r,n,s],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],a=o.range(N(i),K(s),N(n),K(r)),l=[];for(const u of a){const e=o.points[u];l.push(e.numPoints?B(e):this.points[e.index])}return l}getChildren(e){const t=this._getOriginId(e),i=this._getOriginZoom(e),r="No cluster with the specified id.",n=this.trees[i];if(!n)throw new Error(r);const s=n.points[t];if(!s)throw new Error(r);const o=this.options.radius/(this.options.extent*Math.pow(2,i-1)),a=n.within(s.x,s.y,o),l=[];for(const u of a){const t=n.points[u];t.parentId===e&&l.push(t.numPoints?B(t):this.points[t.index])}if(0===l.length)throw new Error(r);return l}getLeaves(e,t,i){t=t||10,i=i||0;const r=[];return this._appendLeaves(r,e,t,i,0),r}getTile(e,t,i){const r=this.trees[this._limitZoom(e)],n=Math.pow(2,e),{extent:s,radius:o}=this.options,a=o/s,l=(i-a)/n,u=(i+1+a)/n,h={features:[]};return this._addTileFeatures(r.range((t-a)/n,l,(t+1+a)/n,u),r.points,t,i,n,h),0===t&&this._addTileFeatures(r.range(1-a/n,l,1,u),r.points,n,i,n,h),t===n-1&&this._addTileFeatures(r.range(0,l,a/n,u),r.points,-1,i,n,h),h.features.length?h:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const i=this.getChildren(e);if(t++,1!==i.length)break;e=i[0].properties.cluster_id}return t}_appendLeaves(e,t,i,r,n){const s=this.getChildren(t);for(const o of s){const t=o.properties;if(t&&t.cluster?n+t.point_count<=r?n+=t.point_count:n=this._appendLeaves(e,t.cluster_id,i,r,n):n<r?n++:e.push(o),e.length===i)break}return n}_addTileFeatures(e,t,i,r,n,s){for(const o of e){const e=t[o],a=e.numPoints;let l,u,h;if(a)l=R(e),u=e.x,h=e.y;else{const t=this.points[e.index];l=t.properties,u=N(t.geometry.coordinates[0]),h=K(t.geometry.coordinates[1])}const d={type:1,geometry:[[Math.round(this.options.extent*(u*n-i)),Math.round(this.options.extent*(h*n-r))]],tags:l};let c;a?c=e.id:this.options.generateId?c=e.index:this.points[e.index].id&&(c=this.points[e.index].id),void 0!==c&&(d.id=c),s.features.push(d)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const i=[],{radius:r,extent:n,reduce:s,minPoints:o}=this.options,a=r/(n*Math.pow(2,t));for(let l=0;l<e.length;l++){const r=e[l];if(r.zoom<=t)continue;r.zoom=t;const n=this.trees[t+1],u=n.within(r.x,r.y,a),h=r.numPoints||1;let d=h;for(const e of u){const i=n.points[e];i.zoom>t&&(d+=i.numPoints||1)}if(d>h&&d>=o){let e=r.x*h,o=r.y*h,a=s&&h>1?this._map(r,!0):null;const c=(l<<5)+(t+1)+this.points.length;for(const i of u){const l=n.points[i];if(l.zoom<=t)continue;l.zoom=t;const u=l.numPoints||1;e+=l.x*u,o+=l.y*u,l.parentId=c,s&&(a||(a=this._map(r,!0)),s(a,this._map(l)))}r.parentId=c,i.push(A(e/d,o/d,c,d,a))}else if(i.push(r),d>1)for(const e of u){const r=n.points[e];r.zoom<=t||(r.zoom=t,i.push(r))}}return i}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?j({},e.properties):e.properties;const i=this.points[e.index].properties,r=this.options.map(i);return t&&r===i?j({},r):r}}function A(e,t,i,r,n){return{x:I(e),y:I(t),zoom:1/0,id:i,parentId:-1,numPoints:r,properties:n}}function T(e,t){const[i,r]=e.geometry.coordinates;return{x:I(N(i)),y:I(K(r)),zoom:1/0,index:t,parentId:-1}}function B(e){return{type:"Feature",id:e.id,properties:R(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),V(e.y)]}};var t}function R(e){const t=e.numPoints,i=t>=1e4?`${Math.round(t/1e3)}k`:t>=1e3?Math.round(t/100)/10+"k":t;return j(j({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:i})}function N(e){return e/360+.5}function K(e){const t=Math.sin(e*Math.PI/180),i=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return i<0?0:i>1?1:i}function V(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function j(e,t){for(const i in t)e[i]=t[i];return e}function z(e){return e.x}function $(e){return e.y}var U=i(908),Z=i.n(U);function H(e){return!!e&&void 0!==e.nodeName}function q(e){if(e)return e.outerHTML}function W(e){if(e)return pi(q(e))}function G(e,t,i,r,n,s,o){let a=document.createElement(t);return e&&(a.id=e),n&&(a.style.cssText=n),r&&(a.className=r),o&&rt(a,o),i&&i.appendChild(a),s&&s.length>0&&Q(a,s),a}function Q(e,t){const i=document.createTextNode(t);return e&&e.appendChild(i),i}function X(e,t){const i=te(e).filter((e=>e.nodeType===Node.TEXT_NODE));return 1===i.length&&(Y(i[0],t),!0)}function Y(e,t){e&&(e.nodeValue=t)}function J(){return void 0!==document}function ee(e){const t=[];if(null!=e&&e.children)for(let i=0;i<e.children.length;i++)t.push(e.children[i]);return t}function te(e){const t=[];if(null!=e&&e.childNodes)for(let i=0;i<e.childNodes.length;i++)t.push(e.childNodes[i]);return t}function ie(e){return e?t=>{if("string"==typeof t.className){var i;const r=(null===(i=t.className)||void 0===i?void 0:i.split(" "))||[];return e.every((e=>r.includes(e)))}return!1}:e=>!0}function re(e){return t=>(null==t?void 0:t.getAttribute("aria-roledescription"))===e}function ne(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ue(e,ie(t),i)}function se(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null===(i=ue(e,ie(t),r,!0))||void 0===i||null===(i=i[0])||void 0===i?void 0:i.element}function oe(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ue(e,re(t),i)}function ae(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null===(i=ue(e,re(t),r,!0))||void 0===i||null===(i=i[0])||void 0===i?void 0:i.element}function le(e){if(e){const t=e.parentNode;return Array.prototype.indexOf.call(t.children,e)}return-1}function ue(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(e&&e.children){for(let i=0;i<e.children.length;i++){const s=e.children[i];if(s&&t(s)&&(n.push({element:s,parent:e,index:i}),r))return n}for(let s=0;s<e.children.length;s++){const o=e.children[s];if(o&&i&&(ue(o,t,i,r,n),r&&n.length>0))return n}}return n}function he(e){if(e)for(;e.lastElementChild;)e.removeChild(e.lastElementChild);return e}function de(e){const t=document.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}function ce(e,t){if(e){const i=document.getElementById(t);i&&i.parentNode&&i.parentNode===e&&e.removeChild(i)}}function pe(e){var t;e&&(null===(t=e.parentNode)||void 0===t||t.removeChild(e))}function ge(e,t){var i;e&&(null===(i=e.parentNode)||void 0===i||i.removeChild(e),null==t||t.appendChild(e))}function fe(e,t,i,r,n,s,o,a){const l=G(e,"input",i,r,n,void 0,a);return l.type=t,s&&(l.value=s),we(l,o),l}function me(e,t,i,r,n){return G(e,"div",t,i,r,void 0,n)}function ye(e,t,i,r,n){return G(e,"ul",t,i,r,void 0,n)}function ve(e,t,i,r,n,s){return G(e,"li",t,i,r,n,s)}function be(e,t,i,r,n,s){return G(e,"label",t,i,r,n,s)}function ke(e,t,i,r,n,s){return G(e,"button",t,i,r,n,s)}function Me(e,t,i,r,n,s){return G(e,"span",t,i,r,n,s)}function Pe(e,t,i,r,n,s){return G(e,"h1",t,i,r,n,s)}function Le(e,t,i,r,n,s){return G(e,"h2",t,i,r,n,s)}function Ce(e,t,i,r,n,s,o,a){const l=fe(e,"checkbox",t,i,r,n,o,a);return s&&(l.checked=!0),l}function _e(e,t,i,r,n,s,o){const a=G(e,"img",t,i,r,void 0,o);return n&&(a.src=n),we(a,s),a}function we(e,t){e&&t&&e.setAttribute("aria-label",t)}function xe(e){if(e){const t=e.getAttribute("aria-label");return((null==t?void 0:t.length)||0)>0}return!1}function Fe(e){e&&e.removeAttribute("aria-label")}function Oe(e,t){e&&e.setAttribute("aria-labelledby",t)}function Ee(e){e&&e.setAttribute("aria-hidden","true")}function Ie(e){e&&e.setAttribute("aria-live","polite")}function Se(e){e&&e.removeAttribute("aria-live")}function De(e,t){e&&("presentation"===t&&e.setAttribute("aria-hidden","true"),e.setAttribute("role",t))}function Ae(e){De(e,"presentation")}function Te(e){De(e,"button")}function Be(e){Te(e),Re(e,0)}function Re(e,t){e&&e.setAttribute("tabindex",`${t}`)}function Ne(e,t){for(let i of t){let t=i.indexOf(":");const r=i.slice(0,t).trim(),n=i.slice(t+1).trim();e.style[r]=n}}function Ke(e,t){e&&(e.style.display=t)}function Ve(e){Ke(e,"none")}function je(e){Ke(e,"")}function ze(e){if(e)return!e.style.display||"none"!==e.style.display}function $e(e,t){e&&e.setAttribute("src",t)}function Ue(e,t){e&&(e.style.zIndex=`${t}`)}function Ze(e,t,i){e&&(void 0!==t&&(e.style.width="number"==typeof t?`${t}px`:t),void 0!==i&&(e.style.height="number"==typeof i?`${i}px`:i))}function He(e){e&&e.removeAttribute("aria-label")}function qe(e,t,i,r,n,s){if(e){const o=void 0!==n?2*n:e.offsetWidth,a=Math.floor(o/2),l=void 0!==s?2*s:e.offsetHeight,u=Math.floor(l/2);let h=0,d=0;if(r)switch(r){case"top":h=-a,d=0;break;case"middle":h=-a,d=-u;break;case"bottom":h=-a,d=-l;break;case"left":h=0,d=-u;break;case"right":h=-o,d=-u;break;case"top-left":h=0,d=0;break;case"top-right":h=-o,d=0;break;case"bottom-left":h=0,d=-l;break;case"bottom-right":h=-o,d=-l}We(e,{left:`${Math.round(t+h)}px`,top:`${Math.round(i+d)}px`})}}function We(e,t){const{bottom:i,left:r,right:n,top:s}=t;e&&(i||r||n||s)&&(e.style.top=null!=s?s:"",e.style.bottom=null!=i?i:"",e.style.left=null!=r?r:"",e.style.right=null!=n?n:"")}function Ge(e,t){var i;return!!e&&((null===(i=e.className)||void 0===i?void 0:i.split(" "))||[]).includes(t)}function Qe(e,t){return e.left<t.left+t.width&&e.left+e.width>t.left&&e.top<t.top+t.height&&e.top+e.height>t.top}function Xe(e,t,i){e&&(Ge(e,t)?et(e,t,i):Ge(e,i)&&et(e,i,t))}function Ye(e,t){return Je(e.right,e.top,t)||Je(e.left,e.top,t)||Je(e.left,e.bottom,t)||Je(e.right,e.bottom,t)||Je(e.center.x,e.center.y,t)}function Je(e,t,i){return Math.sqrt((e-i.center.x)*(e-i.center.x)+(t-i.center.y)*(t-i.center.y))<i.radius}function et(e,t,i){tt(e,[t],[i])}function tt(e,t,i){if(e){var r;const n=(null===(r=e.className)||void 0===r?void 0:r.split(" "))||[];t&&t.forEach((e=>{n.indexOf(e)>=0&&n.splice(n.indexOf(e),1)})),i&&i.forEach((e=>{n.includes(e)||n.push(e)})),e.className=n.filter((e=>e.length>0)).join(" ")}}function it(e){var t;return(null==e||null===(t=e.className)||void 0===t?void 0:t.split(" "))||[]}function rt(e,t){if(e){var i;const r=(null===(i=e.className)||void 0===i?void 0:i.split(" "))||[];r.includes(t)||r.push(t),e.className=r.filter((e=>e.length>0)).join(" ")}}function nt(e,t){if(e){var i;const r=null===(i=e.className)||void 0===i?void 0:i.split(" ");t.forEach((e=>{r.includes(e)||r.push(e)})),e.className=r.filter((e=>e.length>0)).join(" ")}}function st(e,t){if(e){var i;const r=(null===(i=e.className)||void 0===i?void 0:i.split(" "))||[];r.indexOf(t)>=0&&r.splice(r.indexOf(t),1),e.className=r.filter((e=>e.length>0)).join(" ")}}function ot(e,t){if(e){var i;const r=null===(i=e.className)||void 0===i?void 0:i.split(" ");t.forEach((e=>{r.indexOf(e)>=0&&r.splice(r.indexOf(e),1)})),e.className=r.filter((e=>e.length>0)).join(" ")}}function at(e,t){e&&(t?e.className=t:delete e.className)}function lt(e,t){e&&(t?e.setAttribute("style",t):ht(e))}function ut(e,t,i){at(e,t),lt(e,i)}function ht(e){e&&e.removeAttribute("style")}function dt(e,t,i){const r=(t.center.y-e.center.y)/(t.center.x-e.center.x),n=mt(e.center,t.center),s=r!==-1/0?t.center.y-r*t.center.x:void 0,o={from:vt(t,r,s,-n.x,-n.y),to:vt(e,r,s,n.x,n.y)};return mt(o.from||t.center,o.to||e.center,i)}function ct(e,t,i){return{center:e,width:t,height:i,left:e.x-t/2,top:e.y-i/2,right:e.x+t/2,bottom:e.y+i/2}}function pt(e){const t={bottom:Math.max(...e.map((e=>e.bottom))),left:Math.min(...e.map((e=>e.left))),right:Math.max(...e.map((e=>e.right))),top:Math.min(...e.map((e=>e.top)))};return t.center=ft(t),t.width=t.right-t.left,t.height=t.bottom-t.top,t}function gt(e,t){const i={bottom:e.bottom+t.y,left:e.left+t.x,right:e.right+t.x,top:e.top+t.y,height:e.height,width:e.width};return i.center=ft(i),i}function ft(e){return{x:(e.right-e.left)/2+e.left,y:(e.bottom-e.top)/2+e.top}}function mt(e,t,i){const r=t.x-e.x,n=t.y-e.y;return{x:r+(i?i*Math.sign(r):0),y:n+(i?i*Math.sign(n):0)}}function yt(e,t){return e>0&&0===t?"right":0===e&&t<0?"top":e<0&&0===t?"left":0===e&&t>0?"bottom":e>0&&t<0?"topOrRight":e<0&&t<0?"topOrLeft":e<0&&t>0?"bottomOrLeft":e>0&&t>0?"bottomOrRight":void 0}function vt(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(yt(arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)){case"right":return kt(e,t,i);case"top":return Mt(e,t,i);case"left":return Pt(e,t,i);case"bottom":return Lt(e,t,i);case"topOrRight":return Mt(e,t,i)?Mt(e,t,i):kt(e,t,i);case"topOrLeft":return Pt(e,t,i)?Pt(e,t,i):Mt(e,t,i);case"bottomOrLeft":return Lt(e,t,i)?Lt(e,t,i):Pt(e,t,i);case"bottomOrRight":return kt(e,t,i)?kt(e,t,i):Lt(e,t,i)}}function bt(e,t,i){if(e&&t)if(i>=t.children.length)t.appendChild(e);else{const r=ee(t)[i];t.insertBefore(e,r)}}function kt(e,t,i){let r=t*e.right+i;if(r>=e.top&&r<=e.bottom)return{x:e.right,y:r}}function Mt(e,t,i){let r=t!==-1/0?(e.top-i)/t:e.center.x;if(r>=e.left&&r<=e.right)return{x:r,y:e.top}}function Pt(e,t,i){let r=t*e.left+i;if(r>=e.top&&r<=e.bottom)return{x:e.left,y:r}}function Lt(e,t,i){let r=t!==-1/0?(e.bottom-i)/t:e.center.x;if(r>=e.left&&r<=e.right)return{x:r,y:e.bottom}}function Ct(e,t,r,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.g.document;if(s){const[i]=s.getElementsByTagName("head");if(i){let o=s.createElement("style");o.id=e,o.setAttribute("data-meta",t),i.appendChild(o);const{sheet:a}=o;let l;if(a)if(void 0!==a.insertRule)l=(e,t,i)=>e.insertRule(t+"{"+i+"}",e.cssRules.length);else{if(void 0===a.addRule)throw new Error("no insertRule or addRule in sheet");l=(e,t,i)=>e.addRule(t,i)}const u=[];Object.keys(n).forEach((e=>{const t=n[e],i=`.egmaps.${r} ${e}`,s=Object.keys(t).map((e=>`${ei(e)}:${t[e]||"''"}`)).join(";");l(a,i,s),u.push(`${i} {\n  ${s.split(";").join(";\n  ")};\n}`)}));const h=s.createTextNode(u.join("\n\n"));o.appendChild(h)}}}function _t(){return window}function wt(e,t){const{value:i}=Ft(e,t)||{};return i}function xt(e,t){const{key:i}=Ft(e,t)||{};return i}function Ft(e,t){if(t)for(let i of t)if(i){const t=null==e?void 0:e[i];if(void 0!==t)return{key:i,value:t}}}function Ot(e){return!e||""===e}function Et(e){return e[0].toUpperCase()+e.slice(1)}function It(e){return null!==e&&"object"==typeof e&&!H(e)&&"[object Array]"!==Object.prototype.toString.call(e)}function St(e){return Array.isArray(e)}function Dt(e){return JSON.stringify(e,function(){const e=new WeakSet;return(t,i)=>{if("object"==typeof i&&null!==i){if(e.has(i))return;e.add(i)}return i}}())}function At(e){if(e){if(St(e))return e.sort();if(It(e)){var t;if("Object"===(null===(t=e.constructor)||void 0===t?void 0:t.name)){const t={};return Object.keys(e).sort().forEach((i=>t[i]=At(e[i]))),t}return e}return e}return e}function Tt(e,t){if(t<=0)throw new Error("chunk size should be greater than 0");let i=0,r=e.length,n=[];for(i=0;i<r;i+=t){const r=e.slice(i,i+t);n.push(r)}return n}function Bt(e){return e&&0!==e.length?[...new Set(e)]:[]}function Rt(e){return Vt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:2)}function Nt(e){return e.filter((e=>{if(void 0!==e){let{lat:t,lng:i}=e;if(t||void 0===e.length||([t,i]=e),void 0!==t&&void 0!==i)return e}})).filter((e=>void 0!==e))}function Kt(e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=Vt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:5);if(t){if(i<-180)return i+360;if(i>180)return i-360}return i}function Vt(e,t){const i=Math.pow(10,t);let r=e*i;return r=Math.round(r),r/i}function jt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],{lat:r,lng:n}=e;return r||void 0===e.length||([r,n]=e),[Kt(r,t,!1),Kt(n,t,i)]}function zt(e,t){if(!e)return!t;if(!t)return!1;const{sw:i,ne:r,center:n}=e,{sw:s,ne:o,center:a}=t;return i[0]===s[0]&&i[1]===s[1]&&r[0]===o[0]&&r[1]===o[1]&&n[0]===a[0]&&n[1]===a[1]}function $t(e){const t=Number(e);return Math.floor(t.valueOf())===t.valueOf()?0:t.toString().split(".")[1].length||0}function Ut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(e,t)=>e===t;if(e.length!==t.length)return!1;const n=t.slice();return e.every(((e,t)=>{const s=n.findIndex((t=>r(e,t)));return s>=0&&(!i||t===s)}))}function Zt(e){const t=e.indexOf("."),i=e.indexOf(",");if(-1!==t||-1!==i){const r=i>t?",":".",n=i>t?i:t;if(e.length<=n+3)return r;for(let t=n+1;t<=n+3;t++){const i=e.charAt(t);if(isNaN(i)||" "===i)return r}if(e.length>=n+4){const t=e[n+4];if(!isNaN(t)&&" "!==t)return r}}}function Ht(e){let t,i,r,n;for(let s=0;s<e.length;s++){const r=e[s];if(!t&&"string"==typeof r){const e=Zt(r);e&&(t=e,i=t&&","===t?".":",")}}if(e.forEach((e=>{const s=t?Z()(e,{decimal:t,separator:i}).value:Z()(e).value;(!r||r>s)&&(r=s,n=e)})),r&&isFinite(r))return n}function qt(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=i?i.sort():[],s=[];const o=e=>{for(let t=e.depth;t>=0;t--){const i=e[t];for(let e=i.maxQualifiers;e>=0;e--)i[e]&&(s=s.concat(i[e]))}};if(t){const t={depth:1,0:["hl"]};Wt("hl#",n.slice(),e,t,1,0),o(t),e&&s.push(["hl",e].sort().join("#")),s.push("hl")}const a={depth:-1};return Wt("",n.slice(),e,a,0,0),o(a),e&&s.push(e),r&&s.push("default"),s}function Wt(e,t,i,r,n,s){let o=r[n];for(o||(o={maxQualifiers:s},r[n]=o,r.depth=n);t.length>0;){const a=t.splice(0,1),l=s+1;if(o[l]||(o[l]=[]),o.maxQualifiers<l&&(o.maxQualifiers=l),o[l].push(`${e}${a}`.split("#").sort().join("#")),i){let t=r[n+1];t||(t={maxQualifiers:l},r[n+1]=t,r.depth=n+1),t[l]||(t[l]=[]),t[l].push(`${e}${a}#${i}`.split("#").sort().join("#"))}t.length>0&&Wt(`${e}${a}#`,t.slice(),i,r,n+1,s+1)}}function Gt(e){return Qt(255*e)}function Qt(e){let t=parseInt(e);t<0&&(t=4294967295+t);const i=t.toString(16).toUpperCase();return 1==i.length?i+"0":i.slice(-2)}function Xt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<e;r++)t+=i.charAt(Math.floor(62*Math.random()));return t}function Yt(e){return e.split("").reduce((function(e,t){return 0|(e<<5)-e+t.charCodeAt(0)}),0)}function Jt(e){return e.split("-").map(((e,t)=>0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1))).join("")}function ei(e){const t=[];return e.split("").forEach(((e,i)=>{const r=e.toUpperCase();e===r&&e.toLowerCase()!==r?i>0?t.push("-",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function ti(e){return e.split("_").map(((e,t)=>0===t?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1))).join("")}function ii(e){const t=[];return e.split("").forEach(((e,i)=>{const r=e.toUpperCase();e===r&&e.toLowerCase()!==r?i>0?t.push("_",e.toLowerCase()):t.push(e.toLowerCase()):t.push(e)})),t.join("")}function ri(e){return e.substring(e.indexOf("((")+2,e.lastIndexOf("))")).split(", ").map((e=>e.split(" "))).map((e=>({lng:Number(parseFloat(e[0]).toFixed(8)),lat:Number(parseFloat(e[1]).toFixed(8))})))}const ni=(e,t,i)=>{t.has(i)&&(e.push(i),t.delete(i))},si=e=>{const t=["available","filtered","sold_out","unknown"],i=new Set,r=new Set;e.forEach((e=>{(e=>["available","filtered","sold_out","unknown"].some((t=>-1!==e.indexOf(t))))(e)||-1!==e.indexOf("hl")||-1!==e.indexOf("default")||e.split("#").forEach((e=>r.add(e))),i.add(e)}));const n=[];ni(n,i,"default"),t.forEach((e=>ni(n,i,e)));const s=Array.from(r).sort(),o=(e=>{const t=(e,i,r,n)=>{if(0!=e)for(let s=0;s<i.length;s++)t(e-1,i.slice(s+1),r.concat([i[s]]),n);else r.length>0&&(n[n.length]=r)},i=[];for(let r=1;r<e.length;r++)t(r,e,[],i);return i.push(e),i})(s).map((e=>e.join("#")));if(s.length>0){for(let e=0;e<o.length-1;e+=s.length){for(let t=s.length-1;t>=0;t--)ni(n,i,o[e+t]);for(let r=s.length-1;r>=0;r--)t.forEach((t=>{for(let a=s.length;a>=0;a--)ni(n,i,`${t}#${o[e+r]}`)}))}ni(n,i,o[o.length-1]),t.forEach((e=>ni(n,i,`${e}#${o[o.length-1]}`)))}if(ni(n,i,"hl"),t.forEach((e=>ni(n,i,`${e}#hl`))),s.length>0){for(let e=0;e<o.length-1;e+=s.length){for(let t=s.length-1;t>=0;t--)ni(n,i,`hl#${o[e+t]}`);for(let r=s.length-1;r>=0;r--)t.forEach((t=>{for(let a=s.length;a>=0;a--)ni(n,i,`${t}#hl#${o[e+r]}`)}))}ni(n,i,`hl#${o[o.length-1]}`),t.forEach((e=>ni(n,i,`${e}#hl#${o[o.length-1]}`)))}return n.reverse()};function oi(e,t,i){let r;return r="%"===t?parseFloat(e)*i/100:parseFloat(e),Number.isFinite(r)?r:void 0}function ai(e,t){var i,r;if(void 0===e)return;if("string"!=typeof e)throw new Error("Client padding has to be of type string");const{clientHeight:n,clientWidth:s}=t||{};if(!Number.isFinite(n)||!Number.isFinite(s))throw new Error(`Dimensions of map element have to be of type number: {height: ${n}, width: ${s}}`);const o=e.match(/^(((\d+)(\.\d+)?)(px|%|))( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?( ((\d+)(\.\d+)?)(px|%|))?$/);if(!o)throw new Error("Client padding has to follow CSS syntax and only use 'px' and '%' units");const[,,a,,,l,,u,,,h,,d,,,c,,p,,,g]=o;return{paddingTop:oi(a,l,n),paddingRight:oi(null!=u?u:a,null!=h?h:l,s),paddingBottom:oi(null!=d?d:a,null!=c?c:l,n),paddingLeft:oi(null!==(i=null!=p?p:u)&&void 0!==i?i:a,null!==(r=null!=g?g:h)&&void 0!==r?r:l,s)}}function li(e,t,i){let r=jt(t);if(i){const{paddingTop:t=0,paddingRight:n=0,paddingBottom:s=0,paddingLeft:o=0}=i,a=Math.pow(2,Rt(e+1)),l=[(t-s)/a,(n-o)/a];r=jt(r.map((e=>e+l.shift())))}return{zoom:Rt(e),center:r}}function ui(e,t,i){const r=parseInt(t),n=parseInt(i),s=String(e);if(s&&r&&n&&r>0&&n>0&&s.length>r){let e=s.replace(/[\u0000-\u001F\u007F-\u009F]/g," ").trim().split(/\s+/g).map((e=>[...e])),t=[],i=[],o=0;for(;e.length>0&&i.length<=n;){const[n]=e;o+=n.length,(o<=r||o>r&&0===t.length)&&(t.push(n.join("")),e.shift()),(o>=r||o<r&&0===e.length)&&(i.push(t.join(" ")),t=[],o=0)}return i.length>n&&(i.pop(),i.push(i.pop()+"...")),i.join("\n")}return s}function hi(e){const t=e.split("\n").map((e=>[...e].length));if(1===t.length)return 0;const i=Math.max(...t);return Math.min(...t)/i}function di(e,t,i){let r=String(e),n=0;const s=Math.min(Math.floor(r.length/i),t);let o=t;for(;o>=s;){const t=ui(e,o,i),s=hi(t);if(!s||0===s||s>=.5)return t;s>n&&(r=t,n=s),o--}return r}function ci(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e}function pi(e){let t,i,r=0;if(0===e.length)return r;for(t=0;t<e.length;t++)i=e.charCodeAt(t),r=(r<<5)-r+i,r|=0;return r}function gi(e,t,i,r){if(!e||isNaN(e))return e;const n=t||$t(e),s={style:"currency",currency:i,minimumFractionDigits:n,maximumFractionDigits:n};return new Intl.NumberFormat(r,s).format(e)}class fi extends M{constructor(e,t,i,r,n){var s,o,a,l,u,h;super(),this.createClusterLabel=t,this.logger=e("SuperCluster"),this._config=i,this._defaultConfig=r,this.labelKey=null!==(s=this._config.labelKey)&&void 0!==s?s:r.labelKey||"unknown",this._radius=null!==(o=null!==(a=null===(l=this._config.superclusterSettings)||void 0===l?void 0:l.radius)&&void 0!==a?a:null===(u=r.superclusterSettings)||void 0===u?void 0:u.radius)&&void 0!==o?o:0,this._previousMapSize=void 0,this._mapSize=void 0,this._tileDim=void 0,this._supercluster=void 0,this.qualifier=n,this.excludedQualifiers=null!==(h=this._config.excludedQualifiers)&&void 0!==h?h:r.excludedQualifiers}get radius(){if(!this._tileDim||!this._mapSize)return 0;const{width:e,height:t}=this._tileDim,{clientWidth:i,clientHeight:r}=this._mapSize,n=75*i/e,s=75*r/t;return Math.min(this._radius,n,s)}get supercluster(){const{clientWidth:e,clientHeight:t}=this._previousMapSize||{},{clientWidth:i,clientHeight:r}=this._mapSize||{};var n,s,o;return this._supercluster&&e===i&&t===r||(this._supercluster=new D({minPoints:null!==(n=this._config.minPoints)&&void 0!==n?n:this._defaultConfig.minPoints,minZoom:null!==(s=this._config.minZoom)&&void 0!==s?s:this._defaultConfig.minZoom,maxZoom:null!==(o=this._config.maxZoom)&&void 0!==o?o:this._defaultConfig.maxZoom,radius:this.radius})),this._supercluster}getClustersAndFeatures(e,t,i,r,n,s,o){this._previousMapSize=this._mapSize,this._mapSize=s,this._tileDim=o;const{remainingFeatures:a,clusters:l}=e,u=this._getExcludedFeatures(a,i),h=u.map((e=>e.id)),d=a.filter((e=>!h.includes(e.id))),c=this._loadFeaturesForClustering(d);return this._clusterFeatures(c,d,l,t,u,r,n)}_loadFeaturesForClustering(e){const t=e.map((e=>this._makeGeoJsonFeature(e)));return this.supercluster.load(t)}_clusterFeatures(e,t,i,r,n,s,o){const a=this._convertBoundsToBbox(s),l=e.getClusters(a,Math.floor(o));return this._getAllFeaturesAndClusters(e,t,i,r,n,l)}_convertBoundsToBbox(e){return[e.sw[1],e.sw[0],e.ne[1],e.ne[0]]}_makeGeoJsonFeature(e){const t=[e.latLng[1],e.latLng[0]];return{id:e.id,type:"Feature",geometry:{type:"Point",coordinates:t},properties:e}}_getAllFeaturesAndClusters(e,t,i,r,n,s){const o={clusters:i,remainingFeatures:n};for(let a of s)if(a.properties.cluster){const i=a.properties.cluster_id,n=e.getLeaves(i,1/0),s=t.filter((e=>!n.every((t=>t.properties.id!==e.id||t.properties.type!==e.type)))),l=Ht(s.map((e=>e.price)))||0,[u,h]=a.geometry.coordinates,d={id:`${pi(`${r}-${s.map((e=>`${e.id}`)).sort().join(",")}`)}`.replace("-","N"),children:s,minPrice:l,lat:h,lng:u,type:"cluster",radius:this.radius,text:this.createClusterLabel(s.length,l,this.labelKey),featureType:r,qualifier:this.qualifier};o.clusters.push(d)}else o.remainingFeatures.push(a.properties);return o}_getExcludedFeatures(e,t){return e.filter((e=>{var i;return(e.qualifiers||[]).some((e=>(this.excludedQualifiers||[]).includes(e)))||!(null!==(i=e.hashKeys)&&void 0!==i&&i.includes(t))}))}}const mi={OFF:"OFF",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR"};function yi(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=i||!t?new bi:t;return{debug:(t,n)=>r.debug({loggerName:e,message:t,stack:n,debugMode:i}),info:(t,n)=>r.info({loggerName:e,message:t,stack:n,debugMode:i}),warn:(t,n)=>r.warn({loggerName:e,message:t,stack:n,debugMode:i}),error:(t,n)=>r.error({loggerName:e,message:t,stack:n,debugMode:i}),debugEnabled:()=>r.debugEnabled(),infoEnabled:()=>r.infoEnabled(),warnEnabled:()=>r.warnEnabled(),errorEnabled:()=>r.errorEnabled()}}class vi{constructor(){}log(e,t,i,r,n){throw new Error("method log not implemented")}enabled(e){throw new Error("method enabled not implemented")}debug(e){let{loggerName:t,message:i,stack:r,debugMode:n}=e;return this.log(t,mi.DEBUG,i,r,n)}info(e){let{loggerName:t,message:i,stack:r,debugMode:n}=e;return this.log(t,mi.INFO,i,r,n)}warn(e){let{loggerName:t,message:i,stack:r,debugMode:n}=e;return this.log(t,mi.WARN,i,r,n)}error(e){let{loggerName:t,message:i,stack:r,debugMode:n}=e;return this.log(t,mi.ERROR,i,r,n)}debugEnabled(){return this.enabled(mi.DEBUG)}infoEnabled(){return this.enabled(mi.INFO)}warnEnabled(){return this.enabled(mi.WARN)}errorEnabled(){return this.enabled(mi.ERROR)}}class bi extends vi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mi.WARN,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t,i)=>`${(new Date).toISOString()} EGMAPS-8.1.7 ${e||"undefined"} ${t} ${i}`;super(),this.formatter=t,this.level=e}enabled(e){if(this.level!==mi.OFF)switch(e){case mi.DEBUG:return this.level===mi.DEBUG;case mi.INFO:return this.level===mi.DEBUG||this.level===mi.INFO;case mi.WARN:return this.level===mi.DEBUG||this.level===mi.INFO||this.level===mi.WARN;case mi.ERROR:return this.level===mi.DEBUG||this.level===mi.INFO||this.level===mi.WARN||this.level===mi.ERROR;default:throw new Error(`level not implemented: ${e}`)}return!1}log(e,t,i,r,n){if(this.enabled(t||mi.INFO)||n){const n=[this.formatter(e,t||mi.INFO,i)];switch(r&&n.push(r),t){case mi.DEBUG:console.debug(...n);break;case mi.INFO:default:console.info(...n);break;case mi.WARN:console.warn(...n);break;case mi.ERROR:console.error(...n)}return!0}}}function ki(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Mi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ki(Object(i),!0).forEach((function(t){Pi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ki(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Pi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Li(e){return Promise.allSettled?Promise.allSettled(e):Promise.all(e.map((e=>e.then((e=>({status:"fulfilled",value:e}))).catch((e=>({status:"rejected",reason:e}))))))}function Ci(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("undefined"!=typeof AbortController){const r=new AbortController;return setTimeout((()=>r.abort()),t),fetch(e,Mi(Mi({},i),{},{signal:r.signal})).catch((i=>{if(null!=i&&i.toString().includes("The user aborted a request"))return{clone:()=>this,redirected:!1,type:"basic",url:e,ok:!1,success:!1,status:504,headers:[],statusText:`timeout occurs after ${t}ms when fetching ${e}`,arrayBuffer:()=>Promise.reject(new Error("timeout occurs")),body:null,bodyUsed:!1,blob:()=>Promise.reject(new Error("timeout occurs")),formData:()=>Promise.reject(new Error("timeout occurs")),json:()=>Promise.reject(new Error("timeout occurs")),text:()=>Promise.reject(new Error("timeout occurs"))};throw i}))}return fetch(e,i)}function _i(e){var t;const i=null===(t=document.cookie)||void 0===t?void 0:t.split(";");for(const r of i)if((null==r?void 0:r.substring(0,r.indexOf("=")).trim())===e){if(r.indexOf("=")+1>r.length)return;return r.substring(r.indexOf("=")+1)}}const wi="gmapsMarkerType",xi=new class{_loadOptionsFromCookie(){const e=_i("EGMAPS_DEBUG_OPTIONS");this._debugOptions=new Set(null==e?void 0:e.split(","))}_getOptionEnabled(e){var t;return this._debugOptions||this._loadOptionsFromCookie(),!(null===(t=this._debugOptions)||void 0===t||!t.has(e))}getDebugLoggingEnabled(){return this._getOptionEnabled("logging")}getDebugTilesIdEnabled(){return this._getOptionEnabled("tilesId")}getDebugMarkersPositionEnabled(){return this._getOptionEnabled("markersPosition")}shouldUseGmapsAdvancedMarkers(){return!this._getOptionEnabled(`${wi}=classic`)&&(!!this._getOptionEnabled(`${wi}=advanced`)||void 0)}getDebugConfigEnabled(){return this._getOptionEnabled("config")}};class Fi{constructor(e,t,i){this.defaultConfig=e,this.config=t,this.overwriteConfig={},this.configurations=[t,e].filter(Boolean),this.externalConfig=void 0,this.cache=new Map,this.configLoaderLogger=this.logger("config-loader"),this.externalConfigLoaded=i?new Promise((e=>{this.externalConfig=i,this.configurations=[i,...this.configurations],e(void 0)})):this._loadExternalConfig(null==t?void 0:t.externalConfigEndpoint,5e3).then((e=>{this.configLoaderLogger.debug(`Loaded external config from ${null==t?void 0:t.externalConfigEndpoint}`),e&&(this.externalConfig=e,this.configurations=[e,...this.configurations])}))}ready(){return this.externalConfigLoaded.then((()=>this))}getConfigurations(){return{default:this.defaultConfig,external:this.externalConfig,overwrite:this.overwriteConfig,parameter:this.config}}_loadExternalConfig(e,t){return e?(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ci)(e,t).then((e=>e.ok?e.json().then((e=>this.externalConfig=e)):(e.text().then((e=>this.configLoaderLogger.error("Failed to load external configuration. Will continue without this config",e))),null))).catch((t=>(this.configLoaderLogger.error(`failed to load external config from ${e}`,t),null))):Promise.resolve(null)}logger(e){return yi(e,this.readParam("logging,logger"),xi.getDebugLoggingEnabled())}clearCache(){this.cache.clear()}writeParam(e,t){this._writeParamAux(e.split(","),t,this.overwriteConfig),this.cache.set(e,t)}removeOverrideParam(e){this._removeParamAux(e.split(","),this.overwriteConfig),this.cache.delete(e)}removeParam(e){this.writeParam(e,null)}_writeParamAux(e,t,i){let[r]=e;if(ci(r))if(1===e.length)i[r]=t;else{i[r]||(i[r]={});let n=i[r];e.shift(),this._writeParamAux(e,t,n)}}_removeParamAux(e,t){let[i]=e;if(ci(i))if(1===e.length)delete t[i];else{t[i]||(t[i]={});let r=t[i];e.shift(),this._removeParamAux(e,r)}}readParam(e){if(this.cache.has(e)){const t=this.cache.get(e);return null===t?void 0:t}{const t=e.split(","),i=this._readParamAux(t,this.overwriteConfig,this.configurations);return this.cache.set(e,i),i}}_readParamAux(e,t,i){let[r]=e;const n=t?t[r]:void 0;if(null===n)return;let s=i.map((e=>e[r])).filter((e=>void 0!==e));for(let o=0;o<s.length;o++)if(null===s[o]){s=s.splice(0,o);break}return 1===e.length?At(n||(s.length>0?s[0]:void 0)):(e.shift(),this._readParamAux(e,n,s))}listStringKeys(e){let t=[],i=[];return[this.overwriteConfig,...this.configurations].forEach((r=>this._listKeysAux(t,i,(null==e?void 0:e.split(","))||[],[],r))),t}listKeys(e){return[...this.listStringKeys(e).map((e=>e.split(",")))]}listKeysShallow(e){return this.listStringKeys(e).map((t=>t.split(",").slice(0,e.split(",").length+1).join(","))).filter(((e,t,i)=>i.indexOf(e)===t)).map((e=>e.split(",")))}subConfig(e){const t={};return(e?[e]:Object.keys(this.defaultConfig)).map((e=>{const i={};return this.listStringKeys(e).map((t=>{const r=this.readParam(t);void 0!==r&&this._writeParamAux(t.substring(e.length+1).split(","),r,i)})),t[e]=i,i})),e?t[e]:t}_listKeysAux(e,t,i,r,n){const s=[];let o=n;if(i.length>0){let[e]=i;o=n[e],s.push(...r,e)}void 0!==o&&(i.length<=1?this._listKeysAuxDeep(e,t,s,o):(i.shift(),this._listKeysAux(e,t,i,s,o)))}_listKeysAuxDeep(e,t,i,r){if(It(r)&&!H(r))for(let n in r){const s=[];s.push(...i,n),t.includes(s.join(","))||this._listKeysAuxDeep(e,t,s,r[n])}else i&&(t.includes(i.join(","))||(null===r?t.push(i.join(",")):this._checkIfParentPathAlreadyPresent(e,i)||e.push(i.join(","))))}_checkIfParentPathAlreadyPresent(e,t){const i=[];t.forEach((t=>{if(i.push(t),e.includes(i.join(",")))return!0}));const r=t.join(",")+",";return e.some((e=>e===t.join(",")||e.startsWith(r)))}_fillObjectWithLeafName(e,t){this.listKeysShallow(e).map((e=>{const i=e[e.length-1];t(i,this.readParam(e.join(",")))}))}propertyValues(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e=>e;const n={};return i.map((i=>{n[i]={};const s=[e,i,t].filter((e=>void 0!==e)).join(",");this._fillObjectWithLeafName(s,((e,t)=>{const s=e.split("#").sort().join("#");ci(i)&&ci(s)&&(n[i][s]=r(t))}))})),n}}function Oi(e){const t=["animate__animated","animate__bounce"],i=r=>{ot(e,t),e.removeEventListener("animationend",i)};e.addEventListener("animationend",i),nt(e,t)}class Ei{constructor(e,t,i){const{readParam:r,writeParam:n}=i;this.locale=t,this.messages=e||{},this.readParam=r,this.writeParam=n,this.variants=[],this.locale&&(this.variants.push(this.locale),t.length>2&&this.variants.push(this.locale.slice(0,2))),this.variants.push("default"),this._registerMessages(),this.hookForFormat=this.readParam("i18n,formatFunction")}_registerMessages(){const e=this;this.variants.forEach((t=>{const i=this.messages[t];if(i)for(let r in i){const t=`i18n,messages,${r}`;void 0===e.readParam(t)&&e.writeParam(t,i[r])}}))}format(e){let t;for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return t=this._externalFormat(e,...r),t||(t=this._internalFormat(e,...r)),t}_externalFormat(e){if(this.hookForFormat){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return this.hookForFormat(e,i)}}_internalFormat(e){const t=this.readParam(`i18n,messages,${e}`);if(t){let e=t;for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];if(r)for(let t=0;t<r.length;t++){const i=r[t];e=e.replace(`{${t}}`,void 0!==i?i:"")}return e}return`${e} ${this.locale?this.locale:"default"} NOT FOUND`}}class Ii{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>"object"!=typeof e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!1;this.isLeaf=e,this.hasExpired=t,this.cache=Object.create(null),this.listeners=new Set}get(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const{cache:r}=this;let n=r[t[0]];for(let s=1;s<t.length&&n;s++)n=n[t[s]];return n&&this.hasExpired(n,t)?(this.listeners.forEach((e=>e(Ii.EVENTS.EXPIRE,n,t))),void this.set(void 0,...t)):n}keys(){const{cache:e}=this;let t=e;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];for(let s=0;s<(null==r?void 0:r.length)&&t;s++)t=t[r[s]];return t?this._keysAux(r,t):[]}_keysAux(e,t){return this.isLeaf(t,e)?this.hasExpired(t,e)?[]:[e]:Object.keys(t).flatMap((i=>this._keysAux([...e,i],t[i])))}set(e){const{cache:t}=this,i=[];let r=t;for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];for(let a=0;a<s.length-1;a++){if(!r[s[a]]){if(!e)return;r[s[a]]={}}i.push(r),r=r[s[a]]}if(e)r[s[s.length-1]]=e;else{delete r[s[s.length-1]];for(let e=i.length-1;e>=0&&0===Object.keys(i[e][s[e]]).length;e--)delete i[e][s[e]]}}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}}Ii.EVENTS={EXPIRE:"expire"};class Si extends Ii{constructor(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e;super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>null==e?void 0:e.leaf,(function(i){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return t(i.time+e<Date.now(),i.content,n)}))}set(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];super.set({leaf:!0,time:Date.now(),content:e},...i)}get(){var e;return null===(e=super.get(...arguments))||void 0===e?void 0:e.content}keys(){return super.keys(...arguments)}}class Di extends Ii{set(){}get(){}}function Ai(e,t,i){return!e||e<=0?new Di:new Si(e,t,i)}const Ti=6378137;function Bi(e,t,i,r,n){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const{zoomMax:o=21,padding:a=0,worldDimensions:l={height:256,width:256},parsedClientPadding:u}=s,h=(Ki(r)-Ki(t))/Math.PI,d=n-i,c=(d<0?d+360:d)/360,{offsetWidth:p,offsetHeight:g}=e,{paddingTop:f=0,paddingRight:m=0,paddingBottom:y=0,paddingLeft:v=0}=u||{},b=Vi(g-2*a-f-y,l.height,h),k=Vi(p-2*a-m-v,l.width,c);return isFinite(b)?isFinite(k)?Math.min(b,k,o):b:k}function Ri(e,t,i,r,n){let s=Math.sin(e*Math.PI/180);s=Math.min(Math.max(s,-.9999),.9999);const o=1<<i;return[Math.floor(r*(.5+t/360)*o/r),Math.floor(n*(.5-Math.log((1+s)/(1-s))/(4*Math.PI))*o/n)]}function Ni(e,t,i,r,n,s,o){const[a,l]=Ri(i,t,n,s,o),[u,h]=Ri(e,r,n,s,o),d=[];for(let c=0;c<=u-a;c++)for(let e=0;e<=h-l;e++)d.push({x:a+c,y:l+e});return d}function Ki(e){const t=Math.sin(e*Math.PI/180),i=Math.log((1+t)/(1-t))/2;return Math.max(Math.min(i,Math.PI),-Math.PI)/2}function Vi(e,t,i){return Math.floor(Math.log(e/t/i)/Math.LN2*1e3)/1e3}function ji(e){let[t]=e,[i]=e;return e.forEach((e=>{t>e?t=e:i<e&&(i=e)})),e.length>1&&i-t>t+360-i}function zi(e){return ji(e.map((e=>{var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})))}function $i(e,t){var i,r;return(null!==(i=t.lng)&&void 0!==i?i:t[1])<(null!==(r=e.lng)&&void 0!==r?r:e[1])}function Ui(e,t,i){const r=ji(t)&&i,n=r?Hi(e):e,s=r?t.map(Hi):t;let o=n;return s.forEach((e=>{let t=Math.abs(n-o);Math.abs(n-e)>t&&(o=e)})),Kt(o,void 0,i)}function Zi(e,t){var i,r,n,s;const o=zi([e,t]),a=null!==(i=e.lat)&&void 0!==i?i:e[0],l=null!==(r=e.lng)&&void 0!==r?r:e[1],u=o?Hi(l):l,h=null!==(n=t.lat)&&void 0!==n?n:t[0],d=null!==(s=t.lng)&&void 0!==s?s:t[1],c=o?Hi(d):d;return h>a?c<u?"nw":"ne":c>u?"se":"sw"}function Hi(e){return e<0?e+360:e}function qi(e,t,i,r,n,s){let o;if(i===s)o=Math.pow(r-e,2)+Math.pow(n-t,2);else if(i>s){const a=1<<i-s;o=Math.pow(r-e/a,2)+Math.pow(n-t/a,2)}else{const a=1<<s-i;o=Math.pow(r/a-e,2)+Math.pow(n/a-t,2)}return Math.sqrt(o)}function Wi(e,t){const i=e+t/Ti*(180/Math.PI);return i<-180?i+360:i>180?i-360:i}function Gi(e){const t=null==e?void 0:e.type;if(["Polygon","MultiPolygon"].includes(t)){let i=[];"Polygon"===t?i.push(e.coordinates):i.push(...e.coordinates);const r=[];return i.forEach((e=>{const t=[];e.forEach((e=>{const i=[];e.forEach((e=>{let[t,r]=e;return i.push({lat:r,lng:t})})),t.push(i)})),r.push(t)})),r}throw new Error(`Geometry ${t} not supported`)}const Qi={imageLoaded:"load",imageLoadingError:"error"};function Xi(e){const t=new RegExp(/(.*?)[\w,\s-]+\.(gif|jpe?g|tiff?|png|webp|bmp|svg)$/),i=new Set;return e.forEach((e=>{H(e)?ue(e,(e=>{var t;return"IMG"===(null===(t=e.tagName)||void 0===t?void 0:t.toUpperCase())}),!0).forEach((e=>{const r=e.element.src;r&&t.test(r)&&i.add(r)})):t.test(e)&&i.add(e)})),[...i]}function Yi(e,t,i){const r=[];return e.forEach((e=>{const n=new Image;n.src=e,r.push(tr(n,t,i))})),Li(r).then((()=>Promise.resolve()))}function Ji(e){const t=new Set;return Object.keys(e).forEach((i=>{const r=e[i];Object.keys(r).forEach((e=>{const i=r[e];Object.keys(i).forEach((e=>{const r=i[e];r&&"none"!==r&&t.add(r)}))}))})),[...t]}function er(e){const t=new Set;return Object.keys(e).forEach((i=>{const r=e[i];Object.keys(r).forEach((e=>{const i=r[e];i&&"none"!==i&&t.add(i)}))})),[...t]}function tr(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise(((n,s)=>{t(e,Qi.imageLoaded,n),t(e,Qi.imageLoadingError,(t=>{r?(i.debug(`failed to load image ${e.src}`,null==t?void 0:t.stack),n()):s(new Error(`failed to load image ${e.src}. ${t}`))}))}))}function ir(e,t,i){return H(t)&&(!H(e)||q(t)!==q(e))||!H(t)&&(H(e)||i&&t!==e)}class rr{constructor(){}_buildClusterService(e,t,i,r,n,s,o){const{type:a}=n;if(a)switch(a){case"supercluster":return new fi(e,this._createClusterLabelMethod(t,i,r),n,s,o);case"none":return;default:throw new Error(`Unknown cluster type ${a}`)}}createClusterers(e,t,i,r,n,s){const o={};return Object.keys(s).forEach((a=>{o[a]=[];const l=n[a],u=s[a];si(Object.keys(l)).forEach((n=>{const s=l[n],h=this._buildClusterService(e,t,i,r,s,u,n);h&&o[a].push({qualifier:n,clusterer:h})}))})),o}_createClusterLabelMethod(e,t,i){return(r,n,s)=>{const o=void 0!==n,a=e(s,r);if(o&&-1!==a.indexOf("{1}")){const o=gi(n,void 0,t,i);return e(s,r,o)}return a}}}var nr=i(569),sr=i.n(nr);const or={boundsChanged:"boundsChanged",markersChanged:"markersChanged",selectionChanged:"selectionChanged",hoverChanged:"hoverChanged",keyPressed:"keyPressed",featureContentLoaded:"featureContentLoaded",idle:"idle",routeChanged:"routeChanged",tilesLoaded:"tilesLoaded",tilesContentLoaded:"tilesContentLoaded",mapTypeChanged:"mapTypeChanged",mapClicked:"mapClicked"};class ar{constructor(e){this.registeredListeners=[],this.logger=e}pushEvent(e,t){this.logger.debug(`pushing event: ${e}`);for(let i of this.registeredListeners)i.eventType===e&&i.callback(t)}_registerInternalListener(e,t,i){if(t){let n;var r;if(i?(n=this._findInternalListener(e,void 0,i),null!==(r=n)&&void 0!==r&&r.id&&this._unregisterInternalListener(e,void 0,i),n=void 0):n=this._findInternalListener(e,t,void 0),!n){const r={id:i,eventType:e,callback:t};return this.registeredListeners.push(r),r}}}_identifyListener(e,t,i,r){return!(e.eventType!==t||r&&e.id!==r||i&&e.callback!==i)}_findInternalListener(e,t,i){if(!i&&!t)throw new Error("Can't find a listener with no id and no callback provided");return this.registeredListeners.find((r=>this._identifyListener(r,e,t,i)))}_unregisterInternalListener(e,t,i){const r=this._findInternalListener(e,t,i);return r&&(this.registeredListeners=this.registeredListeners.filter((r=>!this._identifyListener(r,e,t,i)))),r}addBoundChangeListener(e,t){return!!this._registerInternalListener(or.boundsChanged,e,t)}removeBoundChangeListener(e){return!!this._unregisterInternalListener(or.boundsChanged,e)}deregisterBoundChangeListener(e){return!!this._unregisterInternalListener(or.boundsChanged,void 0,e)}addMarkerChangeListener(e,t){return!!this._registerInternalListener(or.markersChanged,e,t)}removeMarkerChangeListener(e){return!!this._unregisterInternalListener(or.markersChanged,e)}deregisterMarkerChangeListener(e){return!!this._unregisterInternalListener(or.markersChanged,void 0,e)}addSelectionChangeListener(e,t){return!!this._registerInternalListener(or.selectionChanged,e,t)}removeSelectionChangeListener(e,t){return!!this._unregisterInternalListener(or.selectionChanged,e,t)}deregisterSelectionChangeListener(e){return!!this._unregisterInternalListener(or.selectionChanged,void 0,e)}addKeyPressListener(e,t){return!!this._registerInternalListener(or.keyPressed,e,t)}removeKeyPressListener(e){return!!this._unregisterInternalListener(or.keyPressed,e)}deregisterKeyPressListener(e){return!!this._unregisterInternalListener(or.keyPressed,void 0,e)}addHoverChangeListener(e,t){return!!this._registerInternalListener(or.hoverChanged,e,t)}removeHoverChangeListener(e){return!!this._unregisterInternalListener(or.hoverChanged,e)}deregisterHoverChangeListener(e){return!!this._unregisterInternalListener(or.hoverChanged,void 0,e)}addFeatureContentLoadedListener(e,t){return!!this._registerInternalListener(or.featureContentLoaded,e,t)}removeFeatureContentLoadedListener(e){return!!this._unregisterInternalListener(or.featureContentLoaded,e)}deregisterFeatureContentLoadedListener(e){return!!this._unregisterInternalListener(or.featureContentLoaded,void 0,e)}addIdleListener(e,t){return!!this._registerInternalListener(or.idle,e,t)}removeIdleListener(e){return!!this._unregisterInternalListener(or.idle,e)}deregisterIdleListener(e){return!!this._unregisterInternalListener(or.idle,void 0,e)}addRouteChangeListener(e,t){return!!this._registerInternalListener(or.routeChanged,e,t)}removeRouteChangeListener(e){return!!this._unregisterInternalListener(or.routeChanged,e)}deregisterRouteChangeListener(e){return!!this._unregisterInternalListener(or.routeChanged,void 0,e)}addTilesLoadedListener(e,t){return!!this._registerInternalListener(or.tilesLoaded,e,t)}removeTilesLoadedListener(e){return!!this._unregisterInternalListener(or.tilesLoaded,e)}deregisterTilesLoadedListener(e){return!!this._unregisterInternalListener(or.tilesLoaded,void 0,e)}addTilesContentLoadedListener(e,t){return!!this._registerInternalListener(or.tilesContentLoaded,e,t)}removeTilesContentLoadedListener(e){return!!this._unregisterInternalListener(or.tilesContentLoaded,e)}deregisterTilesContentLoadedListener(e){return!!this._unregisterInternalListener(or.tilesContentLoaded,void 0,e)}addMapTypeChangedListener(e,t){return!!this._registerInternalListener(or.mapTypeChanged,e,t)}deregisterMapTypeChangedListener(e){return!!this._unregisterInternalListener(or.mapTypeChanged,void 0,e)}addMapClickListener(e,t){return!!this._registerInternalListener(or.mapClicked,e,t)}deregisterMapClickListener(e){return!!this._unregisterInternalListener(or.mapClicked,void 0,e)}}class lr{constructor(e,t,i){this.id=Xt(),this.origin=e,this.destination=t,this.mode=i,this.distance=void 0}toString(){var e;return`Route: {origin:'${this.origin.id}',destination:${null===(e=this.destination)||void 0===e?void 0:e.id},mode:${this.mode}}`}originLatLng(){return{lat:this.origin.latLng[0],lng:this.origin.latLng[1]}}destinationLatLng(){return this.destination?{lat:this.destination.latLng[0],lng:this.destination.latLng[1]}:void 0}}class ur{constructor(e,t,i){let{logger:r,egDistances:n,routeLineStyleByDistanceMode:s,routeCacheInMs:o,findFeature:a,eventsManager:l,addRouteOnMap:u,removeRouteOnMap:h,asKey:d}=e;this.routes=t,this.routeDestinations=i,this.logger=r,this.egDistances=n,this.routeLineStyleByDistanceMode=s,this.findFeature=a,this.eventsManager=l,this.addRouteOnMap=u,this.removeRouteOnMap=h,this.asKey=d,this.routeCache=Ai(o,void 0,((e,t,i)=>"polyline"!==i[0]&&e))}_asRoute(e,t){var i,r;const n={origin:(null===(i=this.findFeature(e.origin.id,e.origin.type))||void 0===i?void 0:i.toData())||{id:e.origin.id,type:e.origin.type},destination:e.destination?(null===(r=this.findFeature(e.destination.id,e.destination.type))||void 0===r?void 0:r.toData())||{id:e.destination.id,type:e.destination.type}:void 0,transportMode:e.mode};return t&&(n.distance=e.distance),n}_asRouteDestinationFeature(e){const{id:t,type:i}=e.idAndType;return{destination:t&&i?this.findFeature(t,i):void 0,transportMode:e.transportMode}}_asRouteDestination(e){return{idAndType:{id:e.destination.id,type:e.destination.type},transportMode:e.mode}}_routeDestinationAsKey(e){const{id:t,type:i}=e.idAndType;return`${t}|${i}|${e.transportMode}`}_buildCacheKeys(e,t,i,r){const n=[];return n.push(e),t&&n.push(`${t.id}|${t.type}`),i&&n.push(`${i.id}|${i.type}`),r&&n.push(r),n}_sameRoute(e,t){var i,r,n,s;return e.origin.id===t.origin.id&&e.origin.type===t.origin.type&&(null===(i=e.destination)||void 0===i?void 0:i.id)===(null===(r=t.destination)||void 0===r?void 0:r.id)&&(null===(n=e.destination)||void 0===n?void 0:n.type)===(null===(s=t.destination)||void 0===s?void 0:s.type)&&e.mode===t.mode}_sameFeature(e,t){return e.id===t.id&&e.type===t.type}_sameRouteDestination(e,t){return e.idAndType.id===t.idAndType.id&&e.idAndType.type===t.idAndType.type&&e.transportMode===t.transportMode}showRoutes(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._asRouteDestinationFeature.bind(this);return Li((t&&t.length>0?t.map(r):[...this.listRegisteredRoutes(e).map((e=>{let{destination:t}=e;return{destination:t.idAndType,transportMode:t.transportMode}})),...this.routeDestinations]).map((t=>new lr(e,t.destination,t.transportMode))).filter((e=>!this.routes.some((t=>this._sameRoute(t,e)))&&!this._sameFeature(e.origin,e.destination))).map((t=>new Promise(((i,r)=>{const{destination:n,mode:s}=t;let o;const a="none"===this.routeLineStyleByDistanceMode[t.mode].lineStyle,l=a?void 0:this.routeCache.get(...this._buildCacheKeys("polyline",e,n,s));if(l)o=Promise.resolve(l);else{const i=this._buildCacheKeys(a?"distance":"route",e,n,s),r=this.routeCache.get(...i);if(r)o=Promise.resolve(r);else{if(!this.egDistances)return Promise.reject("EGDistances is not enabled: routes or distances can't be computed on demand");o=a?this.fetchDistance(t,i):this.fetchRoute(t,i)}}o.then((e=>{let{route:t,egDistanceRoute:r,routeResult:n}=e;t&&(this.routes.push(t),r?this.addRouteOnMap(t,r).then((e=>i(t))):n?this.addRouteOnMap(t,n).then((e=>i(t))):i(t))})).catch((e=>r({error:e,route:t})))}))))).then((e=>{const t=e.filter((e=>"fulfilled"===e.status)).map((e=>e.value)).filter((e=>void 0!==e));e.filter((e=>"rejected"===e.status)).forEach(this._handleReject.bind(this));const r=t.map((e=>this._asRoute(e,!0)));return i&&r.length>0&&this._handleRouteChanged(!0,r),r}))}fetchDistance(e,t){return this.egDistances.getDistances(e.originLatLng(),e.destinationLatLng(),e.mode).then((i=>{if("SUCCESS"===i.status){e.distance=i.matrix[0][0].modes[e.mode];const r={route:e};return this.routeCache.set(r,...t),r}throw new Error(i.errors.join(", "))}))}handleFlight(e){const t=e.originLatLng(),i=e.destinationLatLng(),r=e;return r.copyrights="",r.warnings="",r.status="SUCCESS",r.route={path:[t,i],mode:r.mode},Promise.resolve(r)}fetchRoute(e,t){let i;return i="flying"==e.mode?this.handleFlight(e):this.egDistances.getRoute(e.originLatLng(),e.destinationLatLng(),e.mode),i.then((i=>{if("SUCCESS"===i.status){e.distance=i.route.distance;const r={route:e,egDistanceRoute:i};return this.routeCache.set(r,...t),r}throw new Error(i.error)}))}registerRoute(e,t,i){const{idAndType:r,transportMode:n}=t,s=this._buildCacheKeys("polyline",e,r,n);if(!this._sameFeature(e,r))if(void 0!==e.id&&e.type&&void 0!==r.id&&r.type&&i){const t=this.findFeature(e.id,e.type),o=this.findFeature(r.id,r.type);if(t&&o){const e=new lr(t,o,n),r={route:{path:sr().decode(i).map((e=>{let[t,i]=e;return{lat:t,lng:i}}))}};return this.routeCache.set({route:e,routeResult:r},...s),!0}}else this.logger.warn(`Cannot register route from (${e.id}, ${e.type}) to \n          (${r.id}, ${r.type} with polyline ${i}. A mandatory parameter is missing.`);return!1}updateRoutesOnViewport(){const e=[...this.routes];return this.hideRoutes().then((()=>Promise.all(e.map((e=>this.showRoutes(e.origin,[this._asRouteDestination(e)],!1)))))).then((()=>{}))}listRegisteredRoutes(e){const t=this._buildCacheKeys("polyline",e);return this.routeCache.keys(...t).flatMap((e=>{const t=this.routeCache.get(...e);if(t){const{route:e,routeResult:i}=t;return[{origin:{id:e.origin.id,type:e.origin.type},destination:{idAndType:{id:e.destination.id,type:e.destination.type},transportMode:e.mode},polyline:sr().encode(i.route.path)}]}return[]}))}deregisterRoute(e,t){const i=this.listRegisteredRoutes(e).filter((e=>{let{destination:i}=e;return!t||this._sameRouteDestination(i,t)})).map((e=>{const{origin:t,destination:i}=e,r=this._buildCacheKeys("polyline",t,i.idAndType,i.transportMode);return this.routeCache.set(void 0,...r),e}));if(i){const t=this.findFeature(e.id,e.type);this.hideRoutes(t,i.map((e=>e.destination)))}return i}_handleReject(e){const{reason:{message:t,stack:i,error:r,route:n}}=e;r?/OVER_QUERY_LIMIT/.test(null==r?void 0:r.message)?this.logger.info(`Error when showing route ${n}: ${r.message}`,r.stack):this.logger.warn(`Error when showing route ${n}: ${r.message}`,r.stack):t&&this.logger.error(`Error when showing route ${t}`,i)}hideRoutes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._asRoute.bind(this),n=this.asKey,s=t.length>0?t.map((e=>`${this.asKey(e.idAndType)}-${e.transportMode}`)):void 0;return Promise.all(this.routes.filter((t=>(!e||t.origin.id===e.id&&t.origin.type===e.type)&&(!s||s.includes(`${n(t.destination)}-${t.mode}`)))).map((e=>this.removeRouteOnMap(e).then((()=>(this.routes.splice(this.routes.findIndex((t=>e===t)),1),e)))))).then((e=>(i&&e.length>0&&this._handleRouteChanged(!1,e),e.map((e=>r(e))))))}listRoutesDisplayed(){return this.routes.map((e=>this._asRoute(e,!0)))}_handleRouteChanged(e,t){const i={routes:t,action:e?"show":"hide"};this.eventsManager.pushEvent(or.routeChanged,i)}registerRouteDestination(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach((e=>{var t;if(null===(t=this.listRegisteredRouteDestinations())||void 0===t||!t.map(this._routeDestinationAsKey).includes(this._routeDestinationAsKey(e))){const{id:t,type:i}=e.idAndType,r=e.transportMode,n=this.findFeature(t,i);n&&this.routeDestinations.push({destination:n,transportMode:r})}}))}listRegisteredRouteDestinations(){return this.routeDestinations.flatMap((e=>{const t=e.destination,i=e.transportMode;return t?[{idAndType:{id:t.id,type:t.type},transportMode:i}]:[]}))}deregisterRouteDestination(){const e=[];for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return i.forEach((t=>{const{id:i,type:r}=t.idAndType,n=t.transportMode,s=this.routeDestinations.findIndex((e=>e.destination&&e.destination.id===i&&e.destination.type===r&&e.transportMode===n));s>=0&&(this.routeDestinations.splice(s,1),e.push(t))})),this.hideRoutes(void 0,e),e}}const{firstDefinedValue:hr,removeDuplicates:dr}=t;class cr{constructor(e){let{logger:t,findFeature:i,addPolygonsOnMap:r,removePolygonsOnMap:n,asKey:s,polygons:o,polygonStyles:a}=e;this.logger=t,this.findFeature=i,this.addPolygonsOnMap=r,this.removePolygonsOnMap=n,this.asKey=s,this.polygons=o,this.polygonStyles=a,this.polygons.length>0&&this.showPolygons(...this.polygons)}_isPolygonDisplayed(e){return this.polygons.some((t=>this.asKey(t)===this.asKey(e)))}_isPolygonNotDisplayed(e){return!this._isPolygonDisplayed(e)}showPolygons(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=dr(t.filter(this._isPolygonNotDisplayed.bind(this))),n=this._findPolygonToDisplay(r);return this.addPolygonsOnMap(n).then((e=>(this.polygons.push(...e),e)))}hidePolygons(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=t.length>0?t.filter(this._isPolygonDisplayed.bind(this)):[...this.polygons];return this.removePolygonsOnMap(r).then((e=>(e.forEach((e=>{this.polygons.splice(this.polygons.indexOf(e),1)})),e)))}_findPolygonToDisplay(e){return e.map((e=>{let{id:t,type:i}=e;const r=this.findFeature(t,i);if(r&&r.polygon){const e=hr(this.polygonStyles[i],r.hashKeys);return{polygonDisplayed:{id:t,type:i,polygon:r.polygon},style:e}}})).filter((e=>void 0!==e))}listPolygonsDisplayed(){return this._findPolygonToDisplay(this.polygons).map((e=>e.polygonDisplayed))}updatePolygonsOnViewport(){const e=[...this.polygons];return this.hidePolygons().then((()=>this.showPolygons(...e))).then((()=>{}))}}function pr(e,t){return!!t&&e.from===t.from&&e.to===t.to&&Ut(e.roomOccupancies,t.roomOccupancies,!1,((e,t)=>function(e,t){return(e.nbAdults||0)===(t.nbAdults||0)&&Ut(e.childrenAges||[],t.childrenAges||[])}(e,t)))}class gr{constructor(e,t){this.availabilityProvider=t,this.logger=e("AvailabilityCheck"),this.availabilityProvider=void 0,this.featureComputationInProgress=new Map,this.stay=void 0}saveStay(e){return!(!e||this.stay&&pr(e,this.stay)||(this.stay=e,this.featureComputationInProgress.clear(),0))}isAvailabilityCheckActive(){return void 0!==this.availabilityProvider&&void 0!==this.stay}updateAvailability(e){if(!this.isAvailabilityCheckActive())return Promise.resolve([]);const{stay:t}=this,i=[],r=Date.now(),n=e.length,s=new Map;for(let u=0;u<n;u++){const t=e[u],{id:n}=t;!this.featureComputationInProgress.has(n)&&t.hasTileData()&&"unknown"===t.toTileData().status&&(i.push(n),s.set(n,u),this.featureComputationInProgress.set(n,r))}if(0===i.length)return Promise.resolve([]);const o=[],a=Tt(i,300),l=a.length;for(let u=0;u<l;u++)o.push(this.availabilityProvider.checkAvailability(t,a[u]));return Li(o).then((i=>(i.filter((e=>"rejected"===e.status)).forEach((e=>{this.logger.error(`Check availability failed with result ${e.reason}`)})),i.filter((e=>"fulfilled"===e.status)).map((i=>i.value.map((i=>{const r=s.get(i.id);if(r>=0&&this.stay===t){const t=e[r];return t.mergeTileData(i),t}})).filter((e=>void 0!==e)))).flat()))).finally((()=>{i.forEach((e=>this.featureComputationInProgress.delete(e)))}))}}var fr={variant:"var",defaultClusterProductLabel:"prodClusterLbl",defaultClusterPropertyLabel:"propClusterLbl",defaultClusterPlaceLabel:"placeClusterLbl",keyboardFeaturesNoData:"keybFeatNoData",keyboardFeaturesPreviousPage:"keybFeatPrev",keyboardFeaturesNextPage:"keybFeatNext",filterBoxLegend:"fboxLegend",ariaFilterBoxToggleLegend:"ariaFboxTglLegend",ariaFilterBoxImgProductAvailable:"ariaFboxImgProdAvailable",ariaFilterBoxImgProductFiltered:"ariaFboxImgProdFiltered",ariaFilterBoxImgProductSoldOut:"ariaFboxImgProdSoldOut",ariaFilterBoxImgProductUnknown:"ariaFboxImgProdUnknown",ariaFilterBoxImgPropertyAvailable:"ariaFboxImgPropAvailable",ariaFilterBoxImgPropertyFiltered:"ariaFboxImgPropFiltered",ariaFilterBoxImgPropertySoldOut:"ariaFboxImgPropSoldOut",ariaFilterBoxImgPropertyUnknown:"ariaFboxImgPropUnknown",ariaFilterBoxCheckBoxProductAvailable:"ariaFboxCbProdAvailable",ariaFilterBoxCheckBoxProductFiltered:"ariaFboxCbProdFiltered",ariaFilterBoxCheckBoxProductSoldOut:"ariaFboxCbProdSoldOut",ariaFilterBoxCheckBoxProductUnknown:"ariaFboxCbProdUnknown",ariaFilterBoxCheckBoxPropertyAvailable:"ariaFboxCbPropAvailable",ariaFilterBoxCheckBoxPropertyFiltered:"ariaFboxCbPropFiltered",ariaFilterBoxCheckBoxPropertySoldOut:"ariaFboxCbPropSoldOut",ariaFilterBoxCheckBoxPropertyUnknown:"ariaFboxCbPropUnknown",filterBoxProductAvailable:"fboxProductAvailable",filterBoxProductFiltered:"fboxProductFiltered",filterBoxProductSoldOut:"fboxProductSoldOut",filterBoxProductUnknown:"fboxProductUnknown",filterBoxPropertyAvailable:"fboxPropertyAvailable",filterBoxPropertyFiltered:"fboxPropertyFiltered",filterBoxPropertySoldOut:"fboxPropertySoldOut",filterBoxPropertyUnknown:"fboxPropertyUnknown",filterBoxPlaceUnknown:"fboxPlaceUnknown",ariaFilterBoxImgPlaceUnknown:"ariaFboxImgPlaceUnknown",ariaFilterBoxCheckBoxPlaceUnknown:"ariaFboxCbPlaceUnknown"},mr={default:{[fr.variant]:"default",[fr.defaultClusterProductLabel]:"{0} products",[fr.defaultClusterPropertyLabel]:"{0} properties",[fr.defaultClusterPlaceLabel]:"{0} places",[fr.keyboardFeaturesNoData]:"no data",[fr.keyboardFeaturesPreviousPage]:"Show previous...",[fr.keyboardFeaturesNextPage]:"Show next...",[fr.filterBoxLegend]:"Legend",[fr.ariaFilterBoxToggleLegend]:"Toggle legend",[fr.ariaFilterBoxImgProductAvailable]:"icon used for products matching dates and criteria",[fr.ariaFilterBoxImgProductFiltered]:"icon used for products matching dates but not your criteria",[fr.ariaFilterBoxImgProductSoldOut]:"icon used for products not available for these dates",[fr.ariaFilterBoxImgProductUnknown]:"icon used for products with no availability information for these dates",[fr.ariaFilterBoxImgPropertyAvailable]:"icon used for properties matching dates and criteria",[fr.ariaFilterBoxImgPropertyFiltered]:"icon used for properties matching dates but not your criteria",[fr.ariaFilterBoxImgPropertySoldOut]:"icon used for properties not available for these dates",[fr.ariaFilterBoxImgPropertyUnknown]:"icon used for properties with no availability information for these dates",[fr.ariaFilterBoxCheckBoxProductAvailable]:"filter products matching dates and criteria",[fr.ariaFilterBoxCheckBoxProductFiltered]:"filter products matching dates but not your criteria",[fr.ariaFilterBoxCheckBoxProductSoldOut]:"filter products sold out for these dates",[fr.ariaFilterBoxCheckBoxProductUnknown]:"filter products with no availability information for these dates",[fr.ariaFilterBoxCheckBoxPropertyAvailable]:"filter properties matching dates and criteria",[fr.ariaFilterBoxCheckBoxPropertyFiltered]:"filter properties matching dates but not your criteria",[fr.ariaFilterBoxCheckBoxPropertySoldOut]:"filter properties sold out for these dates",[fr.ariaFilterBoxCheckBoxPropertyUnknown]:"filter properties with no availability information for these dates",[fr.filterBoxProductAvailable]:"Matches dates and criteria",[fr.filterBoxProductFiltered]:"Doesn’t match your criteria",[fr.filterBoxProductSoldOut]:"Sold out for these dates",[fr.filterBoxProductUnknown]:"Availability unknown",[fr.filterBoxPropertyAvailable]:"Matches dates and criteria",[fr.filterBoxPropertyFiltered]:"Doesn’t match your criteria",[fr.filterBoxPropertySoldOut]:"Sold out for these dates",[fr.filterBoxPropertyUnknown]:"Availability unknown",[fr.filterBoxPlaceUnknown]:"Places",[fr.ariaFilterBoxImgPlaceUnknown]:"icon used for places",[fr.ariaFilterBoxCheckBoxPlaceUnknown]:"filter places"},"en-US":{[fr.variant]:"en-US"},en:{[fr.variant]:"en"},fr:{[fr.variant]:"fr",[fr.defaultClusterProductLabel]:"{0} établissements",[fr.defaultClusterPropertyLabel]:"{0} établissements",[fr.defaultClusterPlaceLabel]:"{0} points d'intérêt",[fr.keyboardFeaturesNoData]:"Pas de données",[fr.keyboardFeaturesPreviousPage]:"Afficher les précédents...",[fr.keyboardFeaturesNextPage]:"Afficher les suivants...",[fr.filterBoxLegend]:"Légende",[fr.ariaFilterBoxToggleLegend]:"Afficher la légende",[fr.ariaFilterBoxImgProductAvailable]:"icône pour les établissements disponibles et vérifiant les critères",[fr.ariaFilterBoxImgProductFiltered]:"icône pour les établissements disponibles mais ne vérifiant pas les critères",[fr.ariaFilterBoxImgProductSoldOut]:"icône pour les établissements non disponibles pour les dates",[fr.ariaFilterBoxImgProductUnknown]:"icône pour les établissements sans information de disponibilité",[fr.ariaFilterBoxImgPropertyAvailable]:"icône pour les établissements disponibles et vérifiant les critères",[fr.ariaFilterBoxImgPropertyFiltered]:"icône pour les établissements disponibles mais ne vérifiant pas les critères",[fr.ariaFilterBoxImgPropertySoldOut]:"icône pour les établissements non disponibles pour les dates",[fr.ariaFilterBoxImgPropertyUnknown]:"icône pour les établissements sans information de disponibilité",[fr.ariaFilterBoxCheckBoxProductAvailable]:"filtre pour les établissements disponibles et vérifiant les critères",[fr.ariaFilterBoxCheckBoxProductFiltered]:"filtre pour les établissements disponibles mais ne vérifiant pas les critères",[fr.ariaFilterBoxCheckBoxProductSoldOut]:"filtre pour les établissements non disponibles pour les dates",[fr.ariaFilterBoxCheckBoxProductUnknown]:"filtre pour les établissements sans information de disponibilité",[fr.ariaFilterBoxCheckBoxPropertyAvailable]:"filtre pour les établissements disponibles et vérifiant les critères",[fr.ariaFilterBoxCheckBoxPropertyFiltered]:"filtre pour les établissements disponibles mais ne vérifiant pas les critères",[fr.ariaFilterBoxCheckBoxPropertySoldOut]:"filtre pour les établissements non disponibles pour les dates",[fr.ariaFilterBoxCheckBoxPropertyUnknown]:"filtre pour les établissements sans information de disponibilité",[fr.filterBoxProductAvailable]:"Disponibles",[fr.filterBoxProductFiltered]:"Disponibles mais filtrés",[fr.filterBoxProductSoldOut]:"Indisponible",[fr.filterBoxProductUnknown]:"Disponibilité inconnue",[fr.filterBoxPropertyAvailable]:"Disponibles",[fr.filterBoxPropertyFiltered]:"Disponibles mais filtrés",[fr.filterBoxPropertySoldOut]:"Indisponible",[fr.filterBoxPropertyUnknown]:"Disponibilité inconnue",[fr.filterBoxPlaceUnknown]:"Points d'intérêt",[fr.ariaFilterBoxImgPlaceUnknown]:"icône pour les point d'intérêts",[fr.ariaFilterBoxCheckBoxPlaceUnknown]:"filtre pour les point d'intérêts"}};const yr=["1","2","3","4","5","6","7","8","9"],vr={cluster:{available:9,filtered:7,sold_out:3,unknown:1},product:{available:10,filtered:8,sold_out:4,unknown:2},property:{available:10,filtered:8,sold_out:4,unknown:2},place:{unknown:5}},br="keydown",kr="keypress",Mr="no-data",Pr="keyboard-features-enabled",Lr="keyboard-features-list",Cr="keyboard-features-list-element",_r="keyboard-features-list-element-info",wr="keyboard-features-list-element-number",xr="keyboard-features-list-element-div",Fr="keyboard-features-list-nav",Or="keyboard-features-not-in-list-marker",Er="kbc-button";class Ir{constructor(e,t){this.keyboardFeaturesIcon=e,this.getI18N=t,this.keyboardNavigationMode=!1,this.keyPressZero=48,this.keyDownBackspace=8,this.pageIndex=0,this.pageCount=0,this.uiElementIds=[]}init(e){let{node:t,uniqId:i,containerBounds:r,listFeatures:n,zIndexes:s,maxZIndex:o,getMapNavFocusElement:a,registerListenerOnMapFocusElement:l,handleClick:u,actionsOnClick:h,isFeatureSelected:d,clearSelectedFeature:c}=e;this.node=t,this.containerBounds=r,this.listFeatures=n,this.zIndexes=s,this.maxZIndex=o,this.getMapNavFocusElement=a,this.registerListenerOnMapFocusElement=l,this.handleClick=u,this.actionsOnClick=h,this.isFeatureSelected=d,this.clearSelectedFeature=c;const p=i("keyboard-features");this._createKeyboardFeaturesIcon(p),this._createKeyboardFeaturesSquare(p),this._createKeyboardFeaturesList(p),this._initializeListeners()}removeAllUIElements(){this.uiElementIds.forEach((e=>ce(this.node,e)))}_createKeyboardFeaturesIcon(e){const t=`${e}-icon`;this.keyboardIcon=me(t,this.node,"keyboard-features-icon",void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ve(this.keyboardIcon);const i=this.keyboardFeaturesIcon;Ae(_e(`${e}-img`,this.keyboardIcon,"keyboard-features-icon-img",void 0,i,"icon to show that keyboard features is enabled")),Ue(this.keyboardIcon,this.maxZIndex+1)}_createKeyboardFeaturesSquare(e){const t=`${e}-focus`;this.focusArea=me(t,this.node,"keyboard-features-focus-area",void 0),this.uiElementIds.push(t),this.keyboardNavigationMode||Ve(this.focusArea),Ue(this.focusArea,this.maxZIndex+1)}_createKeyboardFeaturesList(e){const t=`${e}-features`;this.keybNavFeatures=me(t,this.node,"keyboard-features-dialog",void 0),this.uiElementIds.push(t),this.keybNavFeaturesList=ye(`${e}-list`,this.keybNavFeatures,`${Lr} ${Mr}`,void 0),this.keybNavFeaturesElements=[];for(let d=0;d<7;d++){const t=ve(`${e}-elt-${d+1}`,this.keybNavFeaturesList,`${Cr} ${Mr}`,void 0);Me(`${t.id}-info`,t,_r,void 0,"-"),this.keybNavFeaturesElements.push(t)}const i=this.getI18N(fr.keyboardFeaturesNoData);this.keybNavNoFeatures=Me(`${e}-nodata`,this.keybNavFeatures,`${Lr}-no-feature-message`,void 0,i),this.keyboardNavigationMode||Ve(this.keybNavFeatures),Ue(this.keybNavFeatures,this.maxZIndex+1);const r=`${Cr} ${Fr} ${Fr}-previous ${Mr}`,n=ve(`${e}-elt-prev`,this.keybNavFeaturesList,r,void 0),s=this.getI18N(fr.keyboardFeaturesPreviousPage),o=me(`${n.id}-container`,n,xr,void 0);Me(`${n.id}-number`,o,`${wr} ${Er}`,void 0,yr[7]),Me(`${n.id}-info`,o,_r,void 0,s),this.keybNavFeaturesElements.push(n);const a=`${Cr} ${Fr} ${Fr}-next ${Mr}`,l=ve(`${e}-elt-next`,this.keybNavFeaturesList,a,void 0),u=this.getI18N(fr.keyboardFeaturesNextPage),h=me(`${l.id}-container`,l,xr,void 0);Me(`${l.id}-number`,h,`${wr} ${Er}`,void 0,yr[8]),Me(`${l.id}-info`,h,_r,void 0,u),this.keybNavFeaturesElements.push(l)}_clickFeatureAtIndex(e){const t=this.features[7*this.pageIndex+e];if(t)return this.isFeatureSelected(t)?this.clearSelectedFeature():(this.handleClick(t,!0,this.actionsOnClick,"dialog-keyboard-pressed"),"cluster"!==t.type&&Wn(t.marker)),!0}_paginateFeaturePage(e){return e&&this.pageIndex<this.pageCount-1?(this.pageIndex+=1,!0):!e&&this.pageIndex>0&&(this.pageIndex-=1,!0)}_clearSelectedFeature(){return this.clearSelectedFeature(),!0}_initializeListeners(){this.registerListenerOnMapFocusElement(kr,(e=>{const t=(e.which||e.keyCode||e.key)-this.keyPressZero;let i=!1;t>=0&&t<=9&&(e.preventDefault(),0===t?this._clearSelectedFeature():t<=7?this._clickFeatureAtIndex(t-1):i=8===t?this._paginateFeaturePage(!1):this._paginateFeaturePage(!0),i&&this._updateKeyboardFeaturesDialog())})),this.registerListenerOnMapFocusElement(br,(e=>{Number(e.which||e.keyCode||e.key)===this.keyDownBackspace&&(e.preventDefault(),this.clearSelectedFeature(),this._updateKeyboardFeaturesDialog())}))}refreshKeyboardNavIconVisibility(e){(void 0!==e?e:this.keyboardNavigationMode)?je(this.keyboardIcon):Ve(this.keyboardIcon)}_resetFeatures(e){const t=this._resetMarker.bind(this);e&&e.forEach(t)}_resetMarker(e){e&&e.marker&&Ge(e.marker.cssElement,Or)&&(st(e.marker.cssElement,Or),qn(e.marker,wt(this.zIndexes[e.type],e.hashKeys)))}_updateFeatureMarkersAsNotInList(e){e&&e.forEach((e=>{qn(e.marker,1),rt(e.marker.cssElement,Or)}))}_clear(){this._resetFeatures(this.features)}turnKeyboardFeaturesMode(e){if(!this.node)throw new Error("You need to have the map initialized to turn on the keyboard navigation");this.keyboardNavigationMode=e,e?rt(this.node,Pr):st(this.node,Pr),this.keyboardNavigationMode&&document.activeElement===this.getMapNavFocusElement()?je(this.keyboardIcon):Ve(this.keyboardIcon),this.keyboardNavigationMode?(je(this.focusArea),je(this.keybNavFeatures)):(Ve(this.focusArea),Ve(this.keybNavFeatures)),this.keyboardNavigationMode||this._clear()}isKeyboardFeaturesModeEnabled(){return this.keyboardNavigationMode}_computeScore(e){return vr[e.type][e.status||("cluster"===e.type?"available":"unknown")]+(e.score||0)*(e.score<1?1:Math.pow(10,-(""+e.score).split(".")[0].length))+Math.pow(10,-5)*(e.children||[]).length}_prioritizeFeaturesForKeyboardNav(e,t){const i=this._computeScore(e),r=this._computeScore(t);return i===r?(""+e.name).localeCompare(t.name):r-i}updateKeyboardFeatures(){if(this.keyboardNavigationMode){const e=this.containerBounds(this.focusArea);e&&(this._resetFeatures(this.features),this.features=this.listFeatures((e=>e.visible),e).sort(this._prioritizeFeaturesForKeyboardNav.bind(this)),this.pageCount=0===this.features.length?0:Math.floor((this.features.length-1)/7+1),this.pageIndex>=this.pageCount&&(this.pageIndex=0),this._updateKeyboardFeaturesDialog())}}_updateKeyboardFeaturesDialog(){0===this.pageCount?rt(this.keybNavFeaturesList,Mr):st(this.keybNavFeaturesList,Mr);const e=[];for(let s=0;s<7;s++){var t;const r=null===(t=this.keybNavFeaturesElements)||void 0===t?void 0:t[s];if(r){he(r);const t=this.features[7*this.pageIndex+s];if(t){st(r,Mr);const n=me(`${r.id}-container`,r,xr,void 0);if(Me(`${r.id}-number`,n,`${wr} ${Er}`,void 0,yr[s]),t.marker){this._resetMarker(t);const e=t.marker.clone();var i;if(e&&(lt(e,null==e||null===(i=e.dataset)||void 0===i?void 0:i.cloneStyles),ne(e,void 0,!0).map((e=>e.element)).forEach((e=>ht(e)))),rt(e,"keyboard-features-list-element-icon"),"cluster"===t.type){const[t]=ne(e,["cluster-label-content"],!0).map((e=>e.element));rt(t,"no-text-overflow"),t.innerHTML=t.innerHTML.replace(/\s/g," ")}n.appendChild(e)}e.push(t),"cluster"!==t.type&&Me(`${r.id}-info-${t.id}`,n,_r,void 0,t.name||`${t.type} ${t.id}`)}else rt(r,Mr)}}this._updateFeatureMarkersAsNotInList((this.features||[]).filter((t=>!e.includes(t)&&t.marker)));const[,,,,,,,r,n]=this.keybNavFeaturesElements||[];this._updateNavButton(r,this.pageCount<=1,0===this.pageIndex),this._updateNavButton(n,this.pageCount<=1,this.pageIndex===this.pageCount-1)}_updateNavButton(e,t,i){const r="disabled";t?(rt(e,Mr),st(e,r)):(st(e,Mr),i?rt(e,r):st(e,r))}}const Sr="ArrowUp",Dr="ArrowDown",Ar="ArrowRight",Tr="ArrowLeft",Br="+",Rr="-",Nr="moveKeyboard",Kr="zoomInKeyboard",Vr="zoomOutKeyboard",jr={[Nr]:"center_changed",[Kr]:"zoom_changed",[Vr]:"zoom_changed"};class zr{constructor(e,t,i){this.panBy=e,this.zoomIn=t,this.zoomOut=i,this.events=[],this.deltaX=5,this.deltaY=5,this.keyDownListenerCallback=this._keyDownListenerCallback.bind(this),this.keyUpListenerCallback=this._keyUpListenerCallback.bind(this),this.keyPressListenerCallback=this._keyPressListenerCallback.bind(this)}_panUntil(e,t,i){this.panBy(e),setTimeout((()=>{if(t()){const e=i();this._panUntil(e,t,i)}}),40)}_keyDownListenerCallback(e){const{key:t}=e;if([Sr,Dr,Tr,Ar].includes(t))switch(e.preventDefault(),t){case Sr:this.keyUpPressed||(this.keyUpPressed=!0,this._panUntil([0,-this.deltaY],(()=>this.keyUpPressed),(()=>(this.deltaY<100&&(this.deltaY+=7),[0,-this.deltaY]))));break;case Dr:this.keyDownPressed||(this.keyDownPressed=!0,this._panUntil([0,this.deltaY],(()=>this.keyDownPressed),(()=>(this.deltaY<100&&(this.deltaY+=7),[0,this.deltaY]))));break;case Tr:this.keyLeftPressed||(this.keyLeftPressed=!0,this._panUntil([-this.deltaX,0],(()=>this.keyLeftPressed),(()=>(this.deltaX<100&&(this.deltaX+=7),[-this.deltaX,0]))));break;case Ar:this.keyRightPressed||(this.keyRightPressed=!0,this._panUntil([this.deltaX,0],(()=>this.keyRightPressed),(()=>(this.deltaX<100&&(this.deltaX+=7),[this.deltaX,0]))))}}_keyUpListenerCallback(e){const{key:t}=e;if([Sr,Dr,Tr,Ar].includes(t)){switch(e.preventDefault(),t){case Sr:this.keyUpPressed=!1,this.deltaY=5;break;case Dr:this.keyDownPressed=!1,this.deltaY=5;break;case Tr:this.keyLeftPressed=!1,this.deltaX=5;break;case Ar:this.keyRightPressed=!1,this.deltaX=5}this.events.splice(0,0,Nr)}}_keyPressListenerCallback(e){const{key:t}=e;if([Br,Rr].includes(t))switch(e.preventDefault(),t){case Br:this.events.splice(0,0,Kr),this.zoomIn();break;case Rr:this.events.splice(0,0,Vr),this.zoomOut()}}extractKeyboardEvent(e){const t=this.events.filter((t=>jr[t]===e));return this.events=this.events.filter((t=>jr[t]!==e)),Bt(t)}}class $r{constructor(e,t,i,r){this.featureTypeProviders={},t.forEach((t=>{const n={};i[t].forEach((t=>{const i=r[t],s=r[i.type];if(!s)throw new Error(`Content provider ${i.type} not supported`);if(!s.checkPackageIsLoaded())throw new Error(`You need to load the package supporting the content provider service ${i.type}`);n[t]=s.newInstance(e,i)})),this.featureTypeProviders[t]=n}))}getFeatureProviders(){return this.featureTypeProviders}}class Ur{constructor(e,t,i,r){[e,t,i,r].some((e=>"object"==typeof e&&e.lng&&e.lat))?(this.x1=i.lng,this.x2=t.lng,this.y1=e.lat,this.y2=t.lat):(this.x1=e,this.x2=i,this.y1=t,this.y2=r),this.coordinates=[{lng:this.x2,lat:this.y1},{lng:this.x2,lat:this.y2},{lng:this.x1,lat:this.y2},{lng:this.x1,lat:this.y1},{lng:this.x2,lat:this.y1}]}getCoordinates(){return this.coordinates}getOriginPoints(){return[this.x1,this.y1,this.x2,this.y2]}containsPoint(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2}containsBoundingBox(e){const t=e.getOriginPoints();return this.containsPoint(t[0],t[1])&&this.containsPoint(t[2],t[3])}}function Zr(e,t,i,r){return[{lng:i,lat:t},{lng:i,lat:r},{lng:e,lat:r},{lng:e,lat:t},{lng:i,lat:t}]}function Hr(e,t){const{lowerQuantile:i=.1,upperQuantile:r=.9,marginMultiplier:n=.2,minMargin:s=.01}=e,o=t.map((e=>e.lat||e[0])),a=t.map((e=>e.lng||e[1]));let l,u,h,d;a.length>10?(l=qr(a,i),u=qr(a,r),h=qr(o,i),d=qr(o,r)):({lowerLongitude:l,upperLongitude:u,lowerLatitude:h,upperLatitude:d}=function(e,t){return{lowerLongitude:Math.min(...e),upperLongitude:Math.max(...e),lowerLatitude:Math.min(...t),upperLatitude:Math.max(...t)}}(a,o));const c=Math.max(n*(u-l),s),p=Math.max(n*(d-h),s);return new Ur(l-c,h-p,u+c,d+p)}function qr(e,t){const i=e.sort(((e,t)=>e-t));let r=(i.length-1)*t,n=Math.floor(r),s=r-n;return void 0!==i[n+1]?i[n]+s*(i[n+1]-i[n]):i[n]}function Wr(e,t){const[i,r,n,s]=e.getOriginPoints(),o=n-i,a=s-r,l=(r+s)/2,u=1/Math.cos(l*Math.PI/180),h=u*(a/o);if(h>t){const e=(u*a/t-o)/2;return Zr(i-e,r,n+e,s)}if(h<t){const e=(o*t/u-a)/2;return Zr(i,r-e,n,s+e)}return e.getCoordinates()}class Gr{computeBoundingBox(e,t,i,r,n){if(!e||0===e.length)throw new Error("Cannot calculate bounds. No valid coordinate values given.");if(!t)return e[0].lat?e:e.map((e=>({lat:e[0],lng:e[1]})));const s=null!=i?i:{},o=function(e,t,i,r){const{minimumPins:n=50,interpolationRatio:s=.75}=e;if(i<=n){if(r){const e=new Ur(...r);if(e.containsBoundingBox(t)){const[i,r,n,o]=e.getOriginPoints(),[a,l,u,h]=t.getOriginPoints();return new Ur(a+(i-a)*s,l+(r-l)*s,u+(n-u)*s,h+(o-h)*s)}return t}return t}return t}(s,Hr(s,e),e.length,r);return Wr(o,n)}computeCenteredBoundingBox(e,t,i){if(!e||0===e.length)throw new Error("Cannot calculate bounds. No valid coordinate values given.");return Wr(function(e,t){var i,r;const n=null!==(i=e.lat)&&void 0!==i?i:e[0],s=null!==(r=e.lng)&&void 0!==r?r:e[1],o=Ui(n,t.map((e=>{var t;return null!==(t=e.lat)&&void 0!==t?t:e[0]})),!1),a=Ui(s,t.map((e=>{var t;return null!==(t=e.lng)&&void 0!==t?t:e[1]})),!0),l=s-a,u=Kt(n+(n-o),void 0,!1),h=Kt(s+l,void 0,!0);switch(Zi([n,s],[o,a])){case"sw":return new Ur(a,o,h,u);case"ne":return new Ur(h,u,a,o);case"se":return new Ur(h,o,a,u);default:return new Ur(a,u,h,o)}}(t.centeredOn,e),i)}}const{roundLatLng:Qr,listHashKeysSorted:Xr,arrayEquals:Yr,undefNullEmpty:Jr}=t,en="qualifiers",tn={default:void 0,onSelect:void 0},rn="product",nn="property",sn="place",on="cluster",an=[rn,nn],ln=[rn,nn,sn],un="unknown",hn=["available","filtered","sold_out",un],dn=hn,cn=[...ln,on];class pn{constructor(e,t,i){this.id=e,this.type=t,this.configHelper=i,this.data=[void 0,void 0],this.visible=!1,this.intersectingKeys=[],this._clean()}_clean(){this.marker=void 0,this.popupContent=void 0,this.visible=!1,this.inBounds=!0,this._highlighted=!1,this.clearHashkeys(),this.intersectingKeys=[]}updateConfigHelper(e){this.configHelper=e}clearHashkeys(){this._hashKeys=void 0}_importData(e,t){e&&(void 0===this.data[t]&&(this.data[t]={}),this._hashKeys=void 0)}_removeData(e){delete this.data[e],this._clean()}get hashKeys(){return void 0===this._hashKeys&&(this._hashKeys=Xr(void 0,this._highlighted,[])),this._hashKeys}importUserData(e){this._importData(e,0)}importTileData(e){this._importData(e,1)}removeTileData(){this._removeData(1)}removeUserData(){this._removeData(0)}mergeUserData(e){this._mergeData(e,0)}mergeTileData(e){this._mergeData(e,1)}_mergeData(e,t){e&&Object.assign(this.data[t],e),this._hashKeys=void 0}_toData(e){if(this.data[e])return{id:this.id,type:this.type}}toUserData(){return this._toData(0)}toTileData(){return this._toData(1)}toData(){return Object.assign(Object.assign({},this.toTileData()),this.toUserData())}hasUserData(){return this._hasData(0)}hasTileData(){return this._hasData(1)}_hasData(e){const t=this.data[e];return void 0!==t&&Object.keys(t).length>0}get defined(){return!!this.data.find((e=>e))}get userData(){return this.data[0]}set userData(e){this.data[0]=e}get tileData(){return this.data[1]}set tileData(e){this.data[1]=e}get latLng(){return this._getLatLngFromData(this._getFirstDefined.bind(this))}get userLatLng(){return this._getLatLngFromData(this._getUserProp.bind(this))}_getLatLngFromData(e){return e("latLng")}get highlighted(){return!0===this._highlighted}set highlighted(e){this._highlighted=e,this._hashKeys=void 0}_getFirstDefined(e){return(this.data.find((t=>(t||{})[e]))||{})[e]}_getUserProp(e){return(this.data[0]||{})[e]}set intersectingFeatureIds(e){void 0!==e&&(this.intersectingKeys=e)}get intersectingFeatureIds(){return this.intersectingKeys}}class gn extends pn{constructor(e,t,i){super(e,t,i)}get hashKeys(){return void 0===this._hashKeys&&this.refreshHashkeys(),this._hashKeys}addQualifier(){let e=!1;const t=this._getFirstDefined(en);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return r.forEach((i=>{t.includes(i)||(t.push(i),e=!0)})),e&&(this._hashKeys=void 0),e}refreshHashkeys(){const e=this.qualifiers&&this.configHelper?this.configHelper.filterQualifiersUsed(this.type,this.qualifiers):this.qualifiers,t=Xr(this.status,this._highlighted||!1,e);this._hashKeys=this.configHelper?this.configHelper.filterHashkeysUsed(this.type,t):t}removeQualifier(){let e=!1;const t=this._getFirstDefined(en);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return r.forEach((i=>{const r=t.indexOf(i);-1!==r&&(t.splice(r,1),e=!0)})),e&&(this._hashKeys=void 0),e}_assign(e,t,i){void 0!==i?e[t]=i:void 0!==e[t]&&delete e[t]}_importData(e,t){e&&(void 0===this.data[t]&&(this.data[t]={}),this._assign(this.data[t],"status",e.status),this._assign(this.data[t],"name",e.name),this._assign(this.data[t],en,e.qualifiers||[]),this._assign(this.data[t],"textLabel",e.textLabel),this._assign(this.data[t],"price",e.price),this._assign(this.data[t],"polygon",e.polygon),this._assign(this.data[t],"text",e.text),this._assign(this.data[t],"latLng",void 0!==e.lat&&void 0!==e.lng?Qr([e.lat,e.lng]):void 0),this._assign(this.data[t],"score",e.score),this._assign(this.data[t],"thumbnail",e.thumbnail),this._assign(this.data[t],"description",e.description),this._assign(this.data[t],"tile",e.tile),this._assign(this.data[t],"ariaLabels",e.ariaLabels),this._hashKeys=void 0)}_toData(e){const t=this.data[e];if(t)return{id:this.id,type:this.type,status:t.status||un,qualifiers:t.qualifiers||[],name:t.name,price:t.price,polygon:t.polygon,text:t.text,lat:t.latLng?t.latLng[0]:void 0,lng:t.latLng?t.latLng[1]:void 0,score:t.score,thumbnail:t.thumbnail,description:t.description,ariaLabels:t.ariaLabels}}hasLatLngChanged(e,t,i){if(void 0===e&&void 0!==t&&void 0!==i)return!0;if(void 0===e||void 0!==t&&void 0!==i){const[r,n]=Qr([t,i]);return Math.abs(e[0]-r)>1e-5||Math.abs(e[1]-n)>1e-5}return!0}isUserDataChanged(e){return!!e&&(!this._same(this.userStatus||un,e.status||un)||!this._same(this.userPrice,e.price)||!this._same(this.userPolygon,e.polygon)||!this._same(this.userText,e.text)||!this._same(this.userName,e.name)||!this._same(this.userDescription,e.description)||!Yr(this.userQualifiers,e.qualifiers,!1)||this.hasLatLngChanged(this.userLatLng,e.lat,e.lng))}_same(e,t){return e===t||Jr(e)&&Jr(t)}get status(){return this._getStatusFromData(this._getFirstDefined.bind(this))}get userStatus(){return this._getStatusFromData(this._getUserProp.bind(this))}_getStatusFromData(e){return e("status")||un}get qualifiers(){return this._getQualifiersFromData(this._getFirstDefined.bind(this))}get userQualifiers(){return this._getQualifiersFromData(this._getUserProp.bind(this))}_getQualifiersFromData(e){return e("qualifiers")}get name(){return this._getFirstDefined("name")}get userName(){return this._getNameFromData(this._getUserProp.bind(this))}_getNameFromData(e){return e("name")}get description(){return this._getFirstDefined("description")}get userDescription(){return this._getDescriptionFromData(this._getUserProp.bind(this))}_getDescriptionFromData(e){return e("description")}get price(){return this._getPriceFromData(this._getFirstDefined.bind(this))}get ariaLabels(){return this._getFirstDefined("ariaLabels")||tn}get userPrice(){return this._getPriceFromData(this._getUserProp.bind(this))}_getPriceFromData(e){return e("price")}get polygon(){return this._getPolygonFromData(this._getFirstDefined.bind(this))}get userPolygon(){return this._getPolygonFromData(this._getUserProp.bind(this))}_getPolygonFromData(e){return e("polygon")}get text(){return this._getFirstDefined("text")}get userText(){return this._getTextFromData(this._getUserProp.bind(this))}_getTextFromData(e){return e("text")}get score(){return this._getFirstDefined("score")}}class fn extends pn{constructor(e){super(e,on),this._computedLatLng=[]}_clean(){super._clean(),this.visible=!0}_importData(e,t){e&&(this.data[t]={children:e.children,radius:e.radius,minPrice:e.minPrice,text:e.text,originalLatLng:Qr([e.lat,e.lng]),featureType:e.featureType,qualifier:e.qualifier},this._hashKeys=void 0)}_toData(e){const t=this.data[e];if(t)return{id:this.id,type:this.type,radius:t.radius,children:t.children,minPrice:t.minPrice,lat:t.originalLatLng[0],lng:t.originalLatLng[1],text:t.text,featureType:t.featureType,qualifier:t.qualifier}}toData(){const e=super.toData();return e.children=e.children.map((e=>e.toData())),e}set computedLatLng(e){e&&e.length>0?this._computedLatLng=Qr([e[0],e[1]]):this._computedLatLng=[]}get latLng(){return this._getFirstDefined("originalLatLng")}get computedLatLng(){return this._computedLatLng}get children(){return this._getFirstDefined("children")}get radius(){return this._getFirstDefined("radius")}get minPrice(){return this._getFirstDefined("minPrice")}get text(){return this._getFirstDefined("text")}get featureType(){return this._getFirstDefined("featureType")}get qualifier(){return this._getFirstDefined("qualifier")}}class mn{constructor(e,t,i){this.type=e,this.logger=i,this.newInstance=t,this.index=new Map,this._data=[]}get data(){return this._data.filter((e=>e&&e.defined))}contains(e){return!!this.find(e)}find(e){if("string"==typeof e||"number"==typeof e){var t;const r=null!==(t=this.index.get(e))&&void 0!==t?t:-1;var i;return r>-1&&this._data[r]&&null!==(i=this._data[r])&&void 0!==i&&i.defined?this._data[r]:void 0}var r;null===(r=this.logger)||void 0===r||r.warn("The feature id passed is not defined")}save(e){if(e.type===this.type){var t;const i=null!==(t=this.index.get(e.id))&&void 0!==t?t:-1;i>-1?this._data[i]=e:(this.index.set(e.id,this._data.length),this._data.push(e))}}delete(e){if(e.type===this.type){var t;const i=null!==(t=this.index.get(e.id))&&void 0!==t?t:-1;i>-1&&(this._data[i]=void 0)}}clearAll(){this._data=[],this.index=new Map}}class yn{constructor(e){this.logger=e,this._repositories={product:new mn(rn,((e,t)=>new gn(e.id,rn,t)),e),property:new mn(nn,((e,t)=>new gn(e.id,nn,t)),e),place:new mn(sn,((e,t)=>new gn(e.id,sn,t)),e),cluster:new mn(on,((e,t)=>new fn(e.id)),e)}}allProducts(){return this.all((e=>e===rn))}allProductsWithCoordinates(){return this.allProducts().filter((e=>void 0!==e.latLng))}allProperties(){return this.all((e=>e===nn))}allPropertiesWithCoordinates(){return this.allProperties().filter((e=>void 0!==e.latLng))}allPlaces(){return this.all((e=>e===sn))}allPlacesWithCoordinates(){return this.allPlaces().filter((e=>void 0!==e.latLng))}allWithCoordinates(e){return this.all().filter((t=>void 0!==t.latLng&&(!e||t.type===e)))}allExceptClusters(){return this.all((e=>e!==on))}allClusters(){return this.all((e=>e===on))}find(e,t){if(t)return this.repository(t).find(e);var i;null===(i=this.logger)||void 0===i||i.warn("The feature type passed is not defined")}delete(e,t){this.repository(t).delete({id:e,type:t})}repository(e){return this._repositories[e]}all(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>!0,t=[];return Object.keys(this._repositories).filter((t=>e(t))).forEach((e=>{t=t.concat(this._repositories[e].data)})),t}upsertUserData(e,t){return this._upsert(e,"importUserData",t)}upsertTileData(e,t){return this._upsert(e,"importTileData",t)}insertTileData(e,t){if(!this.repository(e.type).find(e.id))return this._upsert(e,"importTileData",t)}insertTileDataWithLowestZoom(e,t){let i=this.repository(e.type).find(e.id);if(!i)return this._upsert(e,"importTileData",t);{const r=i.tileData&&i.tileData.tile,n=e.tile&&e.tile[2],s=r&&r[2];if(void 0!==n&&(void 0===s||n<s))return this._upsert(e,"importTileData",t)}}_upsert(e,t,i){let r=this.repository(e.type).find(e.id);return r||(r=this.repository(e.type).newInstance(e,i)),r[t](e),this.repository(r.type).save(r),r}deleteTileData(e){return this._delete(e,"removeTileData")}_delete(e,t){let i=this.repository(e.type).find(e.id);return i&&(i[t](e),i.defined||this.repository(e.type).delete(e)),i}}const{firstDefinedValue:vn}=t,bn="marker-hidden",kn="marker-collision";class Mn{constructor(){}init(e){let{asKey:t,getMarkerElement:i,getRectOfMarker:r,moveMarkerPosition:n,makeMarkerVisible:s,settings:o}=e;this.asKey=t,this.getMarkerElement=i,this.getRectOfMarker=r,this.moveMarkerPosition=n,this.makeMarkerVisible=s,this.settings=o;const a=o.collision;this.textLabelVisibility=a.labelVisibility,this.textLabelDynamicPlacement=a.dynamicPlacement,this.collisionBufferVariation=a.collisionBufferVariation,this.collisionBuffers=a.collisionBuffers,this.tagCollidingMarkersConfig=a.tagCollidingMarkers,this.clusterMarkerCollisionBuffer=a.clusterMarkerCollisionBufferInPixels,this.shouldMoveCollidingClusterMarkers=a.shouldMoveCollidingClusterMarkers}_isMarkerCollidingOtherMarkerOrLabel(e,t){const{markerBBox:i}=e;for(const r of t){const{textLabelBBox:e,markerBBox:t,labelVisibility:n}=r;if(i&&(t&&Qe(i,t)||n&&e&&Qe(i,e)))return!0}return!1}_isVisibleExistingLabelCollidingWithAnotherMarkerLabel(e,t){const{textLabelBBox:i}=e,{textLabelBBox:r,labelVisibility:n}=t;return n&&r&&Qe(i,r)}_isVisibleExistingLabelCollidingWithAnotherMarker(e,t){const{textLabelBBox:i}=e,{markerBBox:r}=t;return r&&Qe(i,r)}_isLabelCollidingOtherMarkerOrLabel(e,t){const{textLabelBBox:i,labelVisibility:r}=e;return!(!i||!r)&&t.some((t=>this._isVisibleExistingLabelCollidingWithAnotherMarker(e,t)||this._isVisibleExistingLabelCollidingWithAnotherMarkerLabel(e,t)))}_sortCandidateBBoxes(e){return e.sort(((e,t)=>e.popularity===t.popularity?e.feature.id<t.feature.id?-1:1:e.popularity>t.popularity?-1:1))}_splitFeaturesBoundingBoxes(e){let t=[],i=[];return e.forEach((e=>{"always"===e.labelVisibility||!1===e.isDynamicLabel?t.push(e):i.push(e)})),{safeFeaturesBBoxes:t,candidateBBoxes:i}}_nextEligibleLabelPosition(e){var t;return null===(t=e.find((e=>{let{isAvailable:t}=e;return t})))||void 0===t?void 0:t.position}_updateMarkerLabelPosition(e,t){const{safeFeaturesBBoxes:i,candidateBBoxes:r}=this._splitFeaturesBoundingBoxes(e);for(this._sortCandidateBBoxes(r);r.length>0;){let[e]=r;const{feature:n,labelVisibility:s,availableLabelPositions:o,currentLabelPosition:a}=e,{marker:l}=n;if(this._isMarkerCollidingOtherMarkerOrLabel(e,i))rt(this.getMarkerElement(n),bn),r.shift();else if(s&&this._isLabelCollidingOtherMarkerOrLabel(e,i)){o.find((e=>{let{position:t}=e;return t===a})).isAvailable=!1;const s=this._nextEligibleLabelPosition(o);s&&n.name?(l.labels.updateTextLabelPosition(s,t),e.textLabelBBox=Tn(n,this.getMarkerElement(n),this.settings,s,this.getRectOfMarker),e.currentLabelPosition=s):(l.labels.hideTextLabel(!0),e.labelVisibility=!1,i.push(e),r.shift())}else l.labels.hideTextLabel(!1),i.push(e),r.shift()}}getPopularity(e){var t;const i=null!==(t=null==e?void 0:e.score)&&void 0!==t?t:0;return"number"!=typeof i?0:i}_calculateFeaturesBoundingBoxes(e,t,i){const r=e.map((e=>{var r;const n=this.asKey(e),s=t[n],o=null===(r=e.marker)||void 0===r||null===(r=r.labels)||void 0===r?void 0:r.configuredLabelPosition;return{labelVisibility:s,availableLabelPositions:xn.map((e=>({position:e,isAvailable:!0}))),currentLabelPosition:o,isDynamicLabel:i[n],markerBBox:this.getRectOfMarker(e),textLabelBBox:s&&e.name?Tn(e,this.getMarkerElement(e),this.settings,o,this.getRectOfMarker):void 0,popularity:this.getPopularity(e),feature:e}}));return r}_resetMarkersAndLabels(e,t){return e.forEach((e=>{st(this.getMarkerElement(e),bn),In(e.marker,t,this.settings,e)})),Sn(e,t,this.settings,this.asKey)}_getLabelDynamicPlacementConfigByFeatureKey(e){const t={};return e.forEach((e=>{const i=vn(this.textLabelDynamicPlacement[e.type],e.hashKeys),r=this.asKey(e);t[r]=i})),t}handleMarkerLabelCollision(e,t){const i=e.filter((e=>this.getMarkerElement(e))),r=this._getLabelDynamicPlacementConfigByFeatureKey(i);if(!Object.values(r).includes(!0))return;const n=this._resetMarkersAndLabels(i,t),s=this._calculateFeaturesBoundingBoxes(i,n,r);this._updateMarkerLabelPosition(s,t)}_compareCluster(e,t){const i=e.children,r=t.children;return i.length>r.length?-1:i.length<r.length?1:i[0].id<r[0].id?-1:1}_sortClusterWithMarkerRects(e){e.sort(((e,t)=>{const i=Ge(e.marker,"cluster-marker-moved"),r=Ge(t.marker,"cluster-marker-moved");if(Ge(e.marker,"cluster-marker-moved"))return i?r?this._compareCluster(e.cluster,t.cluster):-1:r?1:this._compareCluster(e.cluster,t.cluster)}))}_filterClusterWithMarkerRects(e){return e.flatMap((e=>{const{feature:t,key:i,markerRect:r,markerRectWithBuffer:n,markerCollisionBuffer:s}=e;if("cluster"!==e.feature.type)return[];{const o=this.getMarkerElement(e.feature);if(o)return{cluster:t,key:i,markerRect:r,markerRectWithBuffer:n,marker:o,markerCollisionBuffer:s}}}))}moveCollidingClusterMarkers(e){const t=this._filterClusterWithMarkerRects(e);this._sortClusterWithMarkerRects(t),t.forEach((t=>{const{cluster:i,key:r,markerCollisionBuffer:n,marker:s,markerRect:o}=t,{radius:a}=i;if(st(s,"cluster-marker-moved"),st(s,"cluster-marker-failed-to-move"),i.intersectingKeys.length>0){const l=e.filter((e=>i.intersectingKeys.includes(e.key))),u=dt(this.getMaxRectOfMarkers(l),o,this.clusterMarkerCollisionBuffer),h=gt(o,u),d=ct(h.center,h.width+2*n,h.height+2*n),c=e.filter((e=>e.key!==r&&this.getMarkerElement(e.feature)));this.withinClusterRadius(o.center,h,a)&&this.noNewClusterCollision(d,c)?(this.moveMarkerPosition(i,u),rt(s,"cluster-marker-moved"),this.updateIntersectingFeatureKeysAfterMovingClusterMarkerPosition(i,h,c),t.markerRect=h,t.markerRectWithBuffer=d):rt(s,"cluster-marker-failed-to-move")}}),this)}updateIntersectingFeatureKeysAfterMovingClusterMarkerPosition(e,t,i){const r=this.asKey(e);e.intersectingKeys=[],i.forEach((e=>{const i=e.feature.intersectingKeys.indexOf(r);Qe(e.markerRectWithBuffer,t)?i<0&&e.feature.intersectingKeys.push(r):i>-1&&e.feature.intersectingKeys.splice(i,1)}))}withinClusterRadius(e,t,i){return Ye(t,this.getClusterCircle(e,i))}noNewClusterCollision(e,t){return!t.some((t=>Qe(e,t.markerRect)))}getClusterCircle(e,t){return{radius:t,center:{x:e.x,y:e.y}}}getMaxRectOfMarkers(e){return pt(e.map((e=>e.markerRect)))}hideCollidingMarkers(e,t){const i=e.filter((e=>this.getMarkerElement(e)&&"cluster"!==e.type));let r=[],n=[];i.forEach((e=>{"none"===t[this.asKey(e)]?r.push(e):n.push(e)}));let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{score:"DESC"},{id:"ASC"}];return e.sort(((e,i)=>{for(const r of t)for(const t of Object.keys(r)){let n=e[t],s=i[t],o=0;if(void 0===n&&void 0!==s?o=-1:void 0!==n&&void 0===s?o=1:void 0!==n&&void 0!==s&&(n<s&&(o=-1),n>s&&(o=1)),"DESC"===r[t]&&(o*=-1),0!==o)return o}return 0}))}(n,[{type:"ASC"},{score:"DESC"},{id:"ASC"}]);for(;s.length>0;){let e=s.shift(),t=!1;for(const n of r)if(e&&n&&e.type===n.type&&e.intersectingKeys.includes(this.asKey(n))){this.makeMarkerVisible(e,!1),this.updateIntersectingFeatureKeysAfterHidingMarker(i,this.asKey(e)),t=!0;break}t||r.push(e)}}updateIntersectingFeatureKeysAfterHidingMarker(e,t){e.forEach((e=>{const i=e.intersectingKeys.indexOf(t);i>-1&&e.intersectingKeys.splice(i,1)}))}tagCollidingMarkers(e,t){const i=e.flatMap((e=>{const t=this.getMarkerElement(e);return t?[{f:e,marker:t,key:this.asKey(e)}]:[]}));i.forEach((e=>{let{marker:t}=e;return st(t,kn)})),i.filter((e=>{let{f:i,key:r}=e;return i.intersectingKeys.length>0&&t[r]})).forEach((e=>{let{f:t,marker:r,key:n}=e;for(const{key:s}of i)if(n!==s&&t.intersectingKeys.includes(s)){rt(r,kn);break}}))}updateMarkerPosition(e){const t=e.filter((e=>this.getMarkerElement(e))),i=this.getCollisionBufferVariationByFeatureKey(t),r=this.getFeaturesWithMarkerRects(t,i);this.updateIntersectingFeatureKeys(r),this.shouldMoveCollidingClusterMarkers&&this.moveCollidingClusterMarkers(r),Object.values(i).some((e=>"none"!==e))&&this.hideCollidingMarkers(t,i);const n=this.getTagCollidingMarkersConfigByFeatureKey(t);Object.values(n).includes(!0)&&this.tagCollidingMarkers(t,n)}getTagCollidingMarkersConfigByFeatureKey(e){const t={};return e.forEach((e=>{const i=vn(this.tagCollidingMarkersConfig[e.type],e.hashKeys),r=this.asKey(e);t[r]=i})),t}getCollisionBufferVariationByFeatureKey(e){const t={};return e.forEach((e=>{const i=vn(this.collisionBufferVariation[e.type],e.hashKeys),r=this.asKey(e);t[r]=i})),t}updateIntersectingFeatureKeys(e){e.forEach((t=>{var i;(null===(i=t.feature.intersectingKeys)||void 0===i?void 0:i.length)>0&&(t.feature.intersectingKeys=[]),"cluster"===t.feature.type&&(t.feature.computedLatLng=[]),e.forEach((e=>{t.key!==e.key&&Qe(t.markerRectWithBuffer,e.markerRect)&&t.feature.intersectingKeys.push(e.key)}))}))}getFeaturesWithMarkerRects(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.filter((e=>this.getMarkerElement(e))).map((e=>{const i=t[this.asKey(e)],r=this.collisionBuffers[i]||0,n=this.getRectOfMarker(e,r),s=this.getRectOfMarker(e);return{feature:e,key:this.asKey(e),markerRectWithBuffer:n,markerRect:s,markerCollisionBuffer:r}}))}}class Pn{init(e,t){return Promise.reject(new Error("method init not implemented"))}createPinMarker(e,t,i){throw new Error("method createPinMarker not implemented")}createTextMarker(e,t,i){throw new Error("method createTextMarker not implemented")}createClusterMarker(e){throw new Error("method createClusterMarker not implemented")}createObfuscatedMarker(e){throw new Error("method createObfuscatedMarker not implemented")}createPriceObfuscatedMarker(e,t){throw new Error("method createPriceObfuscatedMarker not implemented")}createPinObfuscatedMarker(e,t,i){throw new Error("method createPinObfuscatedMarker not implemented")}hasObfuscatedAreaStyleChanged(e){throw new Error("method _hasObfuscatedAreaStyleChanged not implemented")}deleteMarker(e){throw new Error("method deleteMarker not implemented")}updatePopupPositionOnLayer(){throw new Error("method updatePopupPositionOnLayer not implemented")}ensurePopupVisibility(){throw new Error("method ensurePopupVisibility not implemented")}getMarkerElement(e){throw new Error("method getMarkerElement not implemented")}moveMarkerPosition(e,t){throw new Error("method moveMarkerPosition not implemented")}getRectOfMarker(e){throw new Error("method getRectOfMarker not implemented")}fitBounds(e,t,i,r){return Promise.reject("method fitBounds not implemented")}nativeBounds(){throw new Error("method nativeBounds not implemented")}asNativeBounds(e,t){throw new Error("method asNativeBounds not implemented")}computeNativeBoundsFromLatLongs(e){throw new Error("method computeNativeBoundsFromLatLongs not implemented")}asBounds(e){throw new Error("method asBounds not implemented")}containerBounds(e){throw new Error("method containerBounds not implemented")}fitLatLongs(e){return Promise.reject("method fitLatLongs not implemented")}getZoom(){throw new Error("method getZoom not implemented")}getCenter(){throw new Error("method getCenter not implemented")}isFeatureInRealBound(e,t){throw new Error("method isFeatureInRealBound not implemented")}centerAndZoomMap(e,t,i){throw new Error("method centerAndZoomMap not implemented")}addEventListener(e,t,i){throw new Error("method addEventListener not implemented")}addRouteOnMap(e,t){return Promise.reject(new Error("method addRouteOnMap not implemented"))}removeRouteOnMap(e){return Promise.reject(new Error("method removeRouteOnMap not implemented"))}addPolygonsOnMap(e){return Promise.reject(new Error("method addPolygonsOnMap not implemented"))}removePolygonsOnMap(e){return Promise.reject(new Error("method removePolygonsOnMap not implemented"))}registerListenerOnMapFocusElement(e,t){throw new Error("method registerListenerOnMapFocusElement not implemented")}unbindAll(){throw new Error("method unbindAll not implemented")}getTileDim(){throw new Error("method getTileDim not implemented")}resetRouteStyle(){throw new Error("method resetRouteStyle not implemented")}updateMapProviderConfig(){throw new Error("method updateMapProviderConfig not implemented")}forceMapModeView(){throw new Error("method forceMapModeView not implemented")}}const{firstDefinedValue:Ln,getMultiLineLabelText:Cn}=t,_n="text-label-hidden",wn="text-sub-label-hidden",xn=["right","left","above","below"];function Fn(e,t,i,r){e.labels.aligner&&pe(e.labels.aligner),e.labels.textLabelPosition=i,e.labels.aligner=me(void 0,e.labels.textLblCont,`marker-labels-aligner ${i}`),e.labels.container?ge(e.labels.container,e.labels.aligner):e.labels.container=me(void 0,e.labels.aligner,"marker-labels-container");const n=Ln(r.textLabelZIndex[t.type],t.hashKeys);"sameAsMarker"!=n&&Ue(e.labels.aligner,n)}function On(e,t,i,r){const n=Ln(t[r.type],r.hashKeys),s=Ln(i[r.type],r.hashKeys);return e<n||e>s}function En(e,t,i,r,n){const s=Ln(n.textLabelPosition[t.type],t.hashKeys);e.labels.configuredLabelPosition=s,i&&(Fn(e,t,s,n),An(e,t,i,r,n)),e.labels.updateTextLabel=(i,r,o)=>{i&&!e.labels.aligner&&Fn(e,t,s,n),An(e,t,i,r,n),In(e,o,n,t)},e.labels.updateTextLabelPosition=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,r=arguments.length>1?arguments[1]:void 0;i!==e.labels.textLabelPosition&&(function(e,t){st(e.labels.aligner,e.labels.textLabelPosition),rt(e.labels.aligner,t),e.labels.textLabelPosition=t}(e,i),In(e,r,n,t))},e.labels.hideTextLabel=t=>{const{aligner:i}=e.labels;i&&(t?rt(i,_n):st(i,_n))},e.labels.hideTextSubLabel=t=>{const{subLabel:i}=e.labels;i&&(t?rt(i,wn):st(i,wn))},e.labels.resetPositionAndHidingState=t=>{e.labels.hideTextLabel(!1),e.labels.hideTextSubLabel(!1),e.labels.updateTextLabelPosition(s,t)}}function In(e,t,i,r){On(t,i.textLabelMinZoom,i.textLabelMaxZoom,r)&&e.labels.hideTextLabel(!0),On(t,i.textSubLabelMinZoom,i.textSubLabelMaxZoom,r)&&e.labels.hideTextSubLabel(!0)}function Sn(e,t,i,r){const n={};return e.forEach((e=>{const s=Ln(i.textLabelVisibility[e.type],e.hashKeys),o=On(t,i.textLabelMinZoom,i.textLabelMaxZoom,e),a=r(e);n[a]="always"===s?"always":s&&!o})),n}function Dn(e,t,i,r,n,s,o){const a=Ln(i[e.type],e.hashKeys),l=Ln(r[e.type],e.hashKeys);let u=Cn(n,a,l);return o?(X(o,u),o):Me(void 0,t,`marker-${s}-text`,void 0,u)}function An(e,t,i,r,n){const{container:s,label:o,subLabel:a}=e.labels;if(i){const{textLabelMaxLineLength:l,textLabelMaxLines:u}=n;if(e.labels.label=Dn(t,s,l,u,i,"label",o),r){const{textSubLabelMaxLineLength:i,textSubLabelMaxLines:o}=n;e.labels.subLabel=Dn(t,s,i,o,r,"sublabel",a)}else pe(a),e.labels.subLabel=void 0}else e.labels&&(pe(e.labels.aligner),e.labels.aligner=void 0,e.labels.container=void 0,e.labels.label=void 0,e.labels.subLabel=void 0,e.labels.textLabelPosition=void 0)}function Tn(e,t,i,r,n){const s=se(t,["marker-labels-container"],!0);let{width:o,height:a,center:l}=n(e);const u=r||Ln(i.textLabelPosition[e.type],e.hashKeys),{scrollWidth:h,scrollHeight:d}=s;switch(l.x-=o/2,l.y-=a/2,u){case"right":l.y+=a/2,l.x+=o+h/2;break;case"left":l.y+=a/2,l.x-=h/2;break;case"above":l.y-=d/2,l.x+=o/2;break;default:l.y+=a+d/2,l.x+=o/2}return ct(l,h,d)}function Bn(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Rn(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Bn(Object(i),!0).forEach((function(t){Nn(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Bn(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Nn(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const{firstDefinedValue:Kn}=t,Vn="marker-icon",jn={defaultClick:"click",doubleClick:"dblclick",mapClick:"click",mouseEnter:"mouseenter",mouseLeave:"mouseleave",focus:"focus",focusOut:"focusout",keyDown:"keydown",keyUp:"keyup",keyPress:"keydown"};function zn(e,t){let i,r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none",s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;if(H(e)){i=e.cloneNode(!0),s&&(r=W(i));const t=["component-icon"];o&&t.push(o),nt(i,t)}else i=_e(void 0,void 0,o,void 0,e);if("none"!==n){const e=me(void 0,t,"frame");return e.appendChild(i),r&&(e.hashCode=r),Ee(e),{iconImg:i,main:e}}return ge(i,t),r&&(i.hashCode=r),{iconImg:i,main:t}}function $n(e,t,i,r){const n=me(void 0,e,`${t}-label`),s=Me(void 0,n,r||`${t}-content`,void 0,i);return Ee(s),{text:n,span:s}}function Un(e,t){const{hashKeys:i}=e,{textLabelVisibility:r,textSubLabelVisibility:n}=t,s={};if(Kn(r[e.type],i)){const t=e.name;t&&(s.label=t)}if(Kn(n[e.type],i)){const t=e.description;t&&(s.subLabel=t)}return s}function Zn(e,t){var i;const{markerTypes:r,frameIcons:n,icons:s,zIndexes:o,cornerIcons:a,innerIcons:l,iso4217CurrencyCode:u,locale:h}=t,{hashKeys:d,type:c}=e,p=e,{price:g,text:f}=p,m="cluster"===c,y=m?"clusterMarker":Kn(r[c],d),v=Rn({markerType:y,zIndex:0,cssClasses:{toAdd:[...m?[]:[e.type,p.status],p.highlighted?"hl":"not-hl"],toRemove:[p.highlighted?"not-hl":"hl"]},frameIcon:Kn(n[c],d),icons:{}},Un(p,t));switch(y){case"price":case"priceObfuscate":g?v.text=gi(g,void 0,u,h):v.markerType="price"===y?"pin":"pinObfuscate";break;case"text":f?v.text=f:v.markerType="pin"}switch(null!=e&&null!==(i=e.marker)&&void 0!==i&&i.cssClasses&&v.cssClasses.toRemove.push(...e.marker.cssClasses.filter((e=>"dom-marker"!==e))),v.markerType){case"pin":v.cssClasses.toAdd.push("pin-marker"),v.icons.pin=Kn(s[e.type],d);break;case"price":v.cssClasses.toAdd.push("price-marker");break;case"text":v.cssClasses.toAdd.push("text-marker");break;case"obfuscate":v.cssClasses.toAdd.push("obfuscate-marker");break;case"pinObfuscate":v.cssClasses.toAdd.push("pin-obfuscate-marker"),v.icons.pin=Kn(s[e.type],d);break;case"priceObfuscate":v.cssClasses.toAdd.push("price-obfuscate-marker");break;case"clusterMarker":{const{featureType:t,qualifier:i}=e;v.cssClasses.toAdd.push(...us(t,i))}break;default:throw new Error(`Unknown marker type: ${v.markerType}`)}"none"!==v.frameIcon&&v.cssClasses.toAdd.push(`frame-${v.frameIcon}`);const b=p.qualifiers||[];b.length>0&&v.cssClasses.toAdd.push(...b),v.zIndex=Kn(o[p.type],d);const k=is(p,a);a&&(v.icons.cornerIcons=k);const M=rs(p,l);return l&&(v.icons.innerIcons=M),v}function Hn(e,t,i,r){var n;const s=null===(n=e.icons)||void 0===n?void 0:n.pin;return new Promise((e=>{s?($e(s,t),tr(s,i,r).then((()=>e(!0)))):e(!1)}))}function qn(e,t){if(e){const i=e;i.advancedMarker?i.zIndex=t:e.zIndexElement&&(St(e.zIndexElement)?e.zIndexElement.forEach((e=>Ue(e,t))):Ue(e.zIndexElement,t))}}function Wn(e){null!=e&&e.bounceElement&&Oi(e.bounceElement)}function Gn(e,t){return"none"!==e[t]}function Qn(e,t){t&&Object.keys(t).forEach((i=>{if(Gn(t,i)){const r=me(void 0,e,`corner-icon ${i}`);zn(t[i],r)}}))}function Xn(e,t){if(t){const i=e.parentElement||void 0;Object.keys(t).forEach((r=>{if(Gn(t,r)){let n;switch(r){case"left":{const t=le(e);t>=0&&(n=me(void 0,void 0,`inner-icon ${r}`),bt(n,i,t))}break;case"right":n=me(void 0,i,`inner-icon ${r}`)}n&&zn(t[r],n)}}))}}function Yn(e,t){const i=Object.keys(e);return!(Ut(i,Object.keys(t),!1)&&i.every((i=>t[i]&&!ir(e[i],t[i],!0))))}function Jn(e,t){return Yn(e,t)}function es(e,t){return Yn(e,t)}function ts(e,t){let i;return Object.keys(t).forEach((r=>{const n=Kn(t[r][e.type],e.hashKeys);n&&"none"!==n&&(i||(i={}),i[r]=n)})),i}function is(e,t){return ts(e,t)}function rs(e,t){return ts(e,t)}function ns(e,t){return t(e,jn.doubleClick,(e=>{e.stopPropagation()}))}function ss(e,t,i){const{ariaElement:r}=t;i&&r&&(e&&i.onSelect?we(r,i.onSelect):i.default?we(r,i.default):Fe(r))}function os(e,t,i,r,n,s,o,a){let{feature:l,container:u,cornerIcons:h,innerIcons:d,cssClasses:c,label:p,subLabel:g}=t;const f={};f.cssClasses=c;const m=`${c.join(" ")}`,y=u||me(e,i,m,s);let v,b;f.content=y,u&&ut(u,m,s),a&&(v=me(void 0,y,"pin-marker"),b=me(void 0,v,"marker-icon-inter"),Ee(b));const{iconImg:k,main:M}=zn(r,b||y,n,!0,Vn);f.frameIcon=n,f.icons={cornerIcons:h,innerIcons:d,pin:H(r)?M:k},Qn(b||y,h),Xn(k,d),f.ariaElement=b||y,f.zIndexElement=v||y,f.bounceElement=M,f.cssElement=y,f.labels={textLblCont:b||y},En(f,l,p,g,o);const P="none"!==n?b||y:k;return f.listening!==P&&(fs(f),f.listening=P),a?(a(f,l),f.clone=()=>cs(l,f,o)):f.clone=()=>y.cloneNode(!0),f}function as(e,t,i,r,n,s){const{ariaElement:o}=t,{feature:a,zIndex:l,ariaLabels:u}=i;o&&(Be(o),s(a.highlighted,t,u)),ps(e,t),function(e,t,i,r){if(t.listening){const n=()=>e;St(t.listening)?t.clean=t.listening.flatMap((e=>gs(e,!0,n,i,r))):t.clean=gs(t.listening,!0,n,i,r)}}(a,e,r,n),qn(e,l)}function ls(e,t,i,r,n,s,o,a){let{feature:l,container:u,cornerIcons:h,innerIcons:d,cssClasses:c,label:p,subLabel:g}=t;const f={};f.cssClasses=c;const m=c.join(" "),y=u||me(e,i,m,s);let v;u&&ut(u,m,s),a&&(v=me(void 0,y,"price-marker")),f.zIndexElement=y;const{text:b,span:k}=a?$n(v,"price",r):$n(y,n,r);f.content=y,f.icons={cornerIcons:h,innerIcons:d},Qn(b,h),Xn(k,d),f.ariaElement=b,f.zIndexElement=v||y,f.bounceElement=b,f.cssElement=y,f.labels={textLblCont:v||y},f.text=r,En(f,l,p,g,o);const M=v||y;return f.listening!==M&&(fs(f),f.listening=M),a?(a(f,l),f.clone=()=>cs(l,f,o)):f.clone=()=>(v||y).cloneNode(!0),f}function us(e,t){return["cluster-marker",`cluster-${e}-marker`,...t.split("#")]}function hs(e,t,i,r,n,s){const o={},a=me(e,t,us(r,n).join(" "),`visibility:false;${s||""}`),{text:l}=$n(a,"cluster",i.text,"cluster-label-content");o.content=a,Be(l),we(l,i.text),o.zIndexElement=a,o.bounceElement=l,o.cssElement=a,o.text=i.text;const u=a;return o.listening!==u&&(fs(o),o.listening=u),o.clone=()=>a.cloneNode(!0),o}function ds(e,t,i,r,n,s){let{feature:o,container:a,cssClasses:l,label:u,subLabel:h}=t;const d={};d.cssClasses=l;const c=l.join(" "),p=a||me(e,i,c,r);d.content=p,a&&ut(a,c,r);const g=s(d,o);d.ariaElement=p,d.zIndexElement=p,d.cssElement=p,d.labels={textLblCont:p},En(d,o,u,h,n);const f=g||p;return d.listening!==f&&(fs(d),d.listening=f),d.clone=()=>cs(o,d,n),d}function cs(e,t,i){var r,n,s,o,a;const l=Kn(i.obfuscateStyle[e.type],e.hashKeys),u=Gt(null==l||null===(r=l.line)||void 0===r?void 0:r.opacity),h=Gt(null==l||null===(n=l.fill)||void 0===n?void 0:n.opacity),d=t.content.cloneNode(!0);rt(d,"markerClone");const c=`${null==l||null===(s=l.fill)||void 0===s?void 0:s.color}${h}`,p=`${null==l||null===(o=l.line)||void 0===o?void 0:o.weight}px`,g=`${null==l||null===(a=l.line)||void 0===a?void 0:a.color}${u}`;return d.dataset.cloneStyles=`--fillcolor:${c}; --linewidth:${p}; --linecolor:${g};`,d}function ps(e,t){Object.keys(t).filter((e=>"content"!==e)).forEach((i=>{e[i]=t[i]}))}function gs(e,t,i,r,n){let{addEventListener:s,stopPropagation:o,handleClick:a,handleMouseOver:l,handleMouseOut:u,handleKeyPress:h}=n;const d=t?r.actionsOnMarkerClick:r.actionsOnPopupClick,c=t?r.actionsOnMarkerMouseOver:r.actionsOnPopupMouseOver,p=t?r.actionsOnMarkerMouseOut:r.actionsOnPopupMouseOut,g=t?r.keyNamesForMarkerKeyPressEvent:r.keyNamesForPopupKeyPressEvent;return[s(e,jn.defaultClick,(e=>{o(e),a(i(),t,d,e.type)})),s(e,jn.keyPress,(e=>{h(i(),g,e.code)&&o(e)})),s(e,jn.mouseEnter,(e=>{o(e),l(i(),t,c,e.type)})),s(e,jn.mouseLeave,(e=>{o(e),u(i(),t,p,e.type)})),ns(e,s)]}function fs(e){var t;null===(t=e.clean)||void 0===t||t.forEach((e=>e())),e.clean=[]}function ms(e,t,i,r,n){let s=r;s||(s=Zn(e,i));const{markerType:o,icons:a,frameIcon:l,cssClasses:u,zIndex:h,text:d="?",label:c,subLabel:p}=s,{pin:g,cornerIcons:f,innerIcons:m}=a||{},{ariaLabels:y}=e;Array.isArray(n)&&(u.toAdd=[...u.toAdd,...n]);const v={feature:e,container:he(t),cssClasses:u.toAdd,zIndex:h,label:c,subLabel:p,ariaLabels:y},b="none"!==l||"pin"!==o&&"pinObfuscate"!==o&&"obfuscate"!==o;return{markerType:o,frameIcon:l,text:d,pin:g,minimal:v,common:Rn(Rn({},v),{},{cornerIcons:f,innerIcons:b?m:void 0})}}function ys(e,t,i,r,n,s,o,a,l){const u=Zn(e,t),{icons:h,zIndex:d,cssClasses:c}=u,{marker:p}=e,{ariaLabels:g}=e,f=null==h?void 0:h.pin;vs(e,u,o)?r(e,u):(h&&!H(f)&&Hn(p,f,s,i).then((t=>(t&&n(e),t))),tt(p.cssElement,c.toRemove,c.toAdd),p.cssClasses=it(p.cssElement),l(e.highlighted,p,g),qn(p,d),function(e,t,i){var r;const{marker:n}=e,{label:s,subLabel:o}=Un(e,t);null===(r=n.labels)||void 0===r||r.updateTextLabel(s,o,i)}(e,t,a()))}function vs(e,t,i){const{marker:r}=e;if(r){if("clusterMarker"===r.markerType)return!1;{const{icons:n={},markerType:s,text:o,frameIcon:a}=t,{pin:l,cornerIcons:u={},innerIcons:h={}}=n,{markerType:d,icons:{pin:c,cornerIcons:p,innerIcons:g}={},text:f,frameIcon:m}=r,y=null==c?void 0:c.hashCode,v=!(!a&&!m||a===m),b=()=>y?!H(l)||y!==W(l):H(l),k="price"===d||"text"===d||"priceObfuscate"===d,M="pin"===d||"pinObfuscate"===d,P="pinObfuscate"===d||"priceObfuscate"===d||"obfuscate"===d;return d!==s||Jn(p||{},u)||es(g||{},h)||k&&o!==f||M&&(v||b())||P&&i(e)}}return!0}const bs=["id","type"];function ks(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ms(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ks(Object(i),!0).forEach((function(t){Ps(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ks(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Ps(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const{firstDefinedValue:Ls,listHashKeysSorted:Cs}=t,_s="click";function ws(){return{highlightedFeatures:[],previouslySelectedFeatures:new Set(JSON.parse(sessionStorage.getItem("__map_previously_selected_features"))),selectedFeature:void 0,featuresOver:new Set,product:{withMarkers:[]},property:{withMarkers:[]},place:{withMarkers:[]},routes:[],routeDestinations:[],polygons:[]}}class xs extends Pn{constructor(e,t,i,r){super(),this.eventsManager=t,this.features=i,this.mapData=r,this.boundsComputation=new Gr,this.listenersToDeregister=[],this.copyrightsDiv=this.createCopyrightsDiv(),this.copyrights=new Map,this.popup=void 0,this.ignoreMapClickEvent=!1,this.configHelper=e,this.settings=this.configHelper.loadMapSettings(),this.logger=this.configHelper.logger("BaseMap"),this.logger.debug("BaseMap constructor"),this.featureTypes=this.settings.featureTypes,this.clusterFactory=new rr;const n=!1;this._newKeyboardFeatures(n),this._newRouteManager(),this._newClusterers(),this._newAvailabilityCheck(),this._newContentProviders(),this._newCollisionManagement(n),this.tilesLoader=void 0,this.customMarkerOverlay=void 0}_newKeyboardFeatures(e){this.keyboardFeatures&&this.keyboardFeatures.removeAllUIElements(),this.settings.isKeyboardFeaturesDefined?(this.keyboardFeatures=new Ir(this.settings.keyboardFeaturesIcon,this.settings.getI18N),e&&this._initializeKeyboardFeatures(this.keyboardFeatures)):this.keyboardFeatures=void 0}_initializeKeyboardFeatures(e){e.init({node:this.node,uniqId:this.uniqId.bind(this),containerBounds:this.containerBounds.bind(this),listFeatures:this._listFeatures.bind(this),zIndexes:this.settings.zIndexes,maxZIndex:this.settings.maxZIndex,getMapNavFocusElement:()=>this.mapNavFocusElement,registerListenerOnMapFocusElement:this.registerListenerOnMapFocusElement.bind(this),handleClick:this.handleClick.bind(this),actionsOnClick:this.settings.actionsOnMarkerClick,isFeatureSelected:this.isFeatureSelected.bind(this),clearSelectedFeature:this.clearSelectedFeature.bind(this)}),this.settings.isKeyboardFeaturesEnabled&&(this.turnKeyboardFeaturesMode(!0),e.updateKeyboardFeatures())}_updateMarkerPositionFromCollision(){var e;null===(e=this.collisionManagement)||void 0===e||e.updateMarkerPosition(this.features.all())}_newAvailabilityCheck(){this.availabilityCheck=new gr(this.settings.loggerFactory,this.settings.availabilityProvider)}_newContentProviders(){this.settings.isAnyContentProviderExists?this.contentProvider=new $r(this.settings.loggerFactory,this.featureTypes,this.settings.contentProvidersByFeatureType,this.settings.contentProvidersConfigs):this.contentProvider=void 0}_newRouteManager(){this.routes=new ur({logger:this.settings.loggerFactory("RoutesRepository"),egDistances:this.configHelper.egDistances(),routeLineStyleByDistanceMode:this.settings.routeLineStyleByDistanceMode,routeCacheInMs:this.settings.routeCacheInMs,findFeature:this._findFeature.bind(this),eventsManager:this.eventsManager,addRouteOnMap:this.addRouteOnMap.bind(this),removeRouteOnMap:this.removeRouteOnMap.bind(this),asKey:this.asKey},this.mapData.routes,this.mapData.routeDestinations)}_newPolygonManager(){this.polygonsManager=new cr({logger:this.settings.loggerFactory("PolygonRepository"),findFeature:this._findFeature.bind(this),addPolygonsOnMap:this.addPolygonsOnMap.bind(this),removePolygonsOnMap:this.removePolygonsOnMap.bind(this),asKey:this.asKey,polygons:this.mapData.polygons,polygonStyles:this.settings.polygonStyles})}_updateTilesConfig(){var e;this.features.allExceptClusters().forEach((e=>{e.hasUserData()?e.hasTileData()&&e.removeTileData():this.features.delete(e.id,e.type)}));const{sw:t,ne:i}=this.getBounds(),{width:r,height:n}=this.getTileDim(),s=this.getZoom(),o=Ni(t[0],t[1],i[0],i[1],s,r,n);null===(e=this.tilesLoader)||void 0===e||e.instantiateTilesProvider(this.settings),o.forEach((e=>{let{x:t,y:i}=e;return setTimeout((()=>{var e;return null===(e=this.tilesLoader)||void 0===e?void 0:e.loadTile(t,i,Math.floor(s))}),10)}))}_newCollisionManagement(e){this.collisionManagement=new Mn,e&&this._initializeCollisionManagement(this.collisionManagement)}_initializeCollisionManagement(e){e.init({asKey:this.asKey.bind(this),getMarkerElement:this.getMarkerElement.bind(this),getRectOfMarker:this.getRectOfMarker.bind(this),moveMarkerPosition:this.moveMarkerPosition.bind(this),makeMarkerVisible:this._makeMarkerVisible.bind(this),settings:this.settings})}_newClusterers(){this.clusterers=this.clusterFactory.createClusterers(this.settings.loggerFactory,this.settings.getI18N,this.settings.iso4217CurrencyCode,this.settings.locale,this.settings.clusterConfigurationByType,this.settings.clusterDefaultConfigurationByType)}updateConfiguration(e,t,i){this.configHelper=e,this.settings=t;const{clearHashkeys:r,updateMarkers:n,updateViewport:s,updateMapProviderConfig:o,updateKeyboardA11yUI:a,updateStyling:l,updateTiles:u,resetAvailabilityCheck:h,resetClusterers:d,resetCollisionManagement:c,resetContentProviders:p,resetRouteManagement:g,resetPolygonManagement:f}=i,m=!0;if(o&&this.updateMapProviderConfig(),u&&this._updateTilesConfig(),r&&this.clearHashkeys(),h&&this._newAvailabilityCheck(),d&&this._newClusterers(),g){var y;const e=null===(y=this.routes)||void 0===y?void 0:y.listRegisteredRoutes();this.resetRouteStyle(),this._newRouteManager(),this.syncRegisteredRoutes(e),this.updateRoutesOnViewport()}return f&&(this.resetRouteStyle(),this._newPolygonManager(),this.updateRoutesOnViewport()),p&&this._newContentProviders(),c&&this._newCollisionManagement(m),a&&this._newKeyboardFeatures(m),l&&this._addCssStyleFromConfig(this.settings.styling),xi.getDebugConfigEnabled()&&console.debug("Configurations updated",this.configHelper.getEGMapConfigurations()),n&&this.clearMarkers(),s?this._updateViewport():Promise.resolve()}updateRoutesOnViewport(){var e;null===(e=this.routes)||void 0===e||e.updateRoutesOnViewport()}syncRegisteredRoutes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e&&e.forEach((e=>{var t;return null===(t=this.routes)||void 0===t?void 0:t.registerRoute(e.origin,e.destination,e.polyline)}))}initMap(e,t,i,r){this.logger.debug("map is initializing");const n=Date.now();this.node=e,this.cssClassId=t,this.idPrefix=`${this.node.id}_`,this._addCssStyleFromConfig(this.settings.styling),this.collisionManagement&&this._initializeCollisionManagement(this.collisionManagement);const s=null==i?void 0:i.options,o=null==s?void 0:s.gaiaId;return xi.getDebugConfigEnabled()&&console.debug("Configurations used",this.configHelper.getEGMapConfigurations()),this._loadHistoricalBoundingBox(o).then((()=>this.init(i,r))).then((()=>this._lateInit())).then((()=>{this.logger.debug(`map initialized in ${Date.now()-n}ms`)}))}_lateInit(){const e=Xi([...new Set([...er(this.settings.icons),...Ji(this.settings.cornerIcons),...Ji(this.settings.innerIcons)])]);return this._newPolygonManager(),Yi(e,this.addEventListener.bind(this),this.logger).then((()=>{this.keyboardFeatures&&this._initializeKeyboardFeatures(this.keyboardFeatures)}))}createCopyrightsDiv(){const e=me(this.uniqId("copyrights-div"),this.node,"copyrights");return Ve(this.copyrightsDiv),e}uniqId(e){return this.idPrefix+e}_loadHistoricalBoundingBox(e){return e?Ci(this.settings.historicalBoundingBoxDataEndpoint,5e3).then((t=>t.ok?t.json().then((t=>{if(t.errors)return this.logger.error(`Failed to fetch historical bounding box data for gaia Id: ${e} - ${t.errors}`),Promise.resolve();const i=t.find((t=>t.gaia_id===e.toString()));return null!=i&&i.historical_polygon_wkt&&(this.historicalBoundingBox=ri(i.historical_polygon_wkt)),Promise.resolve()})):Promise.resolve())):Promise.resolve()}_computeNativeBounds(e,t,i){var r;const n=this.node&&0!==(null===(r=this.node)||void 0===r?void 0:r.clientWidth)?this.node.clientHeight/this.node.clientWidth:1,s=(null==i?void 0:i.centeredOn)?this.boundsComputation.computeCenteredBoundingBox(e,i,n):this.boundsComputation.computeBoundingBox(e,t,i,this.historicalBoundingBox,n);return this.computeNativeBoundsFromLatLongs(s)}_parseClientPadding(e){try{if(this.node)return ai(e,this.node)}catch(e){this.logger.error(e.message,e.stack)}}boundsContaining(e,t,i){const r=null==i?void 0:i.gaiaId,n=Nt(e);return r?this._loadHistoricalBoundingBox(r).then((()=>this.asBounds(this._computeNativeBounds(n,t,i)))):Promise.resolve(this.asBounds(this._computeNativeBounds(n,t,i)))}boundsContainingPolygon(e){const t=Nt(Gi(e).flat(2));return this.asBounds(this._computeNativeBounds(t,!1))}_computeStrictBounds(e){return this.asBounds(this.computeNativeBoundsFromLatLongs(Nt(e)))}handleBoundsChanged(e){if(this.logger.debug("bounds changed",e),this.boundChangedDisabled)this.boundChangedDisabled=!1;else{const t=this.getBounds();if(t)return this._updateViewport().then((()=>{const i={bounds:t,zoom:this.getZoom(),originalEvent:e};this.eventsManager.pushEvent(or.boundsChanged,i)}))}return Promise.resolve()}getCirclePolygonData(e){const t=Ls(this.settings.obfuscatePrecision[e.type],e.hashKeys),i=Ls(this.settings.obfuscateRadiusInMeters[e.type],e.hashKeys);return k([e.latLng[1],e.latLng[0]],i/1e3,{units:"kilometers",steps:t}).geometry.coordinates[0].map((e=>({lat:e[1],lng:e[0]})))}setStay(e){var t;if(!function(e){return void 0!==e.from&&void 0!==e.to&&e.roomOccupancies.length>0&&e.roomOccupancies.every((e=>function(e){return e.nbAdults>0}(e)))}(e))throw new Error("stay is not valid");null!==(t=this.availabilityCheck)&&void 0!==t&&t.saveStay(e)&&(this.cleanAvailabilityTileData(this.features.allProperties()),this._updateViewport())}_addCssStyleFromConfig(e){this.currentStyleId&&de(this.currentStyleId),e&&Object.keys(e).length>0&&this.cssClassId?(this.currentStyleId=this.uniqId("style"),Ct(this.currentStyleId,"EgMapsStyling",this.cssClassId,e)):this.currentStyleId=void 0}cleanAvailabilityTileData(e){e.forEach((e=>{e.hasTileData()&&(e.tileData.status="unknown",e.tileData.price=void 0)}))}refresh(){return this._updateViewport()}updateAvailability(e){var t;const i=this._newFixMarkerToUse();return null===(t=this.availabilityCheck)||void 0===t?void 0:t.updateAvailability(e).then((e=>e.forEach((e=>i(e)))))}getBounds(){const e=this.nativeBounds();return this.asBounds(e)}_actionOnPreviousMarker(e){return t=>({hideRoute:Ls(e[t.type],t.hashKeys).some((e=>"showRoutes"===e)),dehighlight:Ls(e[t.type],t.hashKeys).some((e=>"highlight"===e)),removeAriaLive:Ls(e[t.type],t.hashKeys).some((e=>"addAriaLive"===e))})}handleMapClick(e){this.logger.debug("map click"),!0!==this.ignoreMapClickEvent?(this.settings.actionsOnMapClick.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapClick.forEach((e=>{var t;switch(e){case"clearHighlight":this.dehighlightFeatures();break;case"clearSelection":this.setSelectedFeature(void 0,this._actionOnPreviousMarker(this.settings.actionsOnMarkerClick),!0);break;case"closePopup":this._closePopup();break;case"hideRoutes":null===(t=this.routes)||void 0===t||t.hideRoutes()}})),e&&this.eventsManager.pushEvent(or.mapClicked,e)):this.ignoreMapClickEvent=!1}_updateAriaLiveOnFeature(e,t){var i;e&&(t?e.marker&&xe(e.marker.ariaElement)&&Ie(e.marker.ariaElement):Se(null===(i=e.marker)||void 0===i?void 0:i.ariaElement))}handleClick(e,t,i,r){let n=e;if(n||t||!this.popup||(n=this.popup.feature),n&&n.visible&&n.type){const e=this.isFeatureSelected(n),t=this._isFeatureHighlighted(n),r=Ls(i[n.type],n.hashKeys),s=!0;if(r.forEach((i=>{var r;switch(i){case"highlight":t||this._setHighlightedFeature(n);break;case"select":this.setSelectedFeature(n,this._actionOnPreviousMarker(this.settings.actionsOnMarkerClick),s);break;case"toggleSelect":this.setSelectedFeature(e?void 0:n,this._actionOnPreviousMarker(this.settings.actionsOnMarkerClick),s);break;case"openPopup":this._openPopup(n);break;case"closePopup":this._closePopup();break;case"zoomToExtent":this._zoomToExtent(n);break;case"showRoutes":null===(r=this.routes)||void 0===r||r.showRoutes(n);break;case"loadFeatureContent":e||this.loadFeatureContent(n.id,n.type);break;case"markPreviouslySelected":this.markFeaturePreviouslySelected(n)}})),r.includes("addAriaLive")){const t=n;e?r.includes("toggleSelect")&&this._updateAriaLiveOnFeature(t,!1):this._updateAriaLiveOnFeature(t,!0)}r.includes("bounce")&&Wn(n.marker)}}bounceMarker(e,t){const i=this._findFeature(e,t);null!=i&&i.marker&&Wn(i.marker)}asKey(e){let{id:t,type:i}=e;return`${i}-${t}`}_setPopupVisible(e){var t,i;e?je(null===(t=this.popup)||void 0===t?void 0:t.visibleElement):Ve(null===(i=this.popup)||void 0===i?void 0:i.visibleElement)}_findFeature(e,t){return this.features.find(e,t)}_findClusterContainingFeature(e,t){return this.features.allClusters().find((i=>i.children.some((i=>i.id===e&&i.type===t))))}setPopupContent(e,t,i){let r=this._findFeature(e,t);r&&(r.popupContent=i)}_openPopup(e){if(this.popup){var t;const{name:i}=e||{};if(e&&void 0===e.popupContent&&i){const t=me(this.uniqId("popup-div"),void 0,"default-popup-content");Me(this.uniqId("popup-span"),t,void 0,void 0,i),e.popupContent=t}if(void 0!==this.popup.feature&&this.popup.feature===e||(this.popup.feature=e),null!==(t=this.popup.feature)&&void 0!==t&&t.popupContent){this._fillPopupContent(this.popup.feature),this._setPopupVisible(!0),this.updatePopupPositionOnLayer();const e=this.configHelper.popupVisibilities()[this.popup.feature.type];Ls(e,this.popup.feature.hashKeys)&&this.ensurePopupVisibility()}else this._fillPopupContent(),this._setPopupVisible(!1)}}_calculatePopupVisibilityOffsetValues(e,t,i,r,n,s,o,a){let l=0,u=0;return e.x<-0+t?l=e.x+0-t:e.x+s+0+t>r&&(l=e.x+s+0+t-r),a?e.y<-2+i+o?u=e.y+2-i-o:e.y+2+i>n&&(u=e.y+2+i-n):e.y<-2+i?u=e.y+2-i:e.y+o+2+i>n&&(u=e.y+o+2+i-n),[l,u]}_closePopup(){this.popup&&(delete this.popup.feature,this._fillPopupContent(),this._setPopupVisible(!1))}_fillPopupContent(e){if(this.popup)if(he(this.popup.content),e&&e.popupContent){this.popup.content.appendChild(e.popupContent);const t=this.popup.backupStyleClass,i=Ls(this.settings.popupPositions[e.type],e.hashKeys),r=[e.type,e.status,i];e.qualifiers&&r.push(...e.qualifiers),this.popup.backupStyleClass=r,tt(this.popup.cssElement,t,this.popup.backupStyleClass)}else{const e=this.popup.backupStyleClass;this.popup.backupStyleClass=void 0,tt(this.popup.cssElement,e,this.popup.backupStyleClass)}}fillPopupExternally(e,t){e.popupContent=t,this._openPopup(e)}isFeatureSelected(e){var t,i;return void 0!==e&&(null===(t=this.mapData.selectedFeature)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)&&(null===(i=this.mapData.selectedFeature)||void 0===i?void 0:i.type)===(null==e?void 0:e.type)}getFeatureSelected(){var e;return null===(e=this._getFeatureSelected())||void 0===e?void 0:e.toData()}_getFeatureSelected(){if(this.mapData.selectedFeature){const{id:e,type:t}=this.mapData.selectedFeature;return this._findFeature(e,t)}}setSelectedFeature(e,t,i){if(this.isFeatureSelected(e))return;const r=this._getFeatureSelected();if(e){const{id:t,type:i}=e;this.mapData.selectedFeature={id:t,type:i}}else this.mapData.selectedFeature=void 0;if(null!=r&&r.marker){const{status:e,qualifiers:t}=r,i=Cs(e,!1,t),n=Ls(this.settings.zIndexes[r.type],i);qn(r.marker,n)}if(e&&e.marker){const{status:t,qualifiers:i}=e,r=Cs(t,!0,i),n=Ls(this.settings.zIndexes[e.type],r);qn(e.marker,n)}if(r){const{hideRoute:e=!1,dehighlight:i=!1,removeAriaLive:s=!1}=t(r);var n;e&&(null===(n=this.routes)||void 0===n||n.hideRoutes(r)),i&&this._dehighlightFeature(r),s&&this._updateAriaLiveOnFeature(r,!1)}if((e||r)&&i){let t;const i=this.fillPopupExternally.bind(this,e);e?t={action:"select",feature:e.toData(),setPopupContent:i,previousSelectedFeature:null==r?void 0:r.toData()}:r&&(t={action:"clearSelection",feature:r.toData(),setPopupContent:i}),this.keyboardFeatures&&this._triggerUpdateKeyboardFeatures(),t&&this.eventsManager.pushEvent(or.selectionChanged,t)}}_triggerUpdateKeyboardFeatures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;const t=this.keyboardFeatures;return new Promise((i=>{setTimeout((()=>{t.updateKeyboardFeatures(),i()}),e)}))}_triggerHandleMarkerLabelCollision(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise((t=>{setTimeout((()=>{this.collisionManagement.handleMarkerLabelCollision(this.features.all(),this.getZoom()),t()}),e)}))}_zoomToFeature(e,t){const{id:i,type:r}=e,n=t||this._findClusterContainingFeature(i,r);return n?this._zoomToExtent(n).then((()=>{const t=this._findClusterContainingFeature(null==e?void 0:e.id,null==e?void 0:e.type);return t?this._zoomToFeature(e,t):(this.handleBoundsChanged("clusterExtent"),Promise.resolve())})):Promise.resolve()}_zoomToExtent(e){const t=e.children;if(t&&t.length>0){this._clearClusters();const e=t.map((e=>e.latLng));return this.boundsContaining(e,!1).then((e=>this.fitBounds(e.sw,e.ne).then((()=>this.handleBoundsChanged("clusterExtent")))))}return Promise.resolve()}handleKeyPress(e,t,i){const{type:r,visible:n,hashKeys:s}=e||{};if(n&&r){const n=Ls(t[r],s),o=i.toLowerCase(),a=n.find((e=>e===o||e===`${o}!`));if(a){const t={keyCode:i,feature:e.toData()};if(this.eventsManager.pushEvent(or.keyPressed,t),a.endsWith("!"))return!0}}return!1}mouseHoveringAsKey(e,t){let{id:i,type:r}=e;return`${r}-${i}-mouse-${t?"over":"out"}`}handleMouseOver(e,t,i,r){let n=e;if(n||t||!this.popup||(n=this.popup.feature),n&&n.visible&&n.type){const e=this.asKey(n),t=this.mapData.featuresOver.has(e);this.mapData.featuresOver.add(e),t||Ls(i[n.type],n.hashKeys).forEach((e=>{switch(e){case"highlight":this._setHighlightedFeature(n);break;case"openPopup":this._openPopup(n);break;case"sendEvent":{const e={action:"mouseEnter",feature:n.toData(),setPopupContent:this.fillPopupExternally.bind(this,n)};this.eventsManager.pushEvent(or.hoverChanged,e);break}}}))}}handleMouseOut(e,t,i,r){let n=e;if(n||t||!this.popup||(n=this.popup.feature),n&&n.visible&&n.type){const t=this.asKey(e);this.mapData.featuresOver.has(t)&&(this.mapData.featuresOver.delete(t),Ls(i[n.type],n.hashKeys).forEach((e=>{switch(e){case"dehighlight":this._dehighlightFeature(n);break;case"dehighlightIfNotSelected":this.isFeatureSelected(n)||this._dehighlightFeature(n);break;case"sendEvent":{const e={action:"mouseLeave",feature:n.toData(),setPopupContent:this.fillPopupExternally.bind(this,n)};this.eventsManager.pushEvent(or.hoverChanged,e);break}case"closePopup":this._closePopup()}})))}}handleDragStart(){this.settings.actionsOnMapDrag.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(this._getFeatureSelected(),!1),this.settings.actionsOnMapDrag.forEach((e=>{var t;switch(e){case"clearHighlight":this.dehighlightFeatures();break;case"clearSelection":this.setSelectedFeature(void 0,this._actionOnPreviousMarker(this.settings.actionsOnMarkerClick),!0);break;case"closePopup":this._closePopup();break;case"hideRoutes":null===(t=this.routes)||void 0===t||t.hideRoutes()}}))}selectFeature(e,t,i){const r=this._findFeature(e,t);if(r){const e=Ls(this.settings.actionsOnFeatureSelect[r.type],r.hashKeys),t=e.includes("zoomToExtentCluster")?this._zoomToFeature(r):Promise.resolve();if(r&&!this.isFeatureSelected(r))return t.then((()=>{this.setSelectedFeature(r,this._actionOnPreviousMarker(this.settings.actionsOnFeatureSelect),!1),i&&this.setPopupContent(r.id,r.type,i),e.includes("addAriaLive")&&this._updateAriaLiveOnFeature(r,!0),e.forEach((e=>{var t;switch(e){case"highlight":this._setHighlightedFeature(r);break;case"openPopup":this._openPopup(r);break;case"closePopup":this._closePopup();break;case"showRoutes":null===(t=this.routes)||void 0===t||t.showRoutes(r);break;case"showLinkedFeatures":this.loadFeatureContent(r.id,r.type);break;case"zoomToExtent":this._zoomToExtent(r)}})),e.includes("bounce")&&Wn(r.marker)}))}return Promise.resolve()}registerRouteDestination(){for(var e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return null===(e=this.routes)||void 0===e?void 0:e.registerRouteDestination(...i)}registerRoute(e,t,i){var r;return!0===(null===(r=this.routes)||void 0===r?void 0:r.registerRoute(e,t,i))}listRegisteredRouteDestinations(){var e;return(null===(e=this.routes)||void 0===e?void 0:e.listRegisteredRouteDestinations())||[]}listRegisteredRoutes(e){var t;return(null===(t=this.routes)||void 0===t?void 0:t.listRegisteredRoutes(e))||[]}deregisterRouteDestination(){for(var e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return(null===(e=this.routes)||void 0===e?void 0:e.deregisterRouteDestination(...i))||[]}deregisterRoute(e,t){var i;return(null===(i=this.routes)||void 0===i?void 0:i.deregisterRoute(e,t))||[]}showRoutes(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));const i=this._findFeature(e,t);if(i){for(var r=arguments.length,n=new Array(r>2?r-2:0),s=2;s<r;s++)n[s-2]=arguments[s];return this.routes.showRoutes(i,n,!1)}return Promise.reject(new Error(`feature ${t}-${e} is not found`))}showPolygons(){return this.polygonsManager.showPolygons(...arguments)}hidePolygons(){return this.polygonsManager.hidePolygons(...arguments)}listPolygonsDisplayed(){return this.polygonsManager.listPolygonsDisplayed()}addQualifierToFeature(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return this._updateQualifierFromFeatures([{id:e,type:t}],(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return e.addQualifier(...i)}),...r)}addQualifierToFeatures(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return this._updateQualifierFromFeatures(e,(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return e.addQualifier(...i)}),...i)}removeQualifierFromFeature(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return this._updateQualifierFromFeatures([{id:e,type:t}],(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return e.removeQualifier(...i)}),...r)}removeQualifierFromFeatures(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return this._updateQualifierFromFeatures(e,(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return e.removeQualifier(...i)}),...i)}_newFixMarkerToUse(){const e=this.switchMarkerType.bind(this),t=this.onMarkerIconsChanged.bind(this),i=this.addEventListener.bind(this),r=this.hasObfuscatedAreaStyleChanged.bind(this),n=this.getZoom.bind(this),s=this._switchAriaLabel.bind(this);return o=>ys(o,this.settings,this.logger,e,t,i,r,n,s)}_updateQualifierFromFeatures(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];let s=!1;const o=this._newFixMarkerToUse();return e.forEach((e=>{let{id:i,type:n}=e;const a=this._findFeature(i,n);a&&t(a,...r)&&(o(a),s=!0)})),s?this._updateViewport().then((()=>!0)):Promise.resolve(!1)}loadFeatureContent(e,t){var i;const r=null===(i=this.contentProvider)||void 0===i?void 0:i.getFeatureProviders()[t];if(r){const i=[];return Object.keys(r).forEach((n=>{const s=new Promise(((i,s)=>{r[n].loadFeatureContent(e,t).then((r=>{const{linkedFeatures:n}=r,s=this.features.allExceptClusters().filter((e=>{var t;return null===(t=e.qualifiers)||void 0===t?void 0:t.some((e=>-1!==e.toString().indexOf("linked-features")))})),o=null==n?void 0:n.filter((e=>!s.find((t=>e.id===t.id))));null==o||o.forEach((e=>this.createTileFeature(e)));const a=null==n?void 0:n.filter((e=>s.find((t=>t.id===e.id))));null==a||a.forEach((i=>{i.qualifiers.includes(`linked-features-${e}-${t}`)||i.qualifiers.push(`linked-features-${e}-${t}`)})),null==a||a.forEach((e=>this.features.upsertTileData(e,this.configHelper))),this.features.all().filter((e=>e.type===t)).map((e=>e.id)).forEach((e=>{this.configHelper.removeParam(`markers,place,show,linked-features-${e}-${t}`)})),this.configHelper.writeParam(`markers,place,show,linked-features-${e}-${t}`,!0),this._updateViewport().then((()=>{const n={success:!0,id:e,type:t,content:r};this.eventsManager.pushEvent(or.featureContentLoaded,n),i(void 0)}))})).catch((e=>{const t={success:!1,error:e};this.eventsManager.pushEvent(or.featureContentLoaded,t),s(e)}))}));i.push(s)})),Li(i)}return Promise.reject(new Error("content provider is not enabled"))}hideRoutes(e,t){if(!this.routes)return Promise.reject(new Error("map is not initialized"));const i=this._findFeature(e,t);if(i){for(var r=arguments.length,n=new Array(r>2?r-2:0),s=2;s<r;s++)n[s-2]=arguments[s];return this.routes.hideRoutes(i,n,!1)}return Promise.reject(new Error(`feature ${t}-${e} is not found`))}listRoutesDisplayed(){var e;return(null===(e=this.routes)||void 0===e?void 0:e.listRoutesDisplayed())||[]}handleTilesLoaded(e,t,i){this.logger.debug(`${e} tiles loaded - ${t} - ${i}`);const r={origin:e,contentType:t,tileIds:i};this.eventsManager.pushEvent(or.tilesLoaded,r)}handleTilesContentLoaded(e){this.eventsManager.pushEvent(or.tilesContentLoaded,e)}addCopyright(e,t){const i=ze(this.copyrightsDiv),r=[...this.copyrights.entries()].filter((e=>{let[i,r]=e;return r.content===t}));if(r.length>0)r[0][1].ownerIds.push(e);else{const r=Xt(),n=this.uniqId(`copyright-div-${r}`);this.copyrights.set(n,{content:t,ownerIds:[e]}),Me(void 0,me(n,this.copyrightsDiv,"copyright"),"copyright-text",void 0,t),i||je(this.copyrightsDiv)}}removeCopyrightForOwner(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach((e=>{[...this.copyrights.entries()].forEach((t=>{let[i,r]=t;const{ownerIds:n}=r,s=n.findIndex((t=>t===e));s>=0&&(n.splice(s,1),0==n.length&&(ce(this.copyrightsDiv,i),this.copyrights.delete(i)))}))}))}clearSelectedFeature(){let e=this._getFeatureSelected();if(e){this.setSelectedFeature(void 0,this._actionOnPreviousMarker(this.settings.actionsOnFeatureSelect),!1);const t=Ls(this.settings.actionsOnFeatureDeselect[e.type],e.hashKeys);t.includes("removeAriaLive")&&this._updateAriaLiveOnFeature(e,!1),t.forEach((t=>{var i;switch(t){case"dehighlight":this._dehighlightFeature(e);break;case"closePopup":this._closePopup();break;case"hideRoutes":null===(i=this.routes)||void 0===i||i.hideRoutes(e)}})),this.keyboardFeatures&&this._triggerUpdateKeyboardFeatures()}}listHighlightedFeatures(){return this.mapData.highlightedFeatures.flatMap((e=>{let{id:t,type:i}=e;const r=this._findFeature(t,i);if(r)return r.toData()}))}markFeatureOver(e,t){const i=this._findFeature(e,t);if(i){const r="cluster"!==i.type?this._findClusterContainingFeature(e,t):void 0;Ls(this.settings.actionsOnFeatureOver[i.type],i.hashKeys).forEach((e=>{switch(e){case"highlight":this._setHighlightedFeature(r||i);break;case"openPopup":this._openPopup(i)}}))}}markFeatureOut(e,t){const i=this._findFeature(e,t);if(i){const r="cluster"!==i.type?this._findClusterContainingFeature(e,t):null;Ls(this.settings.actionsOnFeatureOut[i.type],i.hashKeys).forEach((e=>{switch(e){case"dehighlight":this._dehighlightFeature(r||i);break;case"dehighlightIfNotSelected":this.isFeatureSelected(r||i)||this._dehighlightFeature(r||i);break;case"closePopup":this._closePopup()}}))}}_highlightMarker(e,t){e&&(e.highlighted=t,e.marker&&this._newFixMarkerToUse()(e))}_setHighlightedFeature(e){if(!this._isFeatureHighlighted(e)){const{id:t,type:i}=e;this.mapData.highlightedFeatures.push({id:t,type:i}),this._highlightMarker(e,!0)}}_dehighlightFeature(e){const t=this._getFeatureHighlightIndex(e);t>=0&&(this.mapData.highlightedFeatures.splice(t,1),this._highlightMarker(e,!1))}_getFeatureHighlightIndex(e){const{id:t,type:i}=e;return this.mapData.highlightedFeatures.findIndex((e=>{let{id:r,type:n}=e;return t===r&&i===n}))}_isFeatureHighlighted(e){return this._getFeatureHighlightIndex(e)>=0}dehighlightFeatures(){const e=[];this.mapData.highlightedFeatures.forEach((t=>{let{id:i,type:r}=t;const n=this._findFeature(i,r);!n||this.isFeatureSelected(n)&&Ls(this.settings.actionsOnFeatureOut[n.type],n.hashKeys).includes("dehighlightIfNotSelected")?e.push({id:i,type:r}):this._highlightMarker(n,!1)})),this.mapData.highlightedFeatures=e}isFeaturePreviouslySelected(e){return this.mapData.previouslySelectedFeatures.has(this.asKey(e))}markFeaturePreviouslySelected(e){rt(e.marker.cssElement,"previously-selected"),this.mapData.previouslySelectedFeatures.add(this.asKey(e)),sessionStorage.setItem("__map_previously_selected_features",JSON.stringify(Array.from(this.mapData.previouslySelectedFeatures)))}turnFeaturesVisible(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4?arguments[4]:void 0;this.configHelper.overrideMarkerShowConfig(e,t,i,r),n&&this._updateViewport()}_createGenericPopup(e){const t=me(this.uniqId("popup"),e,"popup","visibility:false"),i=me(void 0,t,"popup-close-button close-button");me(void 0,i,"leftright"),me(void 0,i,"rightleft"),me(void 0,i,"close");const r=this._closePopup.bind(this);t.content=me(void 0,t,"popup-content");const n=this.updatePopupPositionOnLayer.bind(this);return new ResizeObserver(n).observe(t.content),t.clean=[this.addEventListener(i,_s,(e=>{var t;e.stopPropagation(),null!==(t=this.popup)&&void 0!==t&&t.feature&&this.mapData.featuresOver.delete(this.asKey(this.popup.feature)),r()}))],t.visibleElement=void 0,t.cssElement=void 0,t}_allClusters(e){return this.features.allClusters().filter((t=>{let{featureType:i}=t;return void 0===e||e===i}))}_clearCluster(e){this.deleteMarker(e),this.features.delete(e.id,e.type)}_clearClusters(e){this._allClusters(e).forEach((e=>this._clearCluster(e)))}_pushClusterData(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let i of e)t?this.features.upsertUserData(i,this.configHelper):this.features.upsertTileData(i,this.configHelper)}_notifyStatusUsageForType(e,t){this.configHelper.loadQualifiersAndHashkeysUsed(e),this.features.repository(e).data.forEach((e=>{e.refreshHashkeys()}))}_updateViewport(e){var t;let i=e;return i||(i=this.nativeBounds()),null!==(t=this.availabilityCheck)&&void 0!==t&&t.isAvailabilityCheckActive()?this._updateViewportWithAvailabilityCheck(i):this._updateViewportAux(i)}_updateViewportAux(e){this.boundsToRefresh=this.asBounds(e);const t=this.configHelper.markersShow(),i=this.configHelper.markersKeepOutOfViewport(),r=ln.map((r=>new Promise((n=>{this._changeMarkersVisibility(e,r,t[r],i[r]),n(void 0)}))));return Promise.all(r).then((()=>{const t=this.getBounds();return t&&this.boundsToRefresh&&zt(t,this.boundsToRefresh)&&(this.keyboardFeatures&&this._triggerUpdateKeyboardFeatures(),this.collisionManagement&&this._triggerHandleMarkerLabelCollision()),e}))}_updateViewportWithAvailabilityCheck(e){this.boundsToRefresh=this.asBounds(e);const t=[],i=this.configHelper.markersShow(),r=this.configHelper.markersKeepOutOfViewport();return t.push(this._updateViewportAux(e)),an.forEach((n=>{const s=this.features.allWithCoordinates(n).filter((t=>this.isFeatureInRealBound(e,t)));t.push(this.updateAvailability(s).then((()=>{const t=this.getBounds();if(t&&this.boundsToRefresh&&zt(t,this.boundsToRefresh))return this._changeMarkersVisibility(e,n,i[n],r[n]),Promise.resolve()})).catch((e=>{this.logger.error(`Failed to update availabilities: ${e.message}`,e.stack)})))})),Promise.all(t).then((()=>{const t=this.getBounds();return this.keyboardFeatures&&t&&this.boundsToRefresh&&zt(t,this.boundsToRefresh)&&this.keyboardFeatures.updateKeyboardFeatures(),e}))}_changeClusterMarkerVisibility(e,t,i,r){const n=this.getBounds(),s=this._allClusters(e);let o={clusters:[],remainingFeatures:t};this.clusterers&&this.clusterers[e].forEach((t=>{const{clusterer:r,qualifier:s}=t;if(r)try{var a,l,u,h;const t={clientWidth:null!==(a=null===(l=this.node)||void 0===l?void 0:l.clientWidth)&&void 0!==a?a:0,clientHeight:null!==(u=null===(h=this.node)||void 0===h?void 0:h.clientHeight)&&void 0!==u?u:0};o=r.getClustersAndFeatures(o,e,s,n,i,t,this.getTileDim())}catch(e){this.logger.warn(`Failed to compute cluster: ${e.message}`,e.stack)}})),this._pushClusterData(o.clusters,!1);const a=o.clusters.map((e=>e.id));s.filter((e=>{let{id:t}=e;return!a.includes(t)})).forEach((e=>this._clearCluster(e))),this._allClusters(e).filter((e=>!e.marker)).forEach((e=>this._createMarker(e)));const l=o.remainingFeatures.map((e=>e.id));for(let u of t)l.includes(u.id)&&(r.push(u.id),u.marker?u.visible=!0:this._makeMarkerVisible(u,!0))}_haveSomeClustersByFeatureType(e){return void 0!==this.clusterers&&void 0!==this.clusterers[e]&&this.clusterers[e].length>0}_changeMarkersVisibility(e,t,i,r){const n=this.getZoom(),{withMarkers:s}=this.mapData[t],{inBounds:o,outBounds:a}=this._identifyFeatureWithMarkerAddedToMap(e,n,t,i,r),l=[];this._haveSomeClustersByFeatureType(t)?this._changeClusterMarkerVisibility(t,o,n,l):o.forEach((e=>{l.push(e.id),e.marker?e.visible=!0:this._makeMarkerVisible(e,!0)})),a.forEach((e=>{l.push(e.id),e.marker||(this._makeMarkerVisible(e,!0),e.marker.labels.hideTextLabel(!0))})),s.filter((e=>!l.includes(e.id))).forEach((e=>this._makeMarkerVisible(e,!1)))}_featureShouldHaveMarker(e,t,i,r){var n;const s=null===(n=e.tileData)||void 0===n?void 0:n.tile,o=s&&s.length>=3?s[2]:void 0,a=Ls(i,e.hashKeys);return!!((void 0===o||e.hasUserData()||o<=r)&&Ls(this.settings.minZoomForDisplay[e.type],e.hashKeys)<=r&&a)&&(!this.isFeatureInRealBound(t,e)||"inViewport")}_retrieveCandidates(e,t,i,r,n,s){const o=e.length;let a=0;for(;a<o;){const o=e[a];a++;const l=this._featureShouldHaveMarker(o,t,i,n);o.inBounds="inViewport"===l,!1!==l&&!1!==(Ls(r,o.hashKeys)||"inViewport"===l)&&s(o,o.inBounds)}}_identifyFeatureWithMarkerAddedToMap(e,t,i,r,n){let s=[];const o={selected:{threshold:-1,maxZoomForCount:1,inB:[],outB:[]}};for(const l in this.settings.threshold[i]){const e=this.settings.threshold[i][l],t=Ls(this.settings.maxZoomForCount[i],[l]);o[l]={threshold:e,maxZoomForCount:t,inB:[],outB:[]}}this._retrieveCandidates(this.features.allWithCoordinates(i),e,r,n,t,((e,t)=>Ls(o,e.hashKeys)[t?"inB":"outB"].push(e)));let a=[];for(const l in o){const{threshold:e,maxZoomForCount:i,inB:r,outB:n}=o[l];r.length>0&&(t>=i||e<0||r.length<=e)&&(a=a.concat(r)),n.length>0&&(t>=i||e<0||r.length+n.length<=e)&&(s=s.concat(n))}return this.mapData[i].withMarkers=[...a,...s],{inBounds:a,outBounds:s}}updateConfigHelperOnFeatures(e){this.features.all().forEach((t=>{t.updateConfigHelper(e)}))}clearHashkeys(){this.features.all().forEach((e=>{e.clearHashkeys()}))}clearMarkers(){this.features.all().forEach((e=>this.deleteMarker(e)))}listFeatures(e,t){return this._listFeatures(e,t).map((e=>e.toData()))}_listFeatures(e,t){let i=this.features.all();if(t){const e=this.asNativeBounds(t.sw,t.ne);i=i.filter((e=>void 0!==e)).filter((t=>this.isFeatureInRealBound(e,t)))}return e&&(i=i.filter(e)),i}pushFeatureData(e,t,i){this.logger.debug("push feature data");let r=[],n=[],s=[],o=[];this._pushFeatureDataModifyFeatures(e,r,s,n);let a=n.concat(r);switch(t){case"merge":if(s.length===e.length)return;break;case"replace":{const t=e.map(this.asKey),i=this.features.allExceptClusters().filter((e=>!t.includes(this.asKey(e))));o=this._removePushedFeatureDataAux(i,!1)}break;default:throw new Error(`action ${t} not supported`)}if(i&&this._pushFeatureDataHandleEvents(a,o),this.mapData.selectedFeature&&o.map(this.asKey).includes(this.asKey(this.mapData.selectedFeature))&&this.clearSelectedFeature(),a.length>0||o.length>0)return this._updateViewport(),this._computeStrictBounds(a.concat(s).filter((e=>void 0!==e.latLng)).map((e=>e.latLng)))}_pushFeatureDataModifyFeatures(e,t,i,r){const n=this._newFixMarkerToUse();for(let s of e){const e=this.features.repository(s.type).find(s.id);if(e)if(e.isUserDataChanged(s)){const e=this.features.upsertUserData(s,this.configHelper);n(e),t.push(e)}else i.push(e);else{const e=this.features.upsertUserData(s,this.configHelper);n(e),r.push(e)}}}updatePartiallyFeature(e){const t=[],i=e.flatMap((e=>{const{id:i,type:r}=e,n=function(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;i[r]=e[r]}return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)i=s[r],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,bs),s=this.features.repository(e.type).find(e.id);return s?Ms(Ms({},s.toData()),n):(t.push(e),[])}));return this.pushFeatureData(i,"merge",!1),t}_pushFeatureDataHandleEvents(e,t){const i=[];if(e.length>0){const t=this._computeStrictBounds(e.filter((e=>void 0!==e.latLng)).map((e=>e.latLng)));i.push({type:"addedOrUpdated",features:e.map((e=>e.toData())),bounds:t})}if(t.length>0){const e=this._computeStrictBounds(t.filter((e=>void 0!==e.lat&&void 0!==e.lng)).map((e=>[e.lat,e.lng])));i.push({type:"removed",features:t,bounds:e})}if(i.length>0){const e={changes:i};this.eventsManager.pushEvent(or.markersChanged,e)}}removePushedFeatureData(e){var t;let i,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.logger.debug("removing pushed feature data"),this.logger.debug(e),void 0!==e){const t=e.map((e=>{let{id:t,type:i}=e;return this.features.repository(i).find(t)})).filter((e=>void 0!==e));i=this._removePushedFeatureDataAux(t,r)}else{const e=this.features.allExceptClusters();i=this._removePushedFeatureDataAux(e,r)}return(null===(t=i)||void 0===t?void 0:t.length)>0&&this._updateViewport(),i}onMarkerIconsChanged(e){}_removePushedFeatureDataAux(e,t){const i=[];for(let r of e.filter((e=>e.hasUserData())))this.popup&&this.popup.feature&&this.popup.feature.id===r.id&&this._closePopup(),this.isFeatureSelected(r)&&this.clearSelectedFeature(),this.deleteMarker(r),i.push(r.toData()),r.removeUserData();if(i.length>0&&t){const e=this._computeStrictBounds(i.filter((e=>void 0!==e.latLng)).map((e=>e.latLng))),t={changes:[{type:"removed",features:i,bounds:e}]};this.eventsManager.pushEvent(or.markersChanged,t)}return i}createTileFeature(e){return this.features.insertTileDataWithLowestZoom(e,this.configHelper)}removeTileFeature(e){return this.features.deleteTileData(e)}_makeMarkerVisible(e,t){e.visible=t,t?this._createMarker(e):this.deleteMarker(e)}_createMarker(e,t){const i=[];this.isFeaturePreviouslySelected(e)&&i.push("previously-selected");const{common:r,markerType:n,frameIcon:s,text:o,pin:a,minimal:l}=ms(e,this.getMarkerElement(e),this.settings,t,i);switch(n){case"price":e.marker=this.createTextMarker(r,o,"price");break;case"text":e.marker=this.createTextMarker(r,o,"text");break;case"pin":e.marker=this.createPinMarker(r,a,s);break;case"obfuscate":e.marker=this.createObfuscatedMarker(l);break;case"pinObfuscate":e.marker=this.createPinObfuscatedMarker(r,a,s);break;case"priceObfuscate":e.marker=this.createPriceObfuscatedMarker(r,o);break;case"clusterMarker":e.marker=this.createClusterMarker(e);break;default:throw new Error(`marker type not supported: ${n}`)}e.marker.markerType=n}switchMarkerType(e,t){return this.deleteMarker(e),!!e.visible&&(this._createMarker(e,t),!0)}turnKeyboardFeaturesMode(e){if(!this.keyboardFeatures)throw new Error("You need to enable keyboard features from config in order to use it.");this.keyboardFeatures.turnKeyboardFeaturesMode(e)}isKeyboardFeaturesModeEnabled(){var e;return!!this.keyboardFeatures&&(null===(e=this.keyboardFeatures)||void 0===e?void 0:e.isKeyboardFeaturesModeEnabled())}_switchAriaLabel(e,t,i){ss(e,t,i)}}function Fs(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Os(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Fs(Object(i),!0).forEach((function(t){Es(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Fs(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Es(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const{isObject:Is,stringify:Ss}=t,Ds="markers",As="default",Ts="undefined"!=typeof google?google.maps.Marker.MAX_ZINDEX:0;class Bs extends Fi{constructor(e,t,i,r){super(e,t,r),this._loadLocale(e),this.i18n=new Ei(i,this.locale,{readParam:this.readParam.bind(this),writeParam:this.writeParam.bind(this)}),this.qualifiersAndHashkeysUsed={}}ready(){return super.ready().then((()=>(this.loadQualifiersAndHashkeysUsed(),this)))}getEGMapConfigurations(){const e=this.getConfigurations();return{default:e.default,external:e.external,overwrite:e.overwrite,parameter:e.parameter,final:this.subConfig()}}loadQualifiersAndHashkeysUsed(e){(e?[e]:cn).forEach((e=>this.qualifiersAndHashkeysUsed[e]=this._identifyQualifiersAndHashKeysUsedInHashkeys(e)))}_loadLocale(e){this.locale=null==e?void 0:e.locale;const t=this.readParam("locale");if(t){const[,e,,,i]=/^([a-z]{2})((-|_)([A-Z]{2}))?$/.exec(t)||[];e&&(this.locale=i?`${e}-${i}`:e)}}mapProvider(){return this.readParam("mapProvider")}getLocale(){return this.locale}getI18N(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return this.i18n.format(e,...i)}filterQualifiersUsed(e,t){const i=this.qualifiersAndHashkeysUsed[e].qualifiers;return t.filter((e=>i.includes(e)))}isQualifiersUsedInConfig(e,t){return this.qualifiersAndHashkeysUsed[e].qualifiers.includes(t)}filterHashkeysUsed(e,t){const i=this.qualifiersAndHashkeysUsed[e].hashkeys;return t.filter((e=>i.includes(e)))}_identifyQualifiersAndHashKeysUsedInHashkeys(e){const t=new Set,i=new Set;return i.add("default"),this._identifyAllHashkeys(e).forEach((r=>{i.add(r),r.split("#").forEach((i=>{this.getFeatureStatus(e).includes(i)||"hl"===i||t.add(i)}))})),{qualifiers:[...t],hashkeys:[...i].map((e=>e.split("#").sort().join("#")))}}_identifyAllHashkeys(e){const t=this.listStringKeys(`markers,${e}`),i=new Set,r=new Set;t.forEach((e=>{if(e.endsWith(As))r.add(e.substring(0,e.length-7-1));else{const t=e.indexOf(`,${As},`);t>0?r.add(e.substring(0,t)):i.add(e)}}));const n=new Set;return i.forEach((e=>{r.forEach((t=>{e.startsWith(t)&&n.add(e.substring(t.length+1).split(",")[0])}))})),[...n]}mapboxAccessToken(){return this.readParam("mapbox,accessToken")}getFeatureTypes(){return ln}getFeatureStatus(e){switch(e){case rn:return hn;case nn:return dn;case sn:case on:return[un];default:throw new Error(`Type unknown: ${e}`)}}iso4217CurrencyCode(){return this.readParam("iso4217CurrencyCode")}icons(){return this.propertyValues(Ds,"icons",ln)}frameIcons(){return this.propertyValues(Ds,"frameIcons",ln)}cornerIcons(){return{"top-left":this.propertyValues(Ds,"cornerIcons,topLeft",ln),"top-right":this.propertyValues(Ds,"cornerIcons,topRight",ln),"bottom-left":this.propertyValues(Ds,"cornerIcons,bottomLeft",ln),"bottom-right":this.propertyValues(Ds,"cornerIcons,bottomRight",ln)}}innerIcons(){return{left:this.propertyValues(Ds,"innerIcons,left",ln),right:this.propertyValues(Ds,"innerIcons,right",ln)}}obfuscateRadiusInMeters(){return this.propertyValues(Ds,"obfuscateMarkers,radiusInM",an)}obfuscatePrecision(){return this.propertyValues(Ds,"obfuscateMarkers,precision",an)}obfuscateStyle(){return this.propertyValues(Ds,"obfuscateMarkers,style",an)}polygonStyles(){return this.propertyValues("polygons","style",ln)}zIndexes(){const e=this.propertyValues(Ds,"zIndex",cn);if("google-maps"===this.mapProvider())for(let t in e)for(let i in e[t])e[t][i]=e[t][i]+Ts;return e}maxZIndex(){const e=this.zIndexes();let t=0;return Object.values(e).forEach((e=>Object.values(e).forEach((e=>{e>t&&(t=e)})))),t}textLabelDynamicPlacement(){return this.propertyValues(Ds,"textLabel,dynamicPlacement",ln)}textLabelMaxLineLength(){return this.propertyValues(Ds,"textLabel,maxLineLength",ln)}textLabelMaxLines(){return this.propertyValues(Ds,"textLabel,maxLines",ln)}textLabelMinZoom(){return this.propertyValues(Ds,"textLabel,minZoom",ln)}textLabelMaxZoom(){return this.propertyValues(Ds,"textLabel,maxZoom",ln)}textSubLabelMinZoom(){return this.propertyValues(Ds,"textLabel,subLabel,minZoom",ln)}textSubLabelMaxZoom(){return this.propertyValues(Ds,"textLabel,subLabel,maxZoom",ln)}textSubLabelMaxLineLength(){return this.propertyValues(Ds,"textLabel,subLabel,maxLineLength",ln)}textSubLabelMaxLines(){return this.propertyValues(Ds,"textLabel,subLabel,maxLines",ln)}textLabelVisibility(){return this.propertyValues(Ds,"textLabel,show",cn)}textSubLabelVisibility(){return this.propertyValues(Ds,"textLabel,subLabel,show",cn)}textLabelZIndex(){return this.propertyValues(Ds,"textLabel,zIndex",cn)}textLabelPosition(){return this.propertyValues(Ds,"textLabel,position",cn,(e=>{let t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}popupPositions(){return this.propertyValues(Ds,"popup,position",ln,(e=>{let t=e;switch(e){case"bottom":t="below";break;case"top":t="above"}return t}))}popupVisibilities(){return this.propertyValues(Ds,"popup,ensureVisibility",ln)}popupVisibilityPaddings(){return this.propertyValues(Ds,"popup,visibilityPadding",ln)}markerTypes(){return this.propertyValues(Ds,"markerType",ln)}isAtLeastOneProductStatusUsingObfuscateMarker(){return Object.values(this.markerTypes().product||{}).some((e=>"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e))}isAtLeastOnePropertyStatusUsingObfuscateMarker(){return Object.values(this.markerTypes().property||{}).some((e=>"obfuscate"===e||"pinObfuscate"===e||"priceObfuscate"===e))}markersShow(){return this.propertyValues(Ds,"show",ln)}markersKeepOutOfViewport(){return this.propertyValues(Ds,"keepOutOfViewport",ln)}actionsOnFeatureSelect(){return this.propertyValues(Ds,"actionOnFeatureSelect",cn)}actionsOnFeatureDeselect(){return this.propertyValues(Ds,"actionOnFeatureDeselect",ln)}actionsOnFeatureOver(){return this.propertyValues(Ds,"actionOnFeatureOver",cn)}actionsOnFeatureOut(){return this.propertyValues(Ds,"actionOnFeatureOut",cn)}actionsOnMarkerClick(){return this.propertyValues(Ds,"actionOnClick",cn)}actionsOnMarkerMouseOver(){return this.propertyValues(Ds,"actionOnMouseOver",cn)}actionsOnMarkerMouseOut(){return this.propertyValues(Ds,"actionOnMouseOut",cn)}keyNamesForMarkerKeyPressEvent(){return this.propertyValues(Ds,"keyNameForKeyPressEvent",cn)}actionsOnPopupClick(){return this.propertyValues(Ds,"popup,actionOnClick",ln)}actionsOnPopupMouseOver(){return this.propertyValues(Ds,"popup,actionOnMouseOver",ln)}actionsOnPopupMouseOut(){return this.propertyValues(Ds,"popup,actionOnMouseOut",ln)}keyNamesForPopupKeyPressEvent(){return this.propertyValues(Ds,"popup,keyNameForKeyPressEvent",ln)}actionsOnMapDrag(){return this.readParam("map,onMapDrag")}actionsOnMapClick(){return this.readParam("map,onMapClick")}singlePropertiesValues(e,t){const i={};return t.map((t=>{i[t]=this.readParam(`${Ds},${t},${e}`)})),i}threshold(){const e=this.propertyValues(Ds,"threshold",ln),t=this.singlePropertiesValues(`threshold,${As}`,ln);return ln.forEach((i=>e[i].default=t[i])),e}style(){return this.readParam("style")}maxZoomForCount(){const e=this.propertyValues(Ds,"maxZoomForCount",ln),t=this.singlePropertiesValues(`maxZoomForCount,${As}`,ln);return ln.forEach((i=>e[i].default=t[i])),e}clusterConfigurationByType(){return this.propertyValues(Ds,"clustering",ln)}clusterDefaultConfigurationByType(){const e={};return ln.forEach((t=>{e[t]=this.subConfig(`markers,${t},clustering,default`)})),e}isKeyboardFeaturesDefined(){return void 0!==this.readParam("a11y,keyboardFeatures,enabled")}isKeyboardFeaturesEnabled(){return!0===this.readParam("a11y,keyboardFeatures,enabled")}isAnyContentProviderExists(){return ln.some((e=>{var t,i;return null!==(t=null===(i=this.readParam(`contentProvider,${e},default`))||void 0===i?void 0:i.length)&&void 0!==t&&t}))}minZoomForDisplay(){const e=this.propertyValues(Ds,"minZoomForDisplay",ln),t=this.singlePropertiesValues(`minZoomForDisplay,${As}`,ln);return ln.forEach((i=>e[i].default=t[i])),e}minZoomForTileRequest(){return this.readParam("tiles,minZoomForTileRequest")}historicalBoundingBoxDataEndpoint(){return this.readParam("historicalBoundingBoxDataEndpoint")}tagCollidingMarkers(){const e=this.propertyValues(Ds,"tagCollidingMarkers",cn),t=this.singlePropertiesValues(`tagCollidingMarkers,${As}`,cn);return cn.forEach((i=>e[i].default=t[i])),e}collisionBufferVariation(){const e=this.propertyValues(Ds,"collisionBufferVariation",cn),t=this.singlePropertiesValues(`collisionBufferVariation,${As}`,cn);return cn.forEach((i=>e[i].default=t[i])),e}collisionBuffers(){return this.readParam("markers,common,collisionBuffers")}clusterMarkerCollisionBufferInPixels(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,clusterMarkerCollisionBufferInPixels,default")}shouldMoveCollidingClusterMarkers(){return this.readParam("markers,cluster,clusterMarkerCollisionAvoidance,moveCollidingClusterMarkers,default")}routeLineStyleByDistanceMode(){return this.propertyValues("routes,style",void 0,["driving","cycling","walking","flying"])}googleMaps(){return this.subConfig("googleMaps")}mapbox(){return this.subConfig("mapbox")}tilesReaderConfig(){return this.subConfig("tiles,enabled")}tilesProvidersConfig(){return this.subConfig("tiles,providers")}tilesCacheConfig(){return this.subConfig("tiles,cache")}routeCacheInMs(){return this.readParam("routes,cacheInMs")}egDistances(){return this.readParam("routes,egDistances")}keyboardFeaturesIcon(){return this.readParam("a11y,keyboardFeatures,keyboardFeaturesIcon")}contentProvidersByFeatureType(){const e={};return ln.forEach((t=>e[t]=this.readParam(`contentProvider,${t},default`))),e}contentProvidersConfigs(){return this.subConfig("contentProvider,providers")}availabilityProvider(){return this.readParam("availability,availabilityProvider")}gmapsAddConfig(){return this.subConfig("googleMaps,gmapsAddConfig")}loadMapSettings(){return{mapProvider:this.mapProvider(),loggerFactory:this.logger.bind(this),featureTypes:ln,getFeatureStatus:this.getFeatureStatus.bind(this),getI18N:this.getI18N.bind(this),actionsOnFeatureSelect:this.actionsOnFeatureSelect(),actionsOnFeatureDeselect:this.actionsOnFeatureDeselect(),actionsOnFeatureOver:this.actionsOnFeatureOver(),actionsOnFeatureOut:this.actionsOnFeatureOut(),actionsOnMarkerClick:this.actionsOnMarkerClick(),actionsOnMarkerMouseOver:this.actionsOnMarkerMouseOver(),actionsOnMarkerMouseOut:this.actionsOnMarkerMouseOut(),keyNamesForMarkerKeyPressEvent:this.keyNamesForMarkerKeyPressEvent(),actionsOnPopupClick:this.actionsOnPopupClick(),actionsOnPopupMouseOver:this.actionsOnPopupMouseOver(),actionsOnPopupMouseOut:this.actionsOnPopupMouseOut(),keyNamesForPopupKeyPressEvent:this.keyNamesForPopupKeyPressEvent(),popupPositions:this.popupPositions(),actionsOnMapDrag:this.actionsOnMapDrag(),actionsOnMapClick:this.actionsOnMapClick(),routeCacheInMs:this.routeCacheInMs(),contentProvidersByFeatureType:this.contentProvidersByFeatureType(),contentProvidersConfigs:this.contentProvidersConfigs(),availabilityProvider:this.availabilityProvider(),locale:this.getLocale(),isKeyboardFeaturesDefined:this.isKeyboardFeaturesDefined(),isKeyboardFeaturesEnabled:this.isKeyboardFeaturesEnabled(),keyboardFeaturesIcon:this.keyboardFeaturesIcon(),tiles:{tilesReaderConfig:this.tilesReaderConfig(),tilesProvidersConfig:this.tilesProvidersConfig(),tilesCacheConfig:this.tilesCacheConfig(),minZoomForTileRequest:this.minZoomForTileRequest(),debugTileId:xi.getDebugTilesIdEnabled()},styling:this.style(),threshold:this.threshold(),maxZoomForCount:this.maxZoomForCount(),minZoomForDisplay:this.minZoomForDisplay(),clusterConfigurationByType:this.clusterConfigurationByType(),clusterDefaultConfigurationByType:this.clusterDefaultConfigurationByType(),isAnyContentProviderExists:this.isAnyContentProviderExists(),historicalBoundingBoxDataEndpoint:this.historicalBoundingBoxDataEndpoint(),markerTypes:this.markerTypes(),isAtLeastOneProductStatusUsingObfuscateMarker:this.isAtLeastOneProductStatusUsingObfuscateMarker(),isAtLeastOnePropertyStatusUsingObfuscateMarker:this.isAtLeastOnePropertyStatusUsingObfuscateMarker(),obfuscateRadiusInMeters:this.obfuscateRadiusInMeters(),obfuscatePrecision:this.obfuscatePrecision(),obfuscateStyle:this.obfuscateStyle(),icons:this.icons(),frameIcons:this.frameIcons(),cornerIcons:this.cornerIcons(),innerIcons:this.innerIcons(),textLabelVisibility:this.textLabelVisibility(),textSubLabelVisibility:this.textSubLabelVisibility(),zIndexes:this.zIndexes(),maxZIndex:this.maxZIndex(),textLabelZIndex:this.textLabelZIndex(),textLabelMinZoom:this.textLabelMinZoom(),textLabelMaxZoom:this.textLabelMaxZoom(),textLabelPosition:this.textLabelPosition(),textLabelMaxLineLength:this.textLabelMaxLineLength(),textLabelMaxLines:this.textLabelMaxLines(),textSubLabelMinZoom:this.textSubLabelMinZoom(),textSubLabelMaxZoom:this.textSubLabelMaxZoom(),textSubLabelMaxLineLength:this.textSubLabelMaxLineLength(),textSubLabelMaxLines:this.textSubLabelMaxLines(),polygonStyles:this.polygonStyles(),iso4217CurrencyCode:this.iso4217CurrencyCode(),debugMarkersPosition:xi.getDebugMarkersPositionEnabled(),collision:{labelVisibility:this.textLabelVisibility(),dynamicPlacement:this.textLabelDynamicPlacement(),collisionBufferVariation:this.collisionBufferVariation(),collisionBuffers:this.collisionBuffers(),tagCollidingMarkers:this.tagCollidingMarkers(),clusterMarkerCollisionBufferInPixels:this.clusterMarkerCollisionBufferInPixels(),shouldMoveCollidingClusterMarkers:this.shouldMoveCollidingClusterMarkers()},routeLineStyleByDistanceMode:this.routeLineStyleByDistanceMode(),googleMaps:Os(Os({},this.googleMaps()),{},{debugShouldUseAdvancedMarkers:xi.shouldUseGmapsAdvancedMarkers()}),mapbox:this.mapbox()}}getActiveTilesets(){const e=this.readParam("tiles,enabled,product"),t=this.readParam("tiles,enabled,property"),i=this.readParam("tiles,enabled,place"),r=[].concat(e,t,i),n=this.subConfig("tiles,providers");return r.map((e=>{var t;return null===(t=n[e])||void 0===t?void 0:t.tilesetId}))}overrideMarkerShowConfig(e,t,i){const r=`markers,${e},show,${[i,...arguments.length>3&&void 0!==arguments[3]?arguments[3]:[]].filter((e=>void 0!==e)).join("#")}`;null===t?this.removeOverrideParam(r):this.writeParam(r,t)}}function Rs(e,t){var i,r;const n=e.mapProvider!==t.mapProvider||"mapbox"===t.mapProvider&&Ns(e.mapbox,t.mapbox)||"google-maps"===t.mapProvider&&((null===(i=e.googleMaps)||void 0===i||null===(i=i.gmapsAddConfig)||void 0===i?void 0:i.mapId)||"")!==((null===(r=t.googleMaps)||void 0===r||null===(r=r.gmapsAddConfig)||void 0===r?void 0:r.mapId)||"");if(n)return{reinstantiate:n};const s="google-maps"===t.mapProvider&&Ns(e.googleMaps.gmapsAddConfig||{},t.googleMaps.gmapsAddConfig||{}),o=Ks(e.icons,t.icons),a=Ns(e.frameIcons,t.frameIcons),l=Ks(e.cornerIcons,t.cornerIcons),u=Ks(e.innerIcons,t.innerIcons),h=Ns(e.contentProvidersByFeatureType,t.contentProvidersByFeatureType),d=Ns(e.threshold,t.threshold),c=Ns(e.maxZoomForCount,t.maxZoomForCount),p=Ns(e.minZoomForDisplay,t.minZoomForDisplay),g=Ns(e.clusterConfigurationByType,t.clusterConfigurationByType),f=Ns(e.markerTypes,t.markerTypes),m=Ns(e.obfuscateRadiusInMeters,t.obfuscateRadiusInMeters),y=Ns(e.obfuscatePrecision,t.obfuscatePrecision),v=Ns(e.obfuscateStyle,t.obfuscateStyle),b=Ns(e.textLabelVisibility,t.textLabelVisibility),k=Ns(e.textSubLabelVisibility,t.textSubLabelVisibility),M=Ns(e.zIndexes,t.zIndexes),P=Ns(e.textLabelZIndex,t.textLabelZIndex),L=Ns(e.textLabelMinZoom,t.textLabelMinZoom),C=Ns(e.textLabelMaxZoom,t.textLabelMaxZoom),_=Ns(e.textLabelPosition,t.textLabelPosition),w=Ns(e.textLabelMaxLineLength,t.textLabelMaxLineLength),x=Ns(e.textLabelMaxLines,t.textLabelMaxLines),F=Ns(e.textSubLabelMinZoom,t.textSubLabelMinZoom),O=Ns(e.textSubLabelMaxZoom,t.textSubLabelMaxZoom),E=Ns(e.textSubLabelMaxLineLength,t.textSubLabelMaxLineLength),I=Ns(e.textSubLabelMaxLines,t.textSubLabelMaxLines),S=Ns(e.polygonStyles,t.polygonStyles),D=Ns(e.collision,t.collision),A=Ns(e.routeLineStyleByDistanceMode,t.routeLineStyleByDistanceMode),T=Ns(e.contentProvidersConfigs,t.contentProvidersConfigs),B=Ns(e.availabilityProvider,t.availabilityProvider),R=Ns(e.clusterDefaultConfigurationByType,t.clusterDefaultConfigurationByType),N=Ns(e.tiles,t.tiles),K=Ns(e.actionsOnFeatureSelect,t.actionsOnFeatureSelect)||Ns(e.actionsOnFeatureDeselect,t.actionsOnFeatureDeselect)||Ns(e.actionsOnFeatureOver,t.actionsOnFeatureOver)||Ns(e.actionsOnFeatureOut,t.actionsOnFeatureOut)||Ns(e.actionsOnMarkerClick,t.actionsOnMarkerClick)||Ns(e.actionsOnMarkerMouseOver,t.actionsOnMarkerMouseOver)||Ns(e.actionsOnMarkerMouseOut,t.actionsOnMarkerMouseOut)||Ns(e.keyNamesForMarkerKeyPressEvent,t.keyNamesForMarkerKeyPressEvent)||Ns(e.actionsOnPopupClick,t.actionsOnPopupClick)||Ns(e.actionsOnPopupMouseOver,t.actionsOnPopupMouseOver)||Ns(e.actionsOnPopupMouseOut,t.actionsOnPopupMouseOut)||Ns(e.keyNamesForPopupKeyPressEvent,t.keyNamesForPopupKeyPressEvent)||Ns(e.popupPositions,t.popupPositions)||h||d||c||p||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||g||f||m||y||v||o||a||l||u||b||k||M||P||L||C||_||w||x||F||O||E||I||D,V=N,j={updateMapProviderConfig:s,updateViewport:A||e.routeCacheInMs!==t.routeCacheInMs||h||T||B||e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||d||c||p||g||R||e.isAnyContentProviderExists!==t.isAnyContentProviderExists||f||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||m||y||v||o||a||l||u||b||k||M||P||L||C||_||w||x||F||O||E||I||e.debugMarkersPosition!==t.debugMarkersPosition||D||N,updateMarkers:f||e.isAtLeastOneProductStatusUsingObfuscateMarker!==t.isAtLeastOneProductStatusUsingObfuscateMarker||e.isAtLeastOnePropertyStatusUsingObfuscateMarker!==t.isAtLeastOnePropertyStatusUsingObfuscateMarker||m||y||v||o||a||l||u||b||k||M||P||L||C||_||w||x||F||O||E||I||e.debugMarkersPosition!==t.debugMarkersPosition,updateKeyboardA11yUI:e.isKeyboardFeaturesDefined!==t.isKeyboardFeaturesDefined||e.isKeyboardFeaturesEnabled!==t.isKeyboardFeaturesEnabled||Ns(e.actionsOnMarkerClick,t.actionsOnMarkerClick)||Ns(e.keyNamesForMarkerKeyPressEvent,t.keyNamesForMarkerKeyPressEvent)||Ns(e.keyNamesForPopupKeyPressEvent,t.keyNamesForPopupKeyPressEvent)||Ns(e.keyboardFeaturesIcon,t.keyboardFeaturesIcon),updateStyling:Ns(e.styling,t.styling),resetRouteManagement:A||e.routeCacheInMs!==t.routeCacheInMs,resetPolygonManagement:S,resetClusterers:g||R,resetContentProviders:h||T,resetCollisionManagement:D,resetAvailabilityCheck:B,clearHashkeys:K,updateTiles:V};return Object.keys(j).filter((e=>!1===j[e])).forEach((e=>delete j[e])),j}function Ns(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ss(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})!==Ss(e)}function Ks(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ns(Vs(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Vs(e))}function Vs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new WeakSet;return Object.keys(e).forEach((r=>{const n=e[r];H(n)?t[r]=q(n):Is(n)?i.has(n)||(t[r]={},Vs(e[r],t[r],i)):t[r]=n})),t}const js={marker:"data:image/svg+xml,%3c!-- file: marker.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%23026dc5' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",markerHighlighted:"data:image/svg+xml,%3c!-- file: marker-hl.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32'%3e%3cpath fill='%2354a0dd' d='M16 2.667A9.326 9.326 0 006.667 12C6.667 19 16 29.333 16 29.333S25.333 19 25.333 12A9.326 9.326 0 0016 2.667zm0 12.666a3.334 3.334 0 010-6.666 3.334 3.334 0 010 6.666z'/%3e%3c/svg%3e",keyboardNavigationIcon:"data:image/svg+xml,%3c!-- file: keyboard.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='24'%3e%3cpath d='M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z'/%3e%3c/svg%3e",leftArrowIcon:"data:image/svg+xml,%3c!-- file: left-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M9.87.613Q9.55.96 8.08 2.523 6.612 4.085 4.983 5.82q-1.628 1.736-2.95 3.125L.735 10.335q-.343.322-.54.756-.195.434-.195.88 0 .447.196.881t.539.756l1.298 1.39q1.322 1.388 2.95 3.124l3.098 3.299q1.47 1.562 1.788 1.91.686.669 1.64.669.956 0 1.617-.67t.723-1.537q.06-.868-.723-1.761l-7.518-8.06 7.665-8.06q.784-.794.723-1.712-.062-.917-.723-1.587-.784-.67-1.75-.608-.968.062-1.654.608z'/%3e%3c/svg%3e",rightArrowIcon:"data:image/svg+xml,%3c!-- file: right-arrow.svg --%3e %3csvg xmlns='http://www.w3.org/2000/svg' height='24' width='14'%3e%3cpath d='M4.13 23.387q.32-.347 1.789-1.91 1.469-1.562 3.098-3.298 1.628-1.736 2.95-3.125l1.298-1.389q.343-.322.54-.756.195-.434.195-.88 0-.447-.196-.881t-.539-.756l-1.298-1.39q-1.322-1.388-2.95-3.124L5.919 2.579Q4.449 1.017 4.13.67 3.445 0 2.49 0 1.534 0 .873.67T.15 2.207q-.06.868.723 1.761l7.518 8.06-7.665 8.06q-.784.794-.723 1.712.062.917.723 1.587.784.67 1.75.608.968-.062 1.654-.608z'/%3e%3c/svg%3e"},zs=()=>{const e=new bi;return{mapProvider:"google-maps",map:{onMapDrag:["clearHighlight","clearSelection","closePopup","removeAriaLive"],onMapClick:["clearHighlight","clearSelection","closePopup","removeAriaLive"],mapInitWaitForTiles:!0},googleMaps:{padding:32,useAdvancedMarkers:!1,gmapsAddConfig:{zoom:2,minZoom:2,mapId:"57df04e09ffe3110",center:{lat:0,lng:0},gestureHandling:"greedy",clickableIcons:!1,disableDefaultUI:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,isFractionalZoomEnabled:!0},urls:{api:"https://maps.googleapis.com/maps/api/js?libraries=places,geometry,marker&version=3.57"},fitBoundsAnimTime:500,debouncingEventsTime:{centerChanged:50,zoomChanged:100}},mapbox:{accessToken:void 0,rtlTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js",padding:32,scaleControl:{ctrlEnabled:!1,ctrlOptions:{unit:"metric"},ctrlPosition:void 0},navControl:{ctrlEnabled:!0,ctrlOptions:{},ctrlPosition:void 0},geoLocateControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},fullscreenControl:{ctrlEnabled:!1,ctrlOptions:{},ctrlPosition:void 0},mapboxAddConf:{center:[0,0],zoom:1,fadeDuration:100,style:"mapbox://styles/expedia-geo/ckfgvpedb2neq19pe9u3zg69x"},urls:{api:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.js",css:"https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css",pluginUrls:["https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-language/v1.0.0/mapbox-gl-language.js"]}},markers:{common:{collisionBuffers:{low:16,medium:128,high:192}},product:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlightIfNotSelected"]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:["enter","space"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1,available:!0,filtered:!1,sold_out:!1,unknown:!1,"linked-features":!1},keepOutOfViewport:{default:!0},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:fr.defaultClusterProductLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:js.marker,hl:js.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}},actionOnClick:{default:[]},actionOnMouseOver:{default:[]},actionOnMouseOut:{default:[]}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},minZoom:{default:0},maxZoom:{default:22},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},minZoom:{default:0,restaurant:12},maxZoom:{default:22},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},property:{threshold:{default:200},maxZoomForCount:{default:15},minZoomForDisplay:{default:9},actionOnFeatureSelect:{default:["bounce","highlight","showRoutes","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","hideRoutes","removeAriaLive"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlightIfNotSelected"]},actionOnClick:{default:["select","highlight","showRoutes","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:["enter","space"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1,available:!0,filtered:!1,sold_out:!1,unknown:!1,"linked-features":!1},keepOutOfViewport:{default:!0},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:fr.defaultClusterPropertyLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6,available:5,filtered:4,sold_out:3},markerType:{default:"pin",available:"price",filtered:"pin"},icons:{default:js.marker,hl:js.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}},actionOnClick:{default:[]},actionOnMouseOver:{default:[]},actionOnMouseOut:{default:[]}},obfuscateMarkers:{precision:{default:100},style:{default:{line:{weight:1,color:"#616161",opacity:1},fill:{color:"#E6E6E6",opacity:.3}},hl:{line:{weight:1,color:"#1C598C",opacity:1},fill:{color:"#0E77CD",opacity:.5}}},radiusInM:{default:500}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},minZoom:{default:0},maxZoom:{default:22},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},minZoom:{default:0},maxZoom:{default:22},position:{default:"right"},maxLineLength:{default:-1},maxLines:{default:-1},dynamicPlacement:{default:!1}}},place:{threshold:{default:100},maxZoomForCount:{default:10},minZoomForDisplay:{default:11},actionOnFeatureSelect:{default:["bounce","highlight","addAriaLive"]},actionOnFeatureDeselect:{default:["dehighlight","removeAriaLive"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlightIfNotSelected"]},actionOnClick:{default:["select","highlight","addAriaLive"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:["enter","space"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},show:{default:!1},keepOutOfViewport:{default:!1},clustering:{default:{type:"none",minPoints:2,minZoom:0,maxZoom:15,labelKey:fr.defaultClusterPlaceLabel,superclusterSettings:{radius:105},excludedQualifiers:[]}},zIndex:{default:1,hl:6},markerType:{default:"pin"},icons:{default:js.marker,hl:js.markerHighlighted},cornerIcons:{topLeft:{default:"none"},topRight:{default:"none"},bottomLeft:{default:"none"},bottomRight:{default:"none"}},frameIcons:{default:"none"},innerIcons:{left:{default:"none"},right:{default:"none"}},popup:{position:{default:"above"},ensureVisibility:{default:!1},visibilityPadding:{default:{x:20,y:20}},actionOnClick:{default:[]},actionOnMouseOver:{default:[]},actionOnMouseOut:{default:[]}},textLabel:{show:{default:!1},subLabel:{show:{default:!1},minZoom:{default:0},maxZoom:{default:22},maxLineLength:{default:-1},maxLines:{default:-1}},zIndex:{default:"sameAsMarker"},minZoom:{default:0},maxZoom:{default:22},position:{default:"right"},maxLineLength:{default:20},maxLines:{default:3},dynamicPlacement:{default:!1}}},cluster:{actionOnClick:{default:["zoomToExtent"]},actionOnFeatureSelect:{default:["zoomToExtent"]},actionOnFeatureOver:{default:["highlight"]},actionOnFeatureOut:{default:["dehighlight"]},actionOnMouseOver:{default:["sendEvent"]},actionOnMouseOut:{default:["sendEvent"]},keyNameForKeyPressEvent:{default:["enter","space"]},tagCollidingMarkers:{default:!1},collisionBufferVariation:{default:"none"},clusterMarkerCollisionAvoidance:{moveCollidingClusterMarkers:{default:!1},clusterMarkerCollisionBufferInPixels:{default:5}},zIndex:{default:1,hl:6,unknown:2},textLabel:{show:{default:!1},zIndex:{default:"sameAsMarker"},minZoom:{default:0},maxZoom:{default:22},position:{default:"right"}}}},polygons:{product:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}},property:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}},place:{style:{default:{fill:{color:"#AA3333",opacity:.15},line:{weight:1,color:"#000000",opacity:1}}}}},tiles:{enabled:{product:[],property:[],place:[]},providers:{egPois:{type:"eg",tilesetId:"pois",url:"https://www.expedia.com/eg-tile-server",query:"",timeout:2e3}},minZoomForTileRequest:8,cache:{maxSize:-1,maxDistance:30}},contentProvider:{cacheInMs:18e5,product:{default:[]},property:{default:[]},place:{default:[]},providers:{}},historicalBoundingBoxDataEndpoint:"https://a.travel-assets.com/travel-assets-manager/df4af43c-2db9-4868-8665-96b7042a2c98/historical_bbox_data-min.json",availability:{availabilityProvider:"none",availabilityProviders:{}},locale:"en-US",iso4217CurrencyCode:"USD",routes:{egDistances:void 0,cacheInMs:18e5,style:{driving:{lineStyle:"normal",color:"#000000",width:1.5,opacity:.8},cycling:{lineStyle:"dash",color:"#000000",width:1.54,opacity:.8},walking:{lineStyle:"dot",color:"#000000",width:1.5,opacity:.8},flying:{lineStyle:"dash",color:"#000000",width:1.5,opacity:.8}}},a11y:{keyboardFeatures:{keyboardFeaturesIcon:js.keyboardNavigationIcon}},logging:{logger:e},style:{}}},{verifyKeyIsLegal:$s}=t;class Us{constructor(e,t){this.maxSize=e,this.maxDistance=t,this.cache={},this.listeners=new Set,this.size=0}getTile(e,t,i){return this.cache[i]&&this.cache[i][e]?this.cache[i][e][t]:void 0}setTile(e,t,i,r){const{cache:n}=this;n[i]||(n[i]={}),!n[i][e]&&$s(i)&&$s(e)&&(n[i][e]={}),!n[i][e][t]&&r?this.size=this.size+1:n[i][e][t]&&!r&&(this.size=this.size-1),$s(i)&&$s(e)&&$s(t)&&(n[i][e][t]=r),this.maxSize>0&&this.size>this.maxSize&&this._expire(e,t,i)}addTilesListener(e){this.listeners.add(e)}removeTilesListener(e){this.listeners.delete(e)}_expire(e,t,i){for(let r in this.cache)for(let n in this.cache[r])for(let s in this.cache[r][n])qi(e,t,i,n,s,r)>this.maxDistance&&(this.listeners.forEach((e=>e(Us.EVENTS.EXPIRE,Number(n),Number(s),Number(r),this.cache[r][n][s]))),delete this.cache[r][n][s],this.size=this.size-1)}}Us.EVENTS={EXPIRE:"expire"};class Zs{loadTile(e,t,i,r,n){return Promise.reject("not implemented")}}var Hs=i(496);class qs extends Zs{constructor(e,t){super(),this.codec=new Hs.EGTSCodec,this.logger=t("EgTilesReader"),this.tilesUrlPrefix=e.url,this.query=e.query,this.tilesetId=e.tilesetId,this.queryByZoom=e.queryByZoom,this.timeout=e.timeout||500}loadTile(e,t,i,r,n){const s=this.buildUrl(t,i,r,n);return this.fetchTile(s,e,t,i,r).then((e=>e.success?e.data.map((e=>this.removeColonFromQualifiers(e))):(this.logger.error(`Failed to load tile from ${e.url}: ${e.error.message}`,e.error.stack),[])))}removeColonFromQualifiers(e){var t;return e.qualifiers=null===(t=e.qualifiers)||void 0===t?void 0:t.map((e=>e.replace(":","__"))),e}buildUrl(e,t,i,r){const n=`/v1/tilesets/${this.tilesetId}/${i}/${e}/${t}/egmaps.pbf?locale=${r}`;let s=n;return this.queryByZoom&&this.queryByZoom[i]?s=`${n}&${this.queryByZoom[i]}`:this.query&&(s=`${n}&${this.query}`),s}fetchTile(e,t,i,r,n){return Ci(`${this.tilesUrlPrefix}${e}`,this.timeout,{referrerPolicy:"no-referrer",credentials:"omit"}).then((t=>t.ok?t.arrayBuffer():404===t.status?void 0:Promise.reject(new Error(`Server returns error code ${t.status} when calling ${e} for tile {x: ${i}, y: ${r}, zoom: ${n}}: \n              ${t.statusText}`)))).then((t=>this.handleResponse(t).then((t=>({url:e,success:!0,data:t}))))).catch((t=>({url:e,success:!1,error:t})))}handleResponse(e){return e?this.codec.decode(e):Promise.resolve([])}}class Ws{constructor(e,t,i,r,n,s,o){let{delayBeforeRefresh:a=100,delayForceRefresh:l=2e3}=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};this.logger=e.loggerFactory("TilesLoader"),this.delayBeforeRefresh=a,this.delayForceRefresh=l,this.refreshRequested=Date.now(),this.lastRefresh=this.refreshRequested,this.createFeature=t,this.deleteFeature=i,this.updateViewport=r,this.handleTilesLoaded=n,this.handleTilesContentLoaded=s,this.depth=o,this.tilesInFlight=new Set,this.instantiateTilesProvider(e)}instantiateTilesProvider(e){const{tilesReaderConfig:t,tilesProvidersConfig:i,tilesCacheConfig:r,minZoomForTileRequest:n}=e.tiles,{locale:s}=e;this.locale=s,this.tilesProvidersConfig={},Object.keys(t).forEach((r=>{t[r].forEach((t=>{if(!this.tilesProvidersConfig[t]){this.tilesProvidersConfig[t]={featureTypes:[]};const r=i[t];switch(r&&r.type||t){case"eg":this.tilesProvidersConfig[t].service=new qs(r,e.loggerFactory);break;case"noop":this.tilesProvidersConfig[t].service=new Zs;break;default:throw new Error(`Tiles provider ${t} not supported`)}}this.tilesProvidersConfig[t].featureTypes.push(r)}))})),this.minZoomForTileRequest=n,this.tilesCache=new Us(r.maxSize,r.maxDistance),this.tilesCache.addTilesListener(this.handleCacheEvent.bind(this))}getNormalizedCoord(e,t,i){const r=1<<i;let n=e;return t<0||t>=r?null:((n<0||n>=r)&&(n=(n%r+r)%r),{x:n,y:t})}registerRefreshViewport(){const e=Date.now();this.refreshRequested=e,setTimeout((()=>{const t=Date.now();(this.refreshRequested===e||this.lastRefresh+this.delayForceRefresh<t)&&(this.refreshRequested=t,this.lastRefresh=t,this.updateViewport())}),this.delayBeforeRefresh)}_getTileInFlightKey(e,t,i,r){return`${e},${t},${i},${r}`}_registerTileInFlight(e,t,i,r){this.tilesInFlight.add(this._getTileInFlightKey(e,t,i,r))}_removeTileInFlight(e,t,i,r){this.tilesInFlight.delete(this._getTileInFlightKey(e,t,i,r))}_areInFlightTilesDone(){return 0===this.tilesInFlight.size}_loadData(e,t,i,r,n,s,o){const a=Math.pow(2,o),l=n+o,u=i*a,h=r*a,d=[];for(let c=0;c<a;c++)for(let i=0;i<a;i++)d.push(e.loadTile(t,u+c,h+i,l,s));return Promise.all(d).then((e=>e.flat()))}loadTile(e,t,i){if(this.tilesProvidersConfig&&Object.keys(this.tilesProvidersConfig).length>0&&!isNaN(e)&&!isNaN(t)&&!isNaN(i)){const r=this.getNormalizedCoord(e,t,i);if(null!==r&&i>=this.minZoomForTileRequest&&!this.tilesCache.getTile(r.x,r.y,i)){this.tilesCache.setTile(r.x,r.y,i,[]);const n=[];for(let e in this.tilesProvidersConfig){const{service:t,featureTypes:s}=this.tilesProvidersConfig[e];this._registerTileInFlight(e,r.x,r.y,i);for(let o of s)n.push(this._loadData(t,o,r.x,r.y,i,this.locale,this.depth).then((t=>({data:t,tilesProvider:e,featureType:o}))))}return Promise.all(n).then((n=>{const s=[],o={};n.forEach((r=>{let{data:n,tilesProvider:a,featureType:l}=r;return n.forEach((r=>{r.tile=[e,t,i],s.push(this.createFeature(r)),o[a]?o[a].includes(l)||o[a].push(l):o[a]=[l]}))})),this.tilesCache.setTile(r.x,r.y,i,s);for(let e in this.tilesProvidersConfig)this._removeTileInFlight(e,r.x,r.y,i);this._areInFlightTilesDone()&&this.handleTilesContentLoaded(Object.keys(this.tilesProvidersConfig)),s.length>0&&(this.registerRefreshViewport(),Object.keys(o).forEach((e=>this.handleTilesLoaded(e,o[e].join(","),[`(${r.x}, ${r.y}, ${i})`]))))})).catch((()=>this.tilesCache.setTile(r.x,r.y,i,null)))}}return Promise.resolve()}handleCacheEvent(e,t,i,r,n){e===Us.EVENTS.EXPIRE&&(this.logger.infoEnabled()&&this.logger.info(`Cache expires. Deleting ${n.length} features`),n.forEach((e=>this.deleteFeature(e))))}}class Gs{constructor(e){this.configHelper=new Bs(zs(),e,mr),this.eventsManager=new ar(this.configHelper.logger("EventsManager")),this.dataRepositories=new yn(this.configHelper.logger("DataRepositories")),this.mapData=ws(),this.uniqId=Xt()}_initializeProperties(){this.logger=this.configHelper.logger("EGMap"),this.logger.debug("initializing EGMaps"),"mapbox"===this.configHelper.mapProvider()?this.mapImpl=this._createMapBox():this.mapImpl=this._createGMaps()}_createMapBox(){if(this.logger.debug("creating MapBox"),"undefined"!=typeof egmapsMapbox)return new egmapsMapbox.MapBox(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/mapbox' to use this map provider")}_createGMaps(){if(this.logger.debug("creating GMaps"),"undefined"!=typeof egmapsGoogleMaps)return new egmapsGoogleMaps.GMaps(this.configHelper,this.eventsManager,this.dataRepositories,this.mapData);throw new Error("You need to load '@eg-maps/google-maps' to use this map provider")}initMap(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return this.configHelper.ready().then((()=>this._initMap(e,t,i,r))).then((()=>{}))}_cleanPreviousMapContainer(e,t){const i=ne(e,["egmaps"]);return i.length>0?(t||this.logger.warn("This container contains some other instance of eg-maps.In order to avoid unexpected behavior the container will be cleaned."),i.forEach((e=>pe(e.element))),i[0].index):-1}_createMapContainer(e,t,i){let r=this.uniqId;null!=e&&e.id&&(r=`${e.id}-${r}`);const n=me(r,void 0,"egmaps",void 0,i);t>=0?bt(n,e,t):e.appendChild(n);const s=this.configHelper.readParam("additionalCssClass");return s&&rt(n,s),rt(n,this.configHelper.mapProvider()),n}updateConfiguration(e){var t;const i=this.configHelper,r=i.getConfigurations(),n=null===(t=r.parameter)||void 0===t?void 0:t.externalConfigEndpoint,s=e.externalConfigEndpoint&&e.externalConfigEndpoint===n?r.external:void 0,o=new Bs(zs(),e,mr,s);return o.ready().then((()=>{const e=i.loadMapSettings(),t=o.loadMapSettings(),r=Rs(e,t);if(Object.keys(r).filter((e=>r[e])).length>0){if(this.configHelper=o,this.mapImpl.updateConfigHelperOnFeatures(this.configHelper),r.reinstantiate){const e=this.mapImpl.getBounds(),t=this.mapImpl.listRegisteredRoutes();return this.mapImpl.clearHashkeys(),this.mapImpl.clearMarkers(),this._initMap(this.originalNode,!0,e,void 0).then((e=>e.refresh())).then((()=>(this.mapImpl.syncRegisteredRoutes(t),this.mapImpl.updateRoutesOnViewport()))).then((()=>r))}return this.mapImpl.updateConfiguration(this.configHelper,t,r).then((()=>r))}return{}}))}_initMap(e,t,i,r){this._initializeProperties();const n=this._cleanPreviousMapContainer(e,t),s=`style-${this.uniqId}`;return this.originalNode=e,this.node=this._createMapContainer(e,n,s),this.clientPadding=r,this.mapImpl.initMap(this.node,s,i,this.clientPadding).then((()=>this.mapImpl))}centerAndZoomMap(e,t,i){var r;return!0===(null===(r=this.mapImpl)||void 0===r?void 0:r.centerAndZoomMap(e,t,i))}getCenter(){if(this.mapImpl)return this.mapImpl.getCenter();throw new Error("map is not initialized")}getZoom(){if(this.mapImpl)return this.mapImpl.getZoom();throw new Error("map is not initialized")}getBounds(){if(this.mapImpl)return this.mapImpl.getBounds();throw new Error("map is not initialized")}unbindAll(){this.mapImpl&&this.mapImpl.unbindAll(),pe(this.node)}fitLatLongs(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;return this.mapImpl?this.mapImpl.fitLatLongs(e,t,i):Promise.reject(new Error("map is not initialized"))}fitBounds(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return this.mapImpl?this.mapImpl.fitBounds(e,t,i,r):Promise.reject(new Error("map is not initialized"))}boundsContaining(e,t,i){return this.mapImpl?this.mapImpl.boundsContaining(e,t,i):Promise.reject(new Error("map is not initialized"))}boundsContainingPolygon(e){return this.mapImpl?this.mapImpl.boundsContainingPolygon(e):Promise.reject(new Error("map is not initialized"))}pushFeatureData(e,t){if(this.mapImpl)return this.mapImpl.pushFeatureData(e,t,!1);throw new Error("map is not initialized")}removePushedFeatureData(e){if(this.mapImpl)return this.mapImpl.removePushedFeatureData(e,!1);throw new Error("map is not initialized")}registerRoute(e,t,i){if(this.mapImpl)return this.mapImpl.registerRoute(e,t,i);throw new Error("map is not initialized")}registerRouteDestination(){if(this.mapImpl)return this.mapImpl.registerRouteDestination(...arguments);throw new Error("map is not initialized")}listRegisteredRouteDestinations(){if(this.mapImpl)return this.mapImpl.listRegisteredRouteDestinations();throw new Error("map is not initialized")}listRegisteredRoutes(e){if(this.mapImpl)return this.mapImpl.listRegisteredRoutes(e);throw new Error("map is not initialized")}deregisterRouteDestination(){if(this.mapImpl)return this.mapImpl.deregisterRouteDestination(...arguments);throw new Error("map is not initialized")}deregisterRoute(e,t){if(this.mapImpl)return this.mapImpl.deregisterRoute(e,t);throw new Error("map is not initialized")}showRoutes(e,t){if(this.mapImpl){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return this.mapImpl.showRoutes(e,t,...r)}return Promise.reject(new Error("map is not initialized"))}hideRoutes(e,t){if(this.mapImpl){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return this.mapImpl.hideRoutes(e,t,...r)}return Promise.reject(new Error("map is not initialized"))}listRoutesDisplayed(){if(this.mapImpl)return this.mapImpl.listRoutesDisplayed();throw new Error("map is not initialized")}showPolygons(){return this.mapImpl?this.mapImpl.showPolygons(...arguments):Promise.reject(new Error("map is not initialized"))}hidePolygons(){return this.mapImpl?this.mapImpl.hidePolygons(...arguments):Promise.reject(new Error("map is not initialized"))}listPolygonsDisplayed(){if(this.mapImpl)return this.mapImpl.listPolygonsDisplayed();throw new Error("map is not initialized")}listFeatures(e,t){if(this.mapImpl)return this.mapImpl.listFeatures(e,t);throw new Error("map is not initialized")}selectFeature(e,t,i){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.selectFeature(e,t,i)}clearSelectedFeature(){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.clearSelectedFeature()}dehighlightFeatures(){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.dehighlightFeatures()}listHighlightedFeatures(){if(this.mapImpl)return this.mapImpl.listHighlightedFeatures();throw new Error("map is not initialized")}markFeatureOver(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.markFeatureOver(e,t)}markFeatureOut(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.markFeatureOut(e,t)}getFeatureSelected(){if(this.mapImpl)return this.mapImpl.getFeatureSelected();throw new Error("map is not initialized")}setPopupContent(e,t,i){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.setPopupContent(e,t,i)}turnProductsVisible(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("product",e,t,i,r)}turnPropertiesVisible(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("property",e,t,i,r)}turnPlacesVisible(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnFeaturesVisible("place",e,t,i,r)}addBoundChangeListener(e,t){return this.eventsManager.addBoundChangeListener(e,t)}removeBoundChangeListener(e){return this.eventsManager.removeBoundChangeListener(e)}deregisterBoundChangeListener(e){return this.eventsManager.deregisterBoundChangeListener(e)}addMarkerChangeListener(e,t){return this.eventsManager.addMarkerChangeListener(e,t)}removeMarkerChangeListener(e){return this.eventsManager.removeMarkerChangeListener(e)}deregisterMarkerChangeListener(e){return this.eventsManager.deregisterMarkerChangeListener(e)}addSelectionChangeListener(e,t){return this.eventsManager.addSelectionChangeListener(e,t)}removeSelectionChangeListener(e){return this.eventsManager.removeSelectionChangeListener(e)}deregisterSelectionChangeListener(e){return this.eventsManager.deregisterSelectionChangeListener(e)}addKeyPressListener(e,t){return this.eventsManager.addKeyPressListener(e,t)}removeKeyPressListener(e){return this.eventsManager.removeKeyPressListener(e)}deregisterKeyPressListener(e){return this.eventsManager.deregisterKeyPressListener(e)}addHoverChangeListener(e,t){return this.eventsManager.addHoverChangeListener(e,t)}removeHoverChangeListener(e){return this.eventsManager.removeHoverChangeListener(e)}deregisterHoverChangeListener(e){return this.eventsManager.deregisterHoverChangeListener(e)}addFeatureContentLoadedListener(e,t){return this.eventsManager.addFeatureContentLoadedListener(e,t)}removeFeatureContentLoadedListener(e){return this.eventsManager.removeFeatureContentLoadedListener(e)}deregisterFeatureContentLoadedListener(e){return this.eventsManager.deregisterFeatureContentLoadedListener(e)}addIdleListener(e,t){return this.eventsManager.addIdleListener(e,t)}removeIdleListener(e){return this.eventsManager.removeIdleListener(e)}deregisterIdleListener(e){return this.eventsManager.deregisterIdleListener(e)}addRouteChangeListener(e,t){return this.eventsManager.addRouteChangeListener(e,t)}removeRouteChangeListener(e){return this.eventsManager.removeRouteChangeListener(e)}deregisterRouteChangeListener(e){return this.eventsManager.deregisterRouteChangeListener(e)}addTilesLoadedListener(e,t){return this.eventsManager.addTilesLoadedListener(e,t)}removeTilesLoadedListener(e){return this.eventsManager.removeTilesLoadedListener(e)}deregisterTilesLoadedListener(e){return this.eventsManager.deregisterTilesLoadedListener(e)}addTilesContentLoadedListener(e,t){return this.eventsManager.addTilesContentLoadedListener(e,t)}removeTilesContentLoadedListener(e){return this.eventsManager.removeTilesContentLoadedListener(e)}deregisterTilesContentLoadedListener(e){return this.eventsManager.deregisterTilesContentLoadedListener(e)}addMapTypeChangedListener(e,t){return this.eventsManager.addMapTypeChangedListener(e,t)}deregisterMapTypeChangedListener(e){return this.eventsManager.deregisterMapTypeChangedListener(e)}addMapClickListener(e,t){return this.eventsManager.addMapClickListener(e,t)}deregisterMapClickListener(e){return this.eventsManager.deregisterMapClickListener(e)}setStay(e){if(this.mapImpl)return this.mapImpl.setStay(e);throw new Error("map is not initialized")}refresh(){return this.mapImpl?this.mapImpl.refresh():Promise.resolve()}turnKeyboardFeaturesMode(e){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.turnKeyboardFeaturesMode(e)}isKeyboardFeaturesModeEnabled(){if(this.mapImpl)return this.mapImpl.isKeyboardFeaturesModeEnabled();throw new Error("map is not initialized")}getActiveTilesets(){if(this.mapImpl)return this.configHelper.getActiveTilesets();throw new Error("map is not initialized")}readConfigParam(e){return this.configHelper.readParam(e)}getSubConfig(e){return this.configHelper.subConfig(e)}getConfigurations(){return this.configHelper.getEGMapConfigurations()}updatePartiallyFeature(e){if(this.mapImpl)return this.mapImpl.updatePartiallyFeature(e);throw new Error("map is not initialized")}addQualifierToFeature(e,t){if(this.mapImpl){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return this.mapImpl.addQualifierToFeature(e,t,...r)}throw new Error("map is not initialized")}addQualifierToFeatures(e){if(this.mapImpl){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return this.mapImpl.addQualifierToFeatures(e,...i)}throw new Error("map is not initialized")}removeQualifierFromFeature(e,t){if(this.mapImpl){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];return this.mapImpl.removeQualifierFromFeature(e,t,...r)}throw new Error("map is not initialized")}removeQualifierFromFeatures(e){if(this.mapImpl){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return this.mapImpl.removeQualifierFromFeatures(e,...i)}throw new Error("map is not initialized")}bounceMarker(e,t){if(!this.mapImpl)throw new Error("map is not initialized");this.mapImpl.bounceMarker(e,t)}forceMapModeView(){this.mapImpl&&this.mapImpl.forceMapModeView()}}}(),r}()},6559:function(e,t,i){var r;window,e.exports=(r=i(39437),function(){var e={518:function(e){e.exports=r}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,i),s.exports}i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};i.r(n),i.d(n,{GMaps:function(){return z}});var s,o=i(518),a=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return this.None(e)},Out:function(e){return this.None(e)},InOut:function(e){return this.None(e)}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(e){var t=1.70158;return 1===e?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return 0===e?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-a.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*a.Bounce.In(2*e):.5*a.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),l=function(){return performance.now()},u=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=l()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var n=this._tweens[i[r]],s=!t;n&&!1===n.update(e,s)&&!t&&delete this._tweens[i[r]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),h={Linear:function(e,t){var i=e.length-1,r=i*t,n=Math.floor(r),s=h.Utils.Linear;return t<0?s(e[0],e[1],r):t>1?s(e[i],e[i-1],i-r):s(e[n],e[n+1>i?i:n+1],r-n)},Bezier:function(e,t){for(var i=0,r=e.length-1,n=Math.pow,s=h.Utils.Bernstein,o=0;o<=r;o++)i+=n(1-t,r-o)*n(t,o)*e[o]*s(r,o);return i},CatmullRom:function(e,t){var i=e.length-1,r=i*t,n=Math.floor(r),s=h.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(n=Math.floor(r=i*(1+t))),s(e[(n-1+i)%i],e[n],e[(n+1)%i],e[(n+2)%i],r-n)):t<0?e[0]-(s(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[i]-(s(e[i],e[i],e[i-1],e[i-1],r-i)-e[i]):s(e[n?n-1:0],e[n],e[i<n+1?i:n+1],e[i<n+2?i:n+2],r-n)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=h.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:(s=[1],function(e){var t=1;if(s[e])return s[e];for(var i=e;i>1;i--)t*=i;return s[e]=t,t}),CatmullRom:function(e,t,i,r,n){var s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}}},d=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),c=new u,p=function(){function e(e,t){void 0===t&&(t=c),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=a.Linear.None,this._interpolationFunction=h.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=d.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=l()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var n in this._valuesEnd)r[n]=this._valuesEnd[n];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,i,r,n){for(var s in i){var o=e[s],a=Array.isArray(o),l=a?"array":typeof o,u=!a&&Array.isArray(i[s]);if("undefined"!==l&&"function"!==l){if(u){if(0===(m=i[s]).length)continue;for(var h=[o],d=0,c=m.length;d<c;d+=1){var p=this._handleRelativeValue(o,m[d]);if(isNaN(p)){u=!1,console.warn("Found invalid interpolation list. Skipping.");break}h.push(p)}u&&(i[s]=h)}if("object"!==l&&!a||!o||u)(void 0===t[s]||n)&&(t[s]=o),a||(t[s]*=1),r[s]=u?i[s].slice().reverse():t[s]||0;else{t[s]=a?[]:{};var g=o;for(var f in g)t[s][f]=g[f];r[s]=a?[]:{};var m=i[s];if(!this._isDynamic){var y={};for(var f in m)y[f]=m[f];i[s]=m=y}this._setupProperties(g,t[s],m,r[s],n)}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=l()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=l()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return void 0===e&&(e=c),this._group=e,this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=a.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=h.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){var i,r,n=this;if(void 0===e&&(e=l()),void 0===t&&(t=!0),this._isPaused)return!0;var s=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>s)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+(null!==(i=this._repeatDelayTime)&&void 0!==i?i:this._delayTime),u=this._duration+this._repeat*a,h=function(){if(0===n._duration)return 1;if(o>u)return 1;var e=Math.trunc(o/a),t=o-e*a,i=Math.min(t/n._duration,1);return 0===i&&o===n._duration?1:i}(),d=this._easingFunction(h);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,d),this._onUpdateCallback&&this._onUpdateCallback(this._object,h),0===this._duration||o>=this._duration){if(this._repeat>0){var c=Math.min(Math.trunc((o-this._duration)/a)+1,this._repeat);for(r in isFinite(this._repeat)&&(this._repeat-=c),this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[r]||(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*c,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,g=this._chainedTweens.length;p<g;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,i,r){for(var n in i)if(void 0!==t[n]){var s=t[n]||0,o=i[n],a=Array.isArray(e[n]),l=Array.isArray(o);!a&&l?e[n]=this._interpolationFunction(o,r):"object"==typeof o&&o?this._updateProperties(e[n],s,o,r):"number"==typeof(o=this._handleRelativeValue(s,o))&&(e[n]=s+(o-s)*r)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),g=(d.nextId,c),f=(g.getAll.bind(g),g.removeAll.bind(g),g.add.bind(g),g.remove.bind(g),g.update.bind(g));const{firstDefinedValue:m,firstDefinedValueAndKey:y,firstDefinedKey:v}=o.Utils,{removeDuplicates:b,roundLatOrLng:k,roundLatLng:M,isArray:P,getPaddedZoomAndCenter:L,roundZoom:C}=o.Utils,{computeZoomFromBBox:_,addMeterToLat:w,convertGeoJsonPolygonToPath:x}=o.Geo,{createPinMarker:F,createTextMarker:O,createClusterMarker:E,createObfuscatedMarker:I,events:S,finalizeMarkerCreation:D,cleanMarkerListeners:A,setMarkerZIndex:T,registerCompListeners:B,switchHtmlAriaLabel:R}=o.MarkerUtils,N=256,K=256;class V extends o.TilesLoader{constructor(e,t,i,r,n,s){super(e,t,i,r,n,s,0),this.tileSize=new google.maps.Size(N,K),this.debugTileId=e.tiles.debugTileId}getTile(e,t,i){if(setTimeout((()=>this.loadTile(e.x,e.y,t)),10),this.debugTileId){const t=i.createElement("div");return t.innerHTML=String(e),t.style.width=this.tileSize.width+"px",t.style.height=this.tileSize.height+"px",t.style.fontSize="10",t.style.borderStyle="solid",t.style.borderWidth="1px",t.style.borderColor="#AAAAAA",t}}unbindAll(){this.getPanes().overlayMouseTarget.removeAllChildren()}}const j={mapDragStart:"dragstart",mapDragEnd:"dragend",mapCenterChanged:"center_changed",mapBoundsChanged:"bounds_changed",mapZoomChanged:"zoom_changed",tilesLoaded:"tilesloaded",idle:"idle",mapTypeIdChanged:"maptypeid_changed"};class z extends o.BaseMap{constructor(e,t,i,r){super(e,t,i,r),this.useAdvancedMarkers=(0,o.defaultConfig)().googleMaps.useAdvancedMarkers,this.logger=e.logger("GMaps"),this.logger.debug("GMaps constructor"),this.mapFocusListenersToRegister=[],this.visiblePolygonsByKey=new Map,this.realmap=void 0,this.keyboardListeners=void 0}_buildMapProviderOptions(e,t){var i;const r={keyboardShortcuts:!1},n=null===(i=this.settings.googleMaps)||void 0===i?void 0:i.gmapsAddConfig;return n&&Object.assign(r,n),e&&t&&(r.zoom=e,r.center={lat:t[0],lng:t[1]}),r}updateMapProviderConfig(){const e=this._buildMapProviderOptions(this.realmap.getZoom(),this.getCenter());this.realmap.setOptions(e)}deleteMarker(e){const t=e.marker;t&&(t.advancedMarker?t.setMap(null):o.HtmlUtils.detachElement(t),t.debug&&t.debug.setMap(null),this._clearObfuscateArea(t),A(t),delete e.marker)}_callbackWhenElementReattached(){const e=this;return new Promise((t=>{setTimeout((()=>{const{temporaryDiv:i}=e;e.temporaryDiv=void 0,e._reattachElementFromTemporaryDiv(i,e.customMarkerOverlay.getPanes().overlayMouseTarget),e._updateViewport(),t()}),20)}))}isUsingAdvancedMarker(){return this.useAdvancedMarkers}_isAdvancedMarkerApiLoaded(){var e;return void 0!==(null===(e=google)||void 0===e||null===(e=e.maps)||void 0===e||null===(e=e.marker)||void 0===e?void 0:e.AdvancedMarkerElement)}_shouldUseAdvancedMarker(){const{debugShouldUseAdvancedMarkers:e,useAdvancedMarkers:t}=this.settings.googleMaps,i=e||t,r=Boolean(i&&this._isAdvancedMarkerApiLoaded()&&this.realmap.getMapCapabilities().isAdvancedMarkersAvailable);return this.logger.debug("Using "+(r?"Google-maps advanced markers":"HTML markers on Custom layout")),i&&!r&&this.logger.debug("Advanced markers not available and cannot be used"),r}init(e,t){var i;if(void 0===this.node)return Promise.reject(new Error("Map container element not defined"));if(void 0===(null===(i=o.HtmlUtils.globalObject().google)||void 0===i||null===(i=i.maps)||void 0===i?void 0:i.Map))return Promise.reject(new Error("Google Maps API not loaded"));const r=this.addEventListener.bind(this),{zoom:n,center:s}=this._zoomAndCenterFromViewport(e,t)||{},a=this._buildMapProviderOptions(n,s);this.node&&(this.realmap=new google.maps.Map(this.node,a),this.useAdvancedMarkers=this._shouldUseAdvancedMarker()),this._initializeTilesOverlayMapType(),o.HtmlUtils.documentIsDefined()&&(this.temporaryDiv=o.HtmlUtils.createDiv(this.uniqId("temporaryDiv")),this.clonesDivForMeasure=o.HtmlUtils.createDiv(this.uniqId("clonesDiv"),document.body,void 0,"position: absolute; top: -9999px; left: -9999px"));const l=this._createPopup.bind(this),u=this._registerKeyboardListeners.bind(this),h=this._registerListenersMap.bind(this),d=this._registerMapFocusListeners.bind(this),c=this._registerTilesLoadedListener.bind(this),p=this._updateViewport.bind(this);return this._initializeCustomMarkerOverlay(this.temporaryDiv,this._callbackWhenElementReattached.bind(this)).then((()=>{this.mapNavFocusElement=this._findMapFocusElement(),this.mapNavFocusElement&&(o.HtmlUtils.setTabIndex(this.mapNavFocusElement,0),this.mapFocusListenersToRegister.forEach((e=>{let{eventName:t,cb:i}=e;this.listenersToDeregister.push(r(this.mapNavFocusElement,t,i))}))),this.popup=l(),u(),h(),d(),c(),p()})),this.configHelper.readParam("map,mapInitWaitForTiles")?new Promise((e=>r(this.realmap,j.tilesLoaded,e,!0))):Promise.resolve()}_findMapFocusElement(){if(this.node)return o.HtmlUtils.childrenAsArray(this.node).map((e=>o.HtmlUtils.getFirstChildWithAriaRoleDescription(e,"map",!0))).filter((e=>void 0!==e))[0]}registerListenerOnMapFocusElement(e,t){this.mapNavFocusElement?this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t)):this.mapFocusListenersToRegister.push({eventName:e,cb:t})}_registerMapFocusListeners(){if(this.keyboardFeatures&&this.mapNavFocusElement){const e=()=>this.keyboardFeatures.refreshKeyboardNavIconVisibility();this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,S.focus,e));const t=()=>this.keyboardFeatures.refreshKeyboardNavIconVisibility(!1);this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,S.focusOut,t))}}_registerTilesLoadedListener(){this.listenersToDeregister.push(this.addEventListener(this.realmap,j.tilesLoaded,(()=>this.handleTilesLoaded("mapProvider","map"))))}_initializeTilesOverlayMapType(){var e;this.tilesLoader=new V(this.settings,this.createTileFeature.bind(this),this.removeTileFeature.bind(this),this._updateViewport.bind(this),this.handleTilesLoaded.bind(this),this.handleTilesContentLoaded.bind(this)),null===(e=this.realmap)||void 0===e||null===(e=e.overlayMapTypes)||void 0===e||e.insertAt(0,this.tilesLoader)}_reattachElementFromTemporaryDiv(e,t){if(e){const{children:i}=e;for(let e=0;e<((null==i?void 0:i.length)||-1);e++)o.HtmlUtils.reattachElement(i[e],t)}}_initializeCustomMarkerOverlay(e,t){const i=function(i,r,n,s,a){this.onAdd=function(){const{overlayMouseTarget:i}=this.getPanes();s(e),o.HtmlUtils.setZIndex(i,google.maps.Marker.MAX_ZINDEX+1),t(),a()},this.setMap(i),this.onRemove=function(){n().forEach((e=>{o.HtmlUtils.detachElement(e.popup)}));for(let e of this.clusters)o.HtmlUtils.detachElement(e.marker)},this.draw=function(){r()}};return i.prototype=new google.maps.OverlayView,new Promise((e=>{this.customMarkerOverlay=new i(this.realmap,this._updateMarkersPositionOnLayer.bind(this),this.features.all.bind(this),this._reattachElementFromTemporaryDiv.bind(this),e)}))}getMarkerElement(e){const t=e.marker;return null!=t&&t.advancedMarker?t.content:t}moveMarkerPosition(e,t){const i=this.customMarkerOverlay.getProjection(),r=i.fromLatLngToDivPixel(new google.maps.LatLng(e.latLng[0],e.latLng[1])),n={x:r.x+t.x,y:r.y+t.y},s=i.fromDivPixelToLatLng(n);e.latLng[0]=s.lat(),e.latLng[1]=s.lng(),e.computedLatLng=[s.lat(),s.lng()],e.marker&&(e.marker.position=s),this._updateMarkerPositionOnLayer(e,i)}_updateViewport(e){var t;return null!==(t=this.customMarkerOverlay)&&void 0!==t&&null!==(t=t.getPanes())&&void 0!==t&&t.overlayMouseTarget?super._updateViewport(e).then((e=>(this._updateMarkersPositionOnLayer(),e))):Promise.resolve(e)}getRectOfMarker(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=this.customMarkerOverlay.getProjection(),r=e.computedLatLng&&e.computedLatLng[0]?e.computedLatLng[0]:e.latLng[0],n=e.computedLatLng&&e.computedLatLng[1]?e.computedLatLng[1]:e.latLng[1],s=i.fromLatLngToDivPixel(new google.maps.LatLng(r,n)),{width:a,height:l}=this._getMarkerDimensionsOnScreen(e);return o.HtmlUtils.getRect(s,a+2*t,l+2*t)}_getMarkerDimensionsOnScreen(e){const t=e.marker;if(t.dimensions)return t.dimensions;{const i=this.getMarkerElement(e),{clientWidth:r,clientHeight:n}=i;let s={width:r,height:n};if(0===r||0===n){const{width:e,height:t}=this.measureWidthAndHeight(i);s={width:e,height:t}}return 0===s.width&&0===s.height||(t.dimensions=s),s}}measureWidthAndHeight(e){const t=e.cloneNode(!0);t.style.visibility="hidden",t.style.position="absolute",this.temporaryDiv,this.clonesDivForMeasure.appendChild(t);const{clientWidth:i,clientHeight:r}=t;return this.clonesDivForMeasure.removeChild(t),{width:i,height:r}}_updateMarkersPositionOnLayer(e){if(this.customMarkerOverlay){const{isAtLeastOnePropertyStatusUsingObfuscateMarker:t,isAtLeastOneProductStatusUsingObfuscateMarker:i,obfuscateRadiusInMeters:r}=this.settings,n=this.customMarkerOverlay.getProjection();if(n){const s=e?e.filter((e=>e.marker)):this.features.all().filter((e=>e.marker)).concat(this.clusters||[]);if(t||i){const e=this.getCenter();Object.values(r).forEach((t=>{const i=[k(w(e[0],2*t.radius)),e[1]];t.width=Math.round(this._fromLatLngToDivPixel(n,...e).y-this._fromLatLngToDivPixel(n,...i).y)}))}s.forEach((e=>this._updateMarkerPositionOnLayer(e,n))),this._updateMarkerPositionFromCollision(),this.updatePopupPositionOnLayer()}}}_updateMarkerPositionOnLayer(e,t){if(!(null==e?void 0:e.marker).advancedMarker){const i=this.getMarkerElement(e);if(t){const r=t.fromLatLngToDivPixel(e.marker.position);if(r){const e=0,t=0,n="bottom";o.HtmlUtils.setPosition(i,r.x+e,r.y+t,n)}}}}_fromLatLngToDivPixel(e,t,i){return null==e?void 0:e.fromLatLngToDivPixel(new google.maps.LatLng(t,i))}_fromDivPixelToLatLng(e,t,i){return null==e?void 0:e.fromDivPixelToLatLng(new google.maps.Point(t,i))}updatePopupPositionOnLayer(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;const{feature:i}=this.popup||{};if(null!==(e=this.customMarkerOverlay)&&void 0!==e&&e.getProjection()&&i&&i.defined){const{popupPositions:e}=this.settings,r=this._fromLatLngToDivPixel(this.customMarkerOverlay.getProjection(),...i.latLng);let n,s,a;switch(m(e[i.type],i.hashKeys)){case"above":default:n=0,s=-2,a="bottom";break;case"below":n=0,s=2,a="top"}r&&(t>0?setTimeout((()=>{o.HtmlUtils.setPosition(this.popup,r.x+n,r.y+s,a)}),20):o.HtmlUtils.setPosition(this.popup,r.x+n,r.y+s,a))}}ensurePopupVisibility(){const{popup:{feature:e,offsetWidth:t,offsetHeight:i},node:{offsetWidth:r,offsetHeight:n}}=this,s=m(this.configHelper.popupVisibilityPaddings()[e.type],e.hashKeys),o=null==s?void 0:s.x,a=null==s?void 0:s.y,{popupPositions:l}=this.settings,u="below"===m(l[e.type],e.hashKeys),h=u?1:-1,d=this.getRectOfMarker(e).height,c=this._fromLatLngToDivPixel(this.customMarkerOverlay.getProjection(),...e.latLng);let p={x:c.x+r/2-t/2,y:c.y+d*h+n/2+i*h};const[g,f]=this._calculatePopupVisibilityOffsetValues(p,o,a,r,n,t,i,u);0===g&&0===f||this.realmap.panBy(g,f)}_handleMapClick(e){var t;const i=null===(t=this.customMarkerOverlay)||void 0===t?void 0:t.getProjection(),r={position:{x:e.screenX,y:e.screenY}};if(i){const t=i.fromContainerPixelToLatLng(new google.maps.Point(e.offsetX,e.offsetY));r.latLng={lat:t.lat(),lng:t.lng()}}this.handleMapClick(r)}_registerListenersMap(){this.lastCenterChecked={centers:[this.getCenter()],events:[]},this.lastZoomValueChecked=[this.getZoom()],this.listenersToDeregister.push(...this._registerListenerForIdle()),this.listenersToDeregister.push(this._registerDragEndEventLogic()),this.listenersToDeregister.push(...this._registerZoomListener()),this.listenersToDeregister.push(...this._registerCenterChangedEventLogic()),this.listenersToDeregister.push(this.addEventListener(this.realmap,j.mapDragStart,this.handleDragStart.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.node,S.mapClick,this._handleMapClick.bind(this))),this.listenersToDeregister.push(this.addEventListener(this.realmap,j.mapTypeIdChanged,(()=>{this.eventsManager.pushEvent(o.EventTypes.mapTypeChanged,{mapTypeId:this.realmap.getMapTypeId()})}).bind(this)))}_registerListenerForIdle(){this.idle=!0;const e=this;return[this.addEventListener(this.realmap,j.idle,(()=>{e.idle=!0,e.eventsManager.pushEvent(o.EventTypes.idle)})),this.addEventListener(this.realmap,j.mapBoundsChanged,(()=>e.idle=!1))]}_registerKeyboardListeners(){const e=this.getZoom.bind(this);this.keyboardListeners=new o.KeyboardListeners((e=>this.realmap.panBy(...e)),(()=>this.realmap.setZoom(e()+1)),(()=>this.realmap.setZoom(e()-1))),this.registerListenerOnMapFocusElement(S.keyDown,this.keyboardListeners.keyDownListenerCallback),this.registerListenerOnMapFocusElement(S.keyUp,this.keyboardListeners.keyUpListenerCallback),this.registerListenerOnMapFocusElement(S.keyPress,this.keyboardListeners.keyPressListenerCallback)}_registerDragEndEventLogic(){return this.addEventListener(this.realmap,j.mapDragEnd,(()=>{this.lastCenterChecked.events.push("drag")}))}_registerCenterChangedEventLogic(){const{debouncingEventsTime:e}=this.settings.googleMaps,t=e.centerChanged;return[this.addEventListener(this.realmap,j.mapCenterChanged,(()=>{this.boundChangedDisabled?this.lastCenterChecked.centers=[this.getCenter()]:this.lastCenterChecked.centers[1]=this.getCenter()})),this.addEventListener(this.realmap,j.idle,(()=>{if(this.lastCenterChecked.centers.length>1){const[e,i]=this.getCenter(),r=this.handleBoundsChanged.bind(this);setTimeout((()=>{const t=this.getCenter(),[n,s]=t;if(n===e&&s===i){this.lastCenterChecked.centers=[t];const e=this.lastCenterChecked.events.splice(0,this.lastCenterChecked.events.length),i=this.keyboardListeners.extractKeyboardEvent("center_changed");b(i).forEach(r),b(e).forEach(r)}}),t)}}))]}_registerZoomListener(){const{debouncingEventsTime:e}=this.settings.googleMaps,t=e.zoomChanged;return[this.addEventListener(this.realmap,j.mapZoomChanged,(()=>{this.boundChangedDisabled?this.lastZoomValueChecked=[this.getZoom()]:this.lastZoomValueChecked[1]=this.getZoom()})),this.addEventListener(this.realmap,j.idle,(()=>{if(this.lastZoomValueChecked.length>1){const e=this.getZoom(),i=this.handleBoundsChanged.bind(this);setTimeout((()=>{const t=this.getZoom();if(t===e){const[e]=this.lastZoomValueChecked,r=t>e;this.lastZoomValueChecked=[t];const n=this.keyboardListeners.extractKeyboardEvent("zoom_changed");n.length>0?b(n).forEach(i):r?this.handleBoundsChanged("zoomIn"):this.handleBoundsChanged("zoomOut")}}),t)}}))]}_createCallbackForBoundsChanged(e){const t=this.handleBoundsChanged.bind(this);return()=>t(e)}centerAndZoomMap(e,t,i){let[r,n]=e?M(e):[],s=t?C(t):void 0;if(void 0!==r&&void 0!==n&&void 0!==s&&void 0!==i){const t=this._parseClientPadding(i),{zoom:o,center:a}=this._getPaddedZoomAndCenterForCenterAndZoom(e,s,t)||{};void 0!==o&&void 0!==a&&([r,n]=a,s=o)}const o=this.realmap.getCenter(),[a,l]=M([o.lat(),o.lng()])||[];let u=void 0!==r&&void 0!==n&&(a!==r||l!==n)||void 0!==s&&this.getZoom()!==s;return u&&this._fitViewport(s,[r,n],!1).then(this._updateViewport.bind(this)),u}isFeatureInRealBound(e,t){return null==e?void 0:e.contains({lat:t.latLng[0],lng:t.latLng[1]})}asNativeBounds(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new google.maps.LatLngBounds(new google.maps.LatLng(k(e[0]),k(e[1],void 0,i)),new google.maps.LatLng(k(t[0]),k(t[1],void 0,i)))}getCenter(){const e=this.realmap.getCenter();return[k(e.lat()),k(e.lng())]}getZoom(){return C(this.realmap.getZoom())}unbindAll(){this.listenersToDeregister.forEach((e=>e())),this.customMarkerOverlay&&this.customMarkerOverlay.unbindAll(),this.realmap.unbindAll()}asBounds(e){if(e){const t=e.getSouthWest(),i=e.getNorthEast(),r=this.getCenter();return{sw:[k(t.lat()),k(t.lng())],ne:[k(i.lat()),k(i.lng())],center:r}}}containerBounds(e){if(this.customMarkerOverlay){const t=this.customMarkerOverlay.getProjection();if(t){const i=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2)),r=t.fromContainerPixelToLatLng(new google.maps.Point(e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2));return{sw:[k(i.lat()),k(i.lng())],ne:[k(r.lat()),k(r.lng())],center:[k(i.lat()+(i.lat()-r.lat())/2),k(r.lng()+(r.lng()-i.lng())/2)]}}}}_boundsForOneCoordinate(e){return e.getNorthEast().equals(e.getSouthWest())}_extendsOneCoordinateBounds(e){let t=new google.maps.LatLng(e.getNorthEast().lat()+.01,e.getNorthEast().lng()+.01),i=new google.maps.LatLng(e.getNorthEast().lat()-.01,e.getNorthEast().lng()-.01);e.extend(t),e.extend(i)}computeNativeBoundsFromLatLongs(e){if(e.length>0){let t=new google.maps.LatLngBounds;return e.forEach((e=>{const[i,r]=M(e);t.extend(new google.maps.LatLng(i,r))})),t}}fitLatLongs(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.realmap){const r=this._parseClientPadding(i),{zoom:n,center:s}=this._getPaddedZoomAndCenterFromLatLongs(e,t,r)||{};if(void 0!==n&&void 0!==s){const e=this._updateViewport.bind(this),t=this.asBounds.bind(this);return this._fitViewport(n,s).then(e).then(t)}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}nativeBounds(){var e,t;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getProjection())||void 0===e||null===(e=e.getVisibleRegion())||void 0===e?void 0:e.latLngBounds)||(null===(t=this.realmap)||void 0===t?void 0:t.getBounds())}switchMarkerType(e,t){super.switchMarkerType(e,t)&&this.customMarkerOverlay&&this._updateMarkerPositionOnLayer(e,this.customMarkerOverlay.getProjection())}onMarkerIconsChanged(e){this._updateMarkerPositionOnLayer(e,this.customMarkerOverlay.getProjection())}_fitViewport(e,t){if(void 0!==e||t){const{fitBoundsAnimTime:i}=this.settings.googleMaps,r=i||500,[n,s]=this.getCenter(),l={tilt:0,heading:0,zoom:this.getZoom(),center:{lat:n,lng:s}},[u,h]=t,d={zoom:e,center:{lat:u,lng:h}},c=this;o.Geo.areLongitudesCrossingDateLine([s,h])&&(s<0?l.center.lng+=360:l.center.lng-=360);const g=this.addEventListener.bind(this),m=()=>new Promise((e=>{new p(l).to(d,r).easing(a.Exponential.Out).onUpdate((()=>{let e=l;l.center.lng<-180?e={zoom:l.zoom,center:{lat:l.center.lat,lng:l.center.lng+360}}:l.center.lng>180&&(e={zoom:l.zoom,center:{lat:l.center.lat,lng:l.center.lng-360}}),c.boundChangedDisabled=!0,c.realmap.moveCamera(e)})).onComplete((()=>{g(c.realmap,j.idle,(()=>{c.boundChangedDisabled=!1,e()}),!0)})).start(),requestAnimationFrame((function e(t){requestAnimationFrame(e),f(t)}))}));return this.idle?m():new Promise((e=>g(this.realmap,j.idle,(()=>m().then(e)),!0)))}return Promise.resolve()}_zoomAndCenterFromViewport(e,t){if(e){const{center:i,zoom:r,sw:n,ne:s,coordinates:o,useBoundsComputation:a,options:l}=e,u=this._parseClientPadding(t);if(i&&r)return this._getPaddedZoomAndCenterForCenterAndZoom(i,r,u);if(n&&s){const e=M(n),t=M(s);return this._getPaddedZoomAndCenterForBounds(e,t,!1,u)}if(o&&a){const e=this._computeNativeBounds(o,a,l),{zoom:t,center:i}=this._computeZoomAndCenterFromGmapsBounds(e,!1,u)||{};if(t&&i)return L(t,i,u)}else if(P(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLongs(e,!0,u)}}_getPaddedZoomAndCenterForCenterAndZoom(e,t,i){return L(t,e,i)}_getPaddedZoomAndCenterForBounds(e,t,i,r){let n=new google.maps.LatLngBounds(new google.maps.LatLng(e[0],e[1]),new google.maps.LatLng(t[0],t[1]));const{zoom:s,center:o}=this._computeZoomAndCenterFromGmapsBounds(n,i,r)||{};if(s&&o)return L(s,o,r)}_getPaddedZoomAndCenterFromLatLongs(e,t,i){const{zoom:r,center:n}=this._computeZoomAndCenterFromGmapsBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,i)||{};if(r&&n)return L(r,n,i)}_computeZoomAndCenterFromGmapsBounds(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=e;this._boundsForOneCoordinate(r)&&(r=new google.maps.LatLngBounds(r.getSouthWest(),r.getNorthEast()),this._extendsOneCoordinateBounds(r));const{padding:n}=this.settings.googleMaps,s=_(this.node,r.getSouthWest().lat(),r.getSouthWest().lng(),r.getNorthEast().lat(),r.getNorthEast().lng(),{zoomMax:21,padding:t?n:0,parsedClientPadding:i});if(isFinite(s))return{zoom:s,center:M([r.getCenter().lat(),r.getCenter().lng()])}}getTileDim(){return{width:N,height:K}}fitBounds(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;if(this.realmap){const n=this._parseClientPadding(r),s=M(e),o=M(t),{zoom:a,center:l}=this._getPaddedZoomAndCenterForBounds(s,o,i,n)||{};if(void 0!==a&&void 0!==l){const e=this.getZoom(),[t,i]=this.getCenter();if(t!==l[0]||i!==l[1]||e!==a){const e=this._updateViewport.bind(this),t=this.asBounds.bind(this);return this._fitViewport(a,l).then(e).then(t)}}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}addEventListener(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this._isAdvancedMarkerApiLoaded()&&e instanceof google.maps.marker.AdvancedMarkerElement){if(t===S.mouseEnter||t===S.mouseLeave||t===S.keyPress){var n;const s=null===(n=e.content)||void 0===n||null===(n=n.parentNode)||void 0===n?void 0:n.parentNode;return s?this._addEventListener(s,t,i,r):()=>0}if(r){const e="https://developers.google.com/maps/documentation/javascript/reference/advanced-markers#AdvancedMarkerElement.addEventListener";return this.logger.error(`Adding one time listener ${t} on advanced google maps marker is not supported yet.\n          Check when method comp.addEventListener() will be officially released on ${e}.`),()=>0}{const r=e.addListener(t,i);return()=>r.remove()}}return e instanceof google.maps.Polygon||Object.values(j).includes(t)?this._addGoogleMapsEventListener(e,t,i,r):this._addEventListener(e,t,i,r)}_addEventListener(e,t,i){let r=arguments.length>4?arguments[4]:void 0;return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?e.addEventListenerOnce(t,i,r):e.addEventListener(t,i,r),()=>e.removeEventListener(t,i)}_addGoogleMapsEventListener(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?google.maps.event.addListenerOnce(e,t,i):google.maps.event.addListener(e,t,i);return()=>google.maps.event.removeListener(r)}_createPopup(){const e=this._createGenericPopup(this._getMainParent());o.HtmlUtils.setDisplayNone(e),e.zIndexElement=e,e.visibleElement=e,e.cssElement=e,e.listening=e,e.clean=B(e.listening,!1,(()=>e.feature),this.settings,this.getEventManagementMethods());const{maxZIndex:t}=this.settings;return T(e,t+1),e}_createDebugMarker(e){return this.settings.debugMarkersPosition?{debug:new google.maps.Marker({position:new google.maps.LatLng(e.latLng[0],e.latLng[1]),map:this.realmap}),style:"opacity: 0.5"}:{}}_clearObfuscateArea(e){const{obfuscateArea:t}=e;t&&(t.setMap(null),delete e.obfuscateArea)}_createClickableObfuscatedPolygon(e,t){return this._createObfuscatedPolygon(e,t,!0)}_createNonClickableObfuscatedPolygon(e,t){return this._createObfuscatedPolygon(e,t,!1)}_createObfuscatedPolygon(e,t,i){const r=this.getCirclePolygonData(t),n=new google.maps.Polygon({paths:r,map:this.realmap.data.getMap(),clickable:i});return e.obfuscateArea=n,this._updateObfuscateAreaStyle(t,n),n}_updateObfuscateAreaStyle(e,t){var i,r,n,s,o;const{key:a,value:l}=y(this.settings.obfuscateStyle[e.type],e.hashKeys);t.setOptions({fillColor:null==l||null===(i=l.fill)||void 0===i?void 0:i.color,fillOpacity:null==l||null===(r=l.fill)||void 0===r?void 0:r.opacity,strokeColor:null==l||null===(n=l.line)||void 0===n?void 0:n.color,strokeOpacity:null==l||null===(s=l.line)||void 0===s?void 0:s.opacity,strokeWeight:null==l||null===(o=l.line)||void 0===o?void 0:o.weight}),t.styleKey=a}hasObfuscatedAreaStyleChanged(e){var t,i;return(null===(t=e.marker)||void 0===t?void 0:t.obfuscateArea)&&(null===(i=e.marker)||void 0===i||null===(i=i.obfuscateArea)||void 0===i?void 0:i.styleKey)!==v(this.settings.obfuscateStyle[e.type],e.hashKeys)}_getMainParent(){var e;return(null===(e=this.customMarkerOverlay)||void 0===e||null===(e=e.getPanes())||void 0===e?void 0:e.overlayMouseTarget)||this.temporaryDiv}stopPropagation(e){e.stopPropagation&&e.stopPropagation(),e.stop&&(e.stop(),this.ignoreMapClickEvent=!0)}getEventManagementMethods(){return{addEventListener:this.addEventListener.bind(this),stopPropagation:this.stopPropagation.bind(this),handleClick:this.handleClick.bind(this),handleMouseOver:this.handleMouseOver.bind(this),handleMouseOut:this.handleMouseOut.bind(this),handleKeyPress:this.handleKeyPress.bind(this)}}_createMarkerOnMap(e,t,i){const[r,n]=t,s=this.useAdvancedMarkers?new google.maps.marker.AdvancedMarkerElement({position:new google.maps.LatLng(r,n),map:this.realmap,content:e.content}):e.content;return this.useAdvancedMarkers?(e.advancedMarker=!0,delete e.zIndexElement,i||(e.listening=s)):e.position=new google.maps.LatLng(r,n),s}createPinMarker(e,t,i){return this._createPinMarker(e,t,i)}createPinObfuscatedMarker(e,t,i){return this._createPinMarker(e,t,i,this._createNonClickableObfuscatedPolygon.bind(this))}_getMarkerParent(){return this.useAdvancedMarkers?void 0:this._getMainParent()}_switchAriaLabel(e,t,i){if(this._isAdvancedMarkerApiLoaded()&&t.ariaElement instanceof google.maps.marker.AdvancedMarkerElement){const r=t.ariaElement;i&&(e&&i.onSelect?r.title=i.onSelect:i.default?r.title=i.default:delete r.title)}else R(e,t,i)}_createPinMarker(e,t,i,r){const{feature:n}=e,{debug:s,style:o}=this._createDebugMarker(n),a=this.uniqId(`marker-${this.asKey(n)}`);this.useAdvancedMarkers||e.cssClasses.push("dom-marker");const l=F(a,e,this._getMarkerParent(),t,i,o,this.settings,r);l.debug=s;const u=this._createMarkerOnMap(l,n.latLng);return D(u,l,e,this.settings,this.getEventManagementMethods(),this._switchAriaLabel.bind(this)),u.advancedMarker&&(l.ariaElement=u),u}createTextMarker(e,t,i){return this._createTextMarker(e,t,i)}createPriceObfuscatedMarker(e,t){return this._createTextMarker(e,t,"price",this._createNonClickableObfuscatedPolygon.bind(this))}_createTextMarker(e,t,i,r){const{feature:n}=e,{debug:s,style:o}=this._createDebugMarker(n),a=this.uniqId(`marker-${this.asKey(n)}`);this.useAdvancedMarkers||e.cssClasses.push("dom-marker");const l=O(a,e,this._getMarkerParent(),t,i,o,this.settings,r);l.debug=s;const u=this._createMarkerOnMap(l,n.latLng);return D(u,l,e,this.settings,this.getEventManagementMethods(),this._switchAriaLabel.bind(this)),u.advancedMarker&&(l.ariaElement=u),u}createClusterMarker(e){const{featureType:t,qualifier:i}=e,r=this.uniqId(`marker-${t}-cluster-${e.id}`),{debug:n,style:s}=this._createDebugMarker(e),a=E(r,this._getMarkerParent(),e,t,i,s);this.useAdvancedMarkers||o.HtmlUtils.addClass(a.content,"dom-marker"),a.debug=n;const l=this._createMarkerOnMap(a,e.latLng),{zIndexes:u}=this.settings,h=m(u[e.type],e.hashKeys),d={default:e.text,onSelect:e.text};return D(l,a,{feature:e,zIndex:h,ariaLabels:d},this.settings,this.getEventManagementMethods(),this._switchAriaLabel.bind(this)),l.advancedMarker&&(a.ariaElement=l),l}createObfuscatedMarker(e){const{feature:t}=e,{debug:i,style:r}=this._createDebugMarker(t),n=this.uniqId(`marker-${this.asKey(t)}`);this.useAdvancedMarkers||e.cssClasses.push("dom-marker");const s=I(n,e,this._getMarkerParent(),r,this.settings,this._createClickableObfuscatedPolygon.bind(this));s.debug=i;const o=this._createMarkerOnMap(s,t.latLng,!0);return D(o,s,e,this.settings,this.getEventManagementMethods(),this._switchAriaLabel.bind(this)),o.advancedMarker&&(s.ariaElement=o),o}resetRouteStyle(){}_createPolyline(e,t,i){const r={path:e,geodesic:null!=i&&i};switch(t.lineStyle){case"none":break;case"dash":r.icons=[{icon:{path:"M 0,-1 0,1",fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width},offset:"0",repeat:4*t.width+"px"}],r.strokeOpacity=0;break;case"dot":r.icons=[{icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:t.color,fillOpacity:t.opacity,strokeColor:t.color,strokeOpacity:t.opacity,scale:t.width/2},offset:"0",repeat:2*t.width+"px"}],r.strokeOpacity=0;break;default:r.strokeColor=t.color,r.strokeWeight=t.width,r.strokeOpacity=t.opacity}return new google.maps.Polyline(r)}addRouteOnMap(e,t){return new Promise((i=>{var r;null===(r=t.route)||void 0===r||delete r.copyrights;const n="flying"==e.mode;e.polyline=this._createPolyline(t.route.path,this.settings.routeLineStyleByDistanceMode[e.mode],n),e.polyline.setMap(this.realmap),i(e)}))}removeRouteOnMap(e){return new Promise((t=>{var i;null===(i=e.polyline)||void 0===i||i.setMap(null),t()}))}addPolygonsOnMap(e){const t=e.map((e=>{let{polygonDisplayed:t,style:i}=e;const{id:r,type:n,polygon:s}=t,o=this._createPolygon(s,i);o.forEach((e=>e.setMap(this.realmap)));const a={id:r,type:n},l=this.asKey(a);return this.visiblePolygonsByKey.set(l,o),a}));return Promise.resolve(t)}removePolygonsOnMap(e){const t=e.map((e=>{const t=this.asKey(e),i=this.visiblePolygonsByKey.get(t);if(i)return i.forEach((e=>e.setMap(null))),this.visiblePolygonsByKey.delete(t),e})).filter((e=>void 0!==e));return Promise.resolve(t)}_createPolygon(e,t){return x(e).map((e=>{const i={clickable:!1,paths:1===e.length?e[0]:e,strokeColor:t.line.color,strokeOpacity:t.line.opacity,strokeWeight:t.line.weight,fillColor:t.fill.color,fillOpacity:t.fill.opacity};return new google.maps.Polygon(i)}))}forceMapModeView(){var e;null===(e=this.realmap)||void 0===e||null===(e=e.getStreetView())||void 0===e||e.setVisible(!1)}}return window.egmapsGoogleMaps=n,{}}())},78717:function(e,t,i){var r;window,e.exports=(r=i(39437),function(){var e={518:function(e){e.exports=r}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,i),s.exports}i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};i.r(n),i.d(n,{MapBox:function(){return ae}});var s=i(518),o=6371008.8,a={centimeters:637100880,centimetres:637100880,degrees:360/(2*Math.PI),feet:20902260.511392,inches:39.37*o,kilometers:6371.0088,kilometres:6371.0088,meters:o,metres:o,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:o/1852,radians:1,yards:6967335.223679999};function l(e,t,i={}){const r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=t||{},r.geometry=e,r}function u(e,t,i={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(e[0])||!f(e[1]))throw new Error("coordinates must contain numbers");return l({type:"Point",coordinates:e},t,i)}function h(e,t,i={}){if(e.length<2)throw new Error("coordinates must be an array of two or more positions");return l({type:"LineString",coordinates:e},t,i)}function d(e,t="kilometers"){const i=a[t];if(!i)throw new Error(t+" units is invalid");return e*i}function c(e,t="kilometers"){const i=a[t];if(!i)throw new Error(t+" units is invalid");return e/i}function p(e){return e%(2*Math.PI)*180/Math.PI}function g(e){return e%360*Math.PI/180}function f(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function m(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return[...e.geometry.coordinates];if("Point"===e.type)return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function y(e,t,i={}){if(!0===i.final)return function(e,t){let i=y(t,e);return i=(i+180)%360,i}(e,t);const r=m(e),n=m(t),s=g(r[0]),o=g(n[0]),a=g(r[1]),l=g(n[1]),u=Math.sin(o-s)*Math.cos(l),h=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(o-s);return p(Math.atan2(u,h))}function v(e,t,i,r={}){const n=m(e),s=g(n[0]),o=g(n[1]),a=g(i),l=c(t,r.units),h=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(a));return u([p(s+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(h))),p(h)],r.properties)}function b(e,t,i={}){var r=m(e),n=m(t),s=g(n[1]-r[1]),o=g(n[0]-r[0]),a=g(r[1]),l=g(n[1]),u=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(a)*Math.cos(l);return d(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),i.units)}var k=function(e,t,i={}){var r;const n=("Feature"===(r=e).type?r.geometry:r).coordinates;let s=0;for(let o=0;o<n.length&&!(t>=s&&o===n.length-1);o++){if(s>=t){const e=t-s;if(e){const t=y(n[o],n[o-1])-180;return v(n[o],e,t,i)}return u(n[o])}s+=b(n[o],n[o+1],i)}return u(n[n.length-1])};function M(e,t,i){if(null!==e)for(var r,n,s,o,a,l,u,h,d=0,c=0,p=e.type,g="FeatureCollection"===p,f="Feature"===p,m=g?e.features.length:1,y=0;y<m;y++){a=(h=!!(u=g?e.features[y].geometry:f?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<a;v++){var b=0,k=0;if(null!==(o=h?u.geometries[v]:u)){l=o.coordinates;var P=o.type;switch(d=!i||"Polygon"!==P&&"MultiPolygon"!==P?0:1,P){case null:break;case"Point":if(!1===t(l,c,y,b,k))return!1;c++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===t(l[r],c,y,b,k))return!1;c++,"MultiPoint"===P&&b++}"LineString"===P&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(n=0;n<l[r].length-d;n++){if(!1===t(l[r][n],c,y,b,k))return!1;c++}"MultiLineString"===P&&b++,"Polygon"===P&&k++}"Polygon"===P&&b++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(k=0,n=0;n<l[r].length;n++){for(s=0;s<l[r][n].length-d;s++){if(!1===t(l[r][n][s],c,y,b,k))return!1;c++}k++}b++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===M(o.geometries[r],t,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function P(e,t){var i,r,n,s,o,a,l,u,h,d,c=0,p="FeatureCollection"===e.type,g="Feature"===e.type,f=p?e.features.length:1;for(i=0;i<f;i++){for(a=p?e.features[i].geometry:g?e.geometry:e,u=p?e.features[i].properties:g?e.properties:{},h=p?e.features[i].bbox:g?e.bbox:void 0,d=p?e.features[i].id:g?e.id:void 0,o=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,n=0;n<o;n++)if(null!==(s=l?a.geometries[n]:a))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(s,c,u,h,d))return!1;break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===t(s.geometries[r],c,u,h,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,c,u,h,d))return!1;c++}}function L(e,t){P(e,(function(e,i,r,n,s){var o,a=null===e?null:e.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==t(l(e,r,{bbox:n,id:s}),i,0)&&void 0}switch(a){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var u=0;u<e.coordinates.length;u++){var h=e.coordinates[u];if(!1===t(l({type:o,coordinates:h},r),i,u))return!1}}))}function C(e,t,i){var r=i,n=!1;return function(e,t){L(e,(function(e,i,r){var n=0;if(e.geometry){var s=e.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var o,a=0,l=0,u=0;return!1!==M(e,(function(s,d,c,p,g){if(void 0===o||i>a||p>l||g>u)return o=s,a=i,l=p,u=g,void(n=0);var f=h([o,s],e.properties);if(!1===t(f,i,r,g,n))return!1;n++,o=s}))&&void 0}}}))}(e,(function(e,s,o,a,l){r=!1===n&&void 0===i?e:t(r,e,s,o,a,l),n=!0})),r}var _=function(e,t={}){return C(e,((e,i)=>{const r=i.geometry.coordinates;return e+b(r[0],r[1],t)}),0)};function w(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function x(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?w(Object(i),!0).forEach((function(t){F(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function F(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const{firstDefinedValue:O,firstDefinedValueAndKey:E,firstDefinedKey:I,removeDuplicates:S,roundLatOrLng:D,roundLatLng:A,isArray:T,getPaddedZoomAndCenter:B,roundZoom:R}=s.Utils,{createPinMarker:N,createTextMarker:K,createClusterMarker:V,createObfuscatedMarker:j,events:z,finalizeMarkerCreation:$,cleanMarkerListeners:U,setMarkerZIndex:Z,registerCompListeners:H}=s.MarkerUtils,{computeZoomFromBBox:q,areBoundsCrossingDateLine:W,areCoordinatesCrossingDateLine:G}=s.Geo,Q="flying",X={height:512,width:512},Y=200,J="fill-color",ee="fill-opacity",te="line-color",ie="line-width",re="line-opacity",ne="visiblePolygons",se="obfuscatedPolygons",oe={scaleControl:e=>new mapboxgl.ScaleControl(e),navControl:e=>new mapboxgl.NavigationControl(e),geoLocateControl:e=>new mapboxgl.GeolocateControl(e),fullscreenControl:e=>new mapboxgl.FullscreenControl(e)};class ae extends s.BaseMap{constructor(e,t,i,r){super(e,t,i,r),this.TilesLoader=s.TilesLoader,this.logger=e.logger("MapBox"),this.logger.debug("MapBox constructor"),this.mapConfig={keyboard:!1},this.additionalConfig=this.settings.mapbox.mapboxAddConf,this.rtlTextPlugin=this.settings.mapbox.rtlTextPlugin,this.additionalConfig&&Object.assign(this.mapConfig,this.additionalConfig)}deleteMarker(e){const{marker:t}=e;t&&(t.remove(),t.debug&&t.debug.remove(),this._clearObfuscateArea(e),U(t),delete e.marker)}init(e,t){this.mapConfig.container=this.node;const i=this.configHelper.mapboxAccessToken();if(i)mapboxgl.accessToken=i;else if(!mapboxgl.accessToken)throw new Error("No mapbox access token set ! Mapbox cannot work properly !");const{zoom:r,center:n}=this._zoomAndCenterFromViewport(e,t)||{};r&&n&&(this.mapConfig.zoom=r-1,this.mapConfig.center=[n[1],n[0]]),this.realmap=new mapboxgl.Map(this.mapConfig),Object.keys(oe).forEach((e=>this._addControl(e,oe[e]))),this.mapNavFocusElement=this.realmap.getCanvas(),this._handleMapFocus(),this._registerMapListeners(),this.visiblePolygons=[],this.obfuscatedPolygons=[];const s=[];s.push(this._initializeTilesLoader());const o=this._initializeRoutesSourcesAndLayers.bind(this),a=this._initializePolygonsSourcesAndLayers.bind(this,ne,this.visiblePolygons),l=this._initializePolygonsSourcesAndLayers.bind(this,se,this.obfuscatedPolygons),u=new Promise((e=>{this.realmap.on("load",(()=>{o(),a(),l(),e()}))}));return this.configHelper.readParam("map,mapInitWaitForTiles")&&s.push(u),this.popup=this._createPopup(),Promise.all(s)}_addControl(e,t){const i=this.configHelper.readParam(`mapbox,${e}`);if(i.ctrlEnabled){const e=t(i.ctrlOptions),r=i.ctrlPosition;this.realmap.addControl(e,r)}}registerListenerOnMapFocusElement(e,t){this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,e,t))}_handleMapFocus(){if(this.keyboardFeatures&&this.mapNavFocusElement){const e=()=>this.keyboardFeatures.refreshKeyboardNavIconVisibility();this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,z.focus,e));const t=()=>this.keyboardFeatures.refreshKeyboardNavIconVisibility(!1);this.listenersToDeregister.push(this.addEventListener(this.mapNavFocusElement,z.focusOut,t))}}_initializeTilesLoader(){return new Promise((e=>{this.tilesLoader=new this.TilesLoader(this.settings,this.createTileFeature.bind(this),this.removeTileFeature.bind(this),this._updateViewport.bind(this),this.handleTilesLoaded.bind(this),this.handleTilesContentLoaded.bind(this),1),this.realmap.on("data",(e=>{if(e&&e.coord&&"source"===e.dataType&&e.coord.canonical){const t=e.coord.canonical;this.tilesLoader.loadTile(t.x,t.y,t.z,1)}})),e()}))}resetRouteStyle(){Object.keys(this.routesSources).forEach((e=>{this.realmap.removeLayer(this.routesSources[e].id),this.realmap.addLayer(this._createRouteLayer(e))}))}_createRouteLayer(e){const t=this.settings.routeLineStyleByDistanceMode[e],i={id:`layer-${e}`,type:"line",source:e,data:{type:"FeatureCollection",features:[]},paint:{"line-color":t.color,"line-opacity":t.opacity,"line-width":t.width}};switch(t.lineStyle){case"dash":i.paint["line-dasharray"]=[2,2];break;case"dot":i.paint["line-dasharray"]=[1,1]}return this.routesSources[e]=i,i}_initializePolygonsSourcesAndLayers(e,t){this.realmap.addSource(e,{type:"geojson",data:{type:"FeatureCollection",features:t}}),this.realmap.addLayer({id:`${e}Fill`,type:"fill",source:e,layout:{},paint:{[J]:["get",J],[ee]:["get",ee]}}),this.realmap.addLayer({id:`${e}Stroke`,type:"line",source:e,layout:{},paint:{[te]:["get",te],[ie]:["get",ie],[re]:["get",re]}})}_initializeRoutesSourcesAndLayers(){this.routesSources={},["cycling","driving","walking",Q].forEach((e=>{this.realmap.addSource(e,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.realmap.addLayer(this._createRouteLayer(e))}))}_handleMapClick(e){const{lngLat:{lat:t,lng:i},point:{x:r,y:n}}=e,s={position:{x:r,y:n},latLng:{lat:t,lng:i}};this.handleMapClick(s)}_registerMapListeners(){this.registeredEvents={},this.listenersToDeregister.push(...this._registerKeyboardListeners()),this.listenersToDeregister.push(this._registerIdleListener()),this.listenersToDeregister.push(this._registerZoomListener()),this.listenersToDeregister.push(...this._registerListenerForBoundsChanged("dragend","drag")),this.listenersToDeregister.push(...this._registerListenerForBoundsChanged("pitchend","pitch")),this.listenersToDeregister.push(...this._registerListenerForBoundsChanged("rotatend","rotate")),this.listenersToDeregister.push(...this._registerListenerForBoundsChanged("touchend","touch")),this.listenersToDeregister.push(this._registerMapListener("dragstart",this.handleDragStart.bind(this))),this.listenersToDeregister.push(this._registerMapListener("style.load",this.setLocale.bind(this))),this.listenersToDeregister.push(this._registerMapListener("click",this._handleMapClick.bind(this))),this.listenersToDeregister.push(this._registerTilesLoadedListener())}_registerTilesLoadedListener(){return this.tilesLoadedCount=0,this._registerMapListener("sourcedata",(()=>{this.tilesLoadedCount++;const e=(t,i)=>()=>{t>0&&t===i.tilesLoadedCount?(i.tilesLoadedCount=0,i.handleTilesLoaded("mapProvider","map")):i.tilesLoadedCount>0&&setTimeout(e(i.tilesLoadedCount,i),500)};setTimeout(e(this.tilesLoadedCount,this),500)}))}_registerKeyboardListeners(){const e={duration:Y},t=this.realmap.zoomIn.bind(this.realmap),i=this.realmap.zoomOut.bind(this.realmap);this.keyboardListeners=new s.KeyboardListeners((t=>this.realmap.panBy(t,e)),t,i);const r=this.handleBoundsChanged.bind(this);return[this.addEventListener(this.mapNavFocusElement,z.keyDown,this.keyboardListeners.keyDownListenerCallback),this.addEventListener(this.mapNavFocusElement,z.keyUp,this.keyboardListeners.keyUpListenerCallback),this.addEventListener(this.mapNavFocusElement,z.keyPress,this.keyboardListeners.keyPressListenerCallback),this._registerMapListener("idle",(()=>{S(this.keyboardListeners.extractKeyboardEvent("center_changed")).forEach(r)}))]}_registerZoomListener(){this.lastZoomValueChecked=this.getZoom();const e=this.handleBoundsChanged.bind(this),t=this.getZoom.bind(this);return this._registerMapListener("zoomend",(()=>{const i=t(),r=i>this.lastZoomValueChecked;this.lastZoomValueChecked=i;const n=this.keyboardListeners.extractKeyboardEvent("zoom_changed");n.length>0?S(n).forEach(e):e(r?"zoomIn":"zoomOut")}))}_registerMapListener(e,t,i){return i?(this.realmap.on(e,i,t),()=>this.realmap.off(e,i,t)):(this.realmap.on(e,t),()=>this.realmap.off(e,t))}_registerListenerForBoundsChanged(e,t){const i=this.handleBoundsChanged.bind(this);return this.registeredEvents[e]=[],[this._registerMapListener(e,(i=>{i.originalEvent&&this.registeredEvents[e].push(t)})),this._registerMapListener("idle",(()=>S(this.registeredEvents[e].splice(0)).forEach(i)))]}_registerIdleListener(){return this._registerMapListener("idle",(()=>this.eventsManager.pushEvent(s.EventTypes.idle)))}unbindAll(){this.listenersToDeregister.forEach((e=>e())),this.realmap&&this.realmap.remove()}addEventListener(e,t,i){return arguments.length>3&&void 0!==arguments[3]&&arguments[3]?e.addEventListenerOnce(t,i):e.addEventListener(t,i),()=>e.removeEventListener(t,i)}centerAndZoomMap(e,t,i){let[r,n]=e?A(e):[],s=t;const o={};if(void 0!==r&&void 0!==n&&void 0!==s&&void 0!==i){const o=this._parseClientPadding(i),{zoom:a,center:l}=this._getPaddedZoomAndCenterForCenterAndZoom(e,t,o)||{};void 0!==a&&void 0!==l&&([r,n]=l,s=a-1)}if(void 0!==r&&void 0!==n){const e=this.realmap.getCenter(),[t,i]=A([e.lat,e.lng]);t===r&&i===n||(o.center=new mapboxgl.LngLat(n,r))}return s&&this.getZoom()!==s&&(o.zoom=s),!(!o.center&&!o.zoom||(this.boundChangedDisabled=!0,this.realmap.once("moveend",(()=>{this._updateViewport()})),this.realmap.easeTo(x({duration:Y},o)),0))}asNativeBounds(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new mapboxgl.LngLatBounds(new mapboxgl.LngLat(D(e[1],void 0,i),D(e[0],void 0,!1)),new mapboxgl.LngLat(D(t[1],void 0,i),D(t[0],void 0,!1)))}isFeatureInRealBound(e,t){const i=e.contains([t.latLng[1],t.latLng[0]]);if(!i){if(e.getNorthEast().lng>180)return e.contains([t.latLng[1]+360,t.latLng[0]]);if(e.getSouthWest().lng<-180)return e.contains([t.latLng[1]-360,t.latLng[0]])}return i}getCenter(){const e=this.realmap.getCenter();return[e.lat,e.lng]}getRectOfMarker(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{clientWidth:i,clientHeight:r}=this.getMarkerElement(e),n=this.realmap.project(e.marker.getLngLat());return s.HtmlUtils.getRect(n,i+2*t,r+2*t)}getZoom(){return R(this.realmap.getZoom())}asBounds(e){if(e){const t=e.getSouthWest(),i=e.getNorthEast(),r=this.getCenter();return{sw:[D(t.lat),D(t.lng)],ne:[D(i.lat),D(i.lng)],center:r}}}containerBounds(e){if(this.realmap){const t=this.realmap.unproject([e.offsetLeft-e.offsetWidth/2,e.offsetTop+e.offsetHeight/2]),i=this.realmap.unproject([e.offsetLeft+e.offsetWidth/2,e.offsetTop-e.offsetHeight/2]);return{sw:[D(t.lat),D(t.lng)],ne:[D(i.lat),D(i.lng)],center:[D(t.lat+(t.lat-i.lat)/2),D(i.lng+(i.lng-t.lng)/2)]}}}computeNativeBoundsFromLatLongs(e){if((null==e?void 0:e.length)>0){const t=this._computeNativeBoundsFromLatLongsAux(e);if(G(e)){const i=this._computeNativeBoundsFromLatLongsAux(e.filter((e=>{var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])<0}))),r=this._computeNativeBoundsFromLatLongsAux(e.filter((e=>{var t;return(null!==(t=e.lng)&&void 0!==t?t:e[1])>=0})));return this.asNativeBounds(A([t.getSouthWest().lat,r.getSouthWest().lng]),A([i.getNorthEast().lat,i.getNorthEast().lng]))}return t}}_computeNativeBoundsFromLatLongsAux(e){let t=new mapboxgl.LngLatBounds;return e.forEach((e=>{const[i,r]=A(e);t=t.extend(new mapboxgl.LngLat(r,i))})),t}_zoomAndCenterFromViewport(e,t){if(e){const{center:i,zoom:r,sw:n,ne:s,coordinates:o,useBoundsComputation:a,options:l}=e,u=this._parseClientPadding(t);if(i&&r)return this._getPaddedZoomAndCenterForCenterAndZoom(i,r,u);if(n&&s){const e=A(n),t=A(s);return this._getPaddedZoomAndCenterForBounds(e,t,!1,u)}if(o&&a){const e=this._computeNativeBounds(o,a,l),{zoom:t,center:i}=this._computeZoomAndCenterFromMapboxBounds(e,!1,u)||{};if(void 0!==t&&void 0!==i)return B(t+1,i,u)}else if(T(e)&&e.length>0)return this._getPaddedZoomAndCenterFromLatLongs(e,!0,u)}}_getPaddedZoomAndCenterForCenterAndZoom(e,t,i){return B(t+1,e,i)}_getPaddedZoomAndCenterForBounds(e,t,i,r){let n=new mapboxgl.LngLatBounds(new mapboxgl.LngLat(e[1],e[0]),new mapboxgl.LngLat(t[1],t[0]));const{zoom:s,center:o}=this._computeZoomAndCenterFromMapboxBounds(n,i,r)||{};if(void 0!==s&&void 0!==o)return B(s+1,o,r)}_getPaddedZoomAndCenterFromLatLongs(e,t,i){const{zoom:r,center:n}=this._computeZoomAndCenterFromMapboxBounds(this.computeNativeBoundsFromLatLongs(this.boundsComputation.computeBoundingBox(e)),t,i)||{};if(void 0!==r&&void 0!==n)return B(r+1,n,i)}_computeZoomAndCenterFromMapboxBounds(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=e;this._boundsForOneCoordinate(r)&&(r=new mapboxgl.LngLatBounds(r.getSouthWest(),r.getNorthEast()),r=this._extendsOneCoordinateBounds(r)),r=this._fixDatelineBoundsForMapboxInternalMethods(r);const n=q(this.node,r.getSouthWest().lat,r.getSouthWest().lng,r.getNorthEast().lat,r.getNorthEast().lng,{zoomMax:22,padding:t?this.configHelper.readParam("mapbox,padding"):0,worldDimensions:X,parsedClientPadding:i});if(isFinite(n))return{zoom:n,center:A([r.getCenter().lat,r.getCenter().lng])}}_extendsOneCoordinateBounds(e){let t=new mapboxgl.LngLat(e.getNorthEast().lng+.01,e.getNorthEast().lat+.01),i=new mapboxgl.LngLat(e.getNorthEast().lng-.01,e.getNorthEast().lat-.01);return e.extend(t).extend(i)}_boundsForOneCoordinate(e){return e.getNorthEast().lat===e.getSouthWest().lat&&e.getNorthEast().lng===e.getSouthWest().lng}_fixDatelineBoundsForMapboxInternalMethods(e){const t=e.getSouthWest(),i=e.getNorthEast();return W(t,i)?this.asNativeBounds([t.lat,t.lng],[i.lat,i.lng+360],!1):e}fitLatLongs(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.realmap){this.boundChangedDisabled=!0;const r=this._parseClientPadding(i),{zoom:n,center:s}=this._getPaddedZoomAndCenterFromLatLongs(e,t,r)||{};if(void 0!==n&&void 0!==s){const e={center:new mapboxgl.LngLat(s[1],s[0]),zoom:n-1};return new Promise((t=>{this.realmap.once("moveend",(()=>{this._updateViewport().then((e=>t(this.asBounds(e))))})),this.realmap.easeTo(x({duration:Y},e))}))}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}refresh(){this.realmap.resize(),super.refresh()}nativeBounds(){if(this.realmap)return this.realmap.getBounds()}getTileDim(){return{width:X.width,height:X.height}}fitBounds(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;if(this.realmap){this.boundChangedDisabled=!0;const n=this._parseClientPadding(r),s=A(e),o=A(t),{zoom:a,center:l}=this._getPaddedZoomAndCenterForBounds(s,o,i,n)||{};if(void 0!==a&&void 0!==l){const e=this.getZoom(),[t,i]=this.getCenter();if(t!==l[0]||i!==l[1]||e!==a-1){const e={center:new mapboxgl.LngLat(l[1],l[0]),zoom:a-1};return new Promise((t=>{this.realmap.once("moveend",(()=>{this._updateViewport().then((e=>t(this.asBounds(e))))})),this.realmap.easeTo(x({duration:Y},e))}))}this.boundChangedDisabled=!1}return Promise.resolve(this.getBounds())}return Promise.reject("map is not ready")}getMarkerElement(e){var t;return null===(t=e.marker)||void 0===t?void 0:t.getElement()}moveMarkerPosition(e,t){const i=this.realmap.project(e.marker.getLngLat());i.x+=t.x,i.y+=t.y;const r=this.realmap.unproject(i);e.marker.setLngLat(r)}updatePopupPositionOnLayer(){const{feature:e}=this.popup||{};if(e&&e.defined){let t,i;switch(O(this.settings.popupPositions[e.type],e.hashKeys)){case"above":default:t=0,i=-24;break;case"below":t=0,i=5+this.popup.getElement().offsetHeight}this.popup.setOffset([t,i]),this.popup.setLngLat([this.popup.feature.latLng[1],this.popup.feature.latLng[0]])}}_updateViewport(e){return this.realmap?super._updateViewport(e).then((e=>(this._updateMarkerPositionFromCollision(),e))):Promise.resolve(e)}ensurePopupVisibility(){const{popup:{feature:e,visibleElement:{offsetWidth:t,offsetHeight:i}},node:{offsetWidth:r,offsetHeight:n}}=this,s=O(this.configHelper.popupVisibilityPaddings()[e.type],e.hashKeys),o=null==s?void 0:s.x,a=null==s?void 0:s.y,l="below"===O(this.settings.popupPositions[e.type],e.hashKeys),u=l?1:-1,h=this.getRectOfMarker(e).height,d=this.realmap.project(e.marker.getLngLat());let c={x:d.x-t/2,y:d.y+h*u+i*u};const[p,g]=this._calculatePopupVisibilityOffsetValues(c,o,a,r,n,t,i,l);if(0!==p||0!==g){const e=this.realmap.project(this.realmap.getCenter()),t=this.realmap.unproject([e.x+p,e.y+g]);this.realmap.easeTo(t,{duration:Y})}}_createPopup(){const e=this._createGenericPopup(void 0),t=new mapboxgl.Marker({element:e,anchor:"bottom"}).setLngLat([0,0]).addTo(this.realmap);return s.HtmlUtils.setDisplayNone(e),t.content=e.content,t.cssElement=e,t.visibleElement=e,t.zIndexElement=e,t.listening=e,U(t),t.clean=H(t.listening,!1,(()=>t.feature),this.settings,this.getEventManagementMethods()),Z(t,this.settings.maxZIndex+1),t}_clearObfuscateArea(e){const t=this.asKey(e);this.obfuscatedPolygons.findIndex((e=>e.feature_id==t))>=0&&(this.obfuscatedPolygons=this.obfuscatedPolygons.filter((e=>e.feature_id!==t)),this._updateObfuscatedPolygonsSource())}_newFixMarkerToUse(){var e=()=>super._newFixMarkerToUse,t=this;return function(){e().call(t)(...arguments),t._updateObfuscatedPolygonsSource()}}_updateObfuscatedPolygonsSource(){this._updatePolygonsSource(se,this.obfuscatedPolygons)}_updateVisiblePolygonsSource(){this._updatePolygonsSource(ne,this.visiblePolygons)}_updatePolygonsSource(e,t){var i;if("function"==typeof(null===(i=this.realmap)||void 0===i?void 0:i.getSource)){var r;const i=null===(r=this.realmap)||void 0===r?void 0:r.getSource(e);null==i||i.setData({type:"FeatureCollection",features:t})}}hasObfuscatedAreaStyleChanged(e){let t=this.obfuscatedPolygons.findIndex((t=>t.feature_id===this.asKey(e)));if(t>=0){const i=I(this.settings.obfuscateStyle[e.type],e.hashKeys);return this.obfuscatedPolygons[t].properties.styleKey!==i}return!1}_getPolygonStyle(e){return{[J]:e.fill.color,[ee]:e.fill.opacity,[te]:e.line.color,[ie]:e.line.weight,[re]:e.line.opacity}}_createClickableObfuscatedPolygon(e,t){return this._createObfuscatedPolygon(e,t,!0)}_createNonClickableObfuscatedPolygon(e,t){return this._createObfuscatedPolygon(e,t,!1)}_createObfuscatedPolygon(e,t,i){const r=this.asKey(t),n=this.getCirclePolygonData(t),{key:s,value:o}=E(this.settings.obfuscateStyle[t.type],t.hashKeys);let a=this.obfuscatedPolygons.findIndex((e=>e.feature_id==r));if(a<0){const e={feature_id:r,type:"Feature",properties:x({styleKey:s},this._getPolygonStyle(o)),geometry:{type:"Polygon",coordinates:[n.map((e=>[e.lng,e.lat]))]}};this.obfuscatedPolygons.push(e)}else this.obfuscatedPolygons[a].properties=this._getPolygonStyle(o),this._updateObfuscatedPolygonsSource()}_createDebugMarker(e){return this.settings.debugMarkersPosition?{debug:(new mapboxgl.Marker).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap),style:"opacity: 0.5"}:{}}stopPropagation(e){e.stopPropagation()}getEventManagementMethods(){return{addEventListener:this.addEventListener.bind(this),stopPropagation:this.stopPropagation.bind(this),handleClick:this.handleClick.bind(this),handleMouseOver:this.handleMouseOver.bind(this),handleMouseOut:this.handleMouseOut.bind(this),handleKeyPress:this.handleKeyPress.bind(this)}}createPinMarker(e,t,i){return this._createPinMarker(e,t,i)}createPinObfuscatedMarker(e,t,i){return this._createPinMarker(e,t,i,this._createObfuscatedPolygon.bind(this))}_createPinMarker(e,t,i,r){const{feature:n}=e,{debug:s,style:o}=this._createDebugMarker(n),a=this.uniqId(`marker-${this.asKey(n)}`),l=N(a,e,void 0,t,i,o,this.settings,r);l.debug=s;const u=new mapboxgl.Marker({element:l.content,anchor:"bottom"}).setLngLat([n.latLng[1],n.latLng[0]]).addTo(this.realmap);return $(u,l,e,this.settings,this.getEventManagementMethods(),this._switchAriaLabel),u}createTextMarker(e,t,i){return this._createTextMarker(e,t,i)}createPriceObfuscatedMarker(e,t){return this._createTextMarker(e,t,"price",this._createNonClickableObfuscatedPolygon.bind(this))}_createTextMarker(e,t,i,r){const{feature:n}=e,{debug:s,style:o}=this._createDebugMarker(n),a=this.uniqId(`marker-${this.asKey(n)}`),l=K(a,e,void 0,t,i,o,this.settings,r);l.debug=s;const u=new mapboxgl.Marker({element:l.content,anchor:"bottom"}).setLngLat([n.latLng[1],n.latLng[0]]).addTo(this.realmap);return $(u,l,e,this.settings,this.getEventManagementMethods(),this._switchAriaLabel),u}createClusterMarker(e){const{debug:t,style:i}=this._createDebugMarker(e),{featureType:r,qualifier:n}=e,s=this.uniqId(`marker-${r}-cluster-${e.id}`),o=V(s,void 0,e,r,n,i);o.debug=t;const a=new mapboxgl.Marker({element:o.content}).setLngLat([e.latLng[1],e.latLng[0]]).addTo(this.realmap),l=O(this.settings.zIndexes[e.type],e.hashKeys),u={default:e.text,onSelect:e.text};return $(a,o,{feature:e,zIndex:l,ariaLabels:u},this.settings,this.getEventManagementMethods(),this._switchAriaLabel),a}createObfuscatedMarker(e){const{feature:t}=e,{debug:i,style:r}=this._createDebugMarker(t),n=this.uniqId(`marker-${this.asKey(t)}`),s=j(n,e,void 0,r,this.settings,this._createClickableObfuscatedPolygon.bind(this));s.debug=i;const o=new mapboxgl.Marker({element:s.content}).setLngLat([t.latLng[1],t.latLng[0]]).addTo(this.realmap);return $(o,s,e,this.settings,this.getEventManagementMethods(),this._switchAriaLabel),o}setLocale(){if(this.settings.locale){const e=this.settings.locale.substring(0,2);"unavailable"===mapboxgl.getRTLTextPluginStatus()&&mapboxgl.setRTLTextPlugin(this.rtlTextPlugin,null,!0);const t=this.realmap.getStyle().layers.filter((e=>/-label/.test(e.id)));for(let i of t)this.realmap.setLayoutProperty(i.id,"text-field",["coalesce",["get","name_"+e],["get","name"]])}}_genGeodesicRoute(e,t){try{const i={type:"Feature",geometry:{type:"LineString",coordinates:[e,t]}},r=_(i),n=[],s=500;for(let e=0;e<r;e+=r/s){const t=k(i,e);n.push(t.geometry.coordinates)}return n.length>1&&n[0][0]<0&&n[1][0]>0&&(n[0][0]+=360),n}catch(e){this.logger.error("failed to generate geodesic line. use straight line",e)}}addRouteOnMap(e,t){return new Promise((i=>{const r=this.routesSources[e.mode];if(r){const{path:i}=t.route;let n=i.map((e=>{let{lat:t,lng:i}=e;return[i,t]}));e.mode===Q&&2==n.length&&(n=this._genGeodesicRoute(n[0],n[1])||n),r.data.features.push({id:e.id,type:"Feature",geometry:{type:"LineString",coordinates:n}}),this.realmap.getSource(e.mode).setData(r.data)}i(e)}))}removeRouteOnMap(e){return new Promise(((t,i)=>{const r=this.routesSources[e.mode];if(r){const i=r.data.features.findIndex((t=>t.id===e.id));i>=0&&(r.data.features.splice(i,1),this.realmap.getSource(e.mode).setData(r.data)),t()}else i(new Error(`can't find source for ${e.mode}`))}))}updateMapProviderConfig(){}addPolygonsOnMap(e){const t=e.map((e=>{let{polygonDisplayed:t,style:i}=e;const{id:r,type:n,polygon:s}=t,o={feature_id:this.asKey({id:r,type:n}),type:"Feature",properties:this._getPolygonStyle(i),geometry:s};return this.visiblePolygons.push(o),{id:r,type:n}}));return this._updateVisiblePolygonsSource(),Promise.resolve(t)}removePolygonsOnMap(e){const t=e.map((e=>{const t=this.asKey(e),i=this.visiblePolygons.findIndex((e=>e.feature_id==t));if(i>=0)return this.visiblePolygons.splice(i,1),e})).filter((e=>void 0!==e));return e.length>0&&this._updateVisiblePolygonsSource(),Promise.resolve(t)}forceMapModeView(){}}return window.egmapsMapbox=n,{}}())}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/shopping-pwa/eg-maps.246120779cc1632143a9.js.map
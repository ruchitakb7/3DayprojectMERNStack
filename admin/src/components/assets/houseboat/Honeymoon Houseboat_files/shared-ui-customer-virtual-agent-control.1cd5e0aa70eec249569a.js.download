/*@license For license information please refer to shared-ui-customer-virtual-agent-control.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2362],{314:function(n,e,t){t.d(e,{Jx:function(){return I},ki:function(){return S}});var o=t(96540),i=t(15043),r=t(1723),l=t(36360),a=t(2619),u=t(48826);function c(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}function s(n,e,t,o,i,r,l){try{var a=n[r](l),u=a.value}catch(c){return void t(c)}a.done?e(u):Promise.resolve(u).then(o,i)}function v(n){return function(){var e=this,t=arguments;return new Promise((function(o,i){var r=n.apply(e,t);function l(n){s(r,o,i,l,a,"next",n)}function a(n){s(r,o,i,l,a,"throw",n)}l(void 0)}))}}function d(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function p(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),o.forEach((function(e){d(n,e,t[e])}))}return n}function f(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})),n}function h(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,i,r=[],l=!0,a=!1;try{for(t=t.call(n);!(l=(o=t.next()).done)&&(r.push(o.value),!e||r.length!==e);l=!0);}catch(u){a=!0,i=u}finally{try{l||null==t.return||t.return()}finally{if(a)throw i}}return r}}(n,e)||function(n,e){if(!n)return;if("string"==typeof n)return c(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function P(n,e){var t,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=l.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(n,l)}catch(a){r=[6,a],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function y(){var n=b(["\n  query ChatbotConfigQuery($context: ContextInput!, $applicationName: String!) {\n    chatbotConfig(context: $context, applicationName: $applicationName) {\n      authToken\n      channelOriginId\n      chatbotCapabilities\n      conversationProperties {\n        launchPoint\n        traceId\n      }\n      enableAutoOpenChatWidget\n      enableProactiveConversation\n      version {\n        javascriptUrl {\n          value\n        }\n        versionId\n      }\n    }\n  }\n"]);return y=function(){return n},n}function g(){var n=b(["\n  query localChatClient {\n    localChatClientState @client {\n      requested\n      isEventHandlerRegistered\n    }\n  }\n"]);return g=function(){return n},n}function C(){return(C=v((function(n){var e,t;return P(this,(function(o){return(null===(e=window)||void 0===e?void 0:e.virtualAgentControl)?[2,window.virtualAgentControl]:(null===(t=window)||void 0===t?void 0:t.VacClientAdapter)?[2,window.VacClientAdapter.getInstance(n)]:[2,void 0]}))}))).apply(this,arguments)}function O(){return w.apply(this,arguments)}function w(){return(w=v((function(){var n,e,t,o,i,r;return P(this,(function(l){switch(l.label){case 0:return(i=null===(n=window)||void 0===n?void 0:n.virtualAgentControl)?[4,window.virtualAgentControl.isInitialized]:[3,2];case 1:i=l.sent(),l.label=2;case 2:return i?[2,window.virtualAgentControl]:(null===(t=window)||void 0===t||null===(e=t.VirtualAgentControl)||void 0===e?void 0:e.initialized)&&(null===(o=window)||void 0===o?void 0:o.VacClientAdapter)?[4,window.VirtualAgentControl.initialized]:[3,6];case 3:return l.sent()?[4,window.VacClientAdapter.getInstance()]:[3,6];case 4:return[4,(r=l.sent()).isInitialized];case 5:if(l.sent())return[2,r];l.label=6;case 6:return[2,void 0]}}))}))).apply(this,arguments)}function I(n){return m.apply(this,arguments)}function m(){return(m=v((function(n){var e,t,o,i,r;return P(this,(function(l){switch(l.label){case 0:return[4,O()];case 1:return e=l.sent(),o=(t=n||{}).intentMessage,i=t.conversationProperties,r=t.silent,e&&(o||i)&&e.setConversationContext({intentMessage:o,conversationProperties:i},r),[2]}}))}))).apply(this,arguments)}var A=(0,i.J1)(y()),_=(0,i.J1)(g()),T={__typename:"LocalChatClientState",requested:!1},S=function(n){var e,t,i,c,s,v,d=n.applicationName,b=n.clientOverrides,P=n.pageName,y=n.skipSsr,g=(0,l.R)().context,w=(0,a.useLogger)(),I=w.error,m=w.info,S=g.locale,E={context:g,applicationName:d},N=h(o.useState(),2),k=N[0],j=N[1],D=h(o.useState(!1),2),R=D[0],L=D[1],x=h((0,u.A9)(),2)[1],V=Boolean(k),B=(0,r.I)(A,{variables:E,ssr:!y,skip:V}).data,H=(0,r.I)(_,{ssr:!y}),M=H.data,q=H.client,z=function(){x({type:"virtualAgentInitialized"})},W=function(){return I("STRATBOT_VAC_SCRIPT_FAILED_TO_LOAD")};o.useEffect((function(){var n;if(!k)if(!(null===(n=B)||void 0===n?void 0:n.chatbotConfig)||M&&M.localChatClientState.requested||R)O().then((function(n){n&&(j(n),z())}));else{var e;L(!0),q.writeQuery({query:_,data:f(p({},B||{}),{localChatClientState:f(p({},T),{requested:!0,isEventHandlerRegistered:!0})})});var t=B.chatbotConfig,o=B.chatbotConfig.version.javascriptUrl,i=(null===(e=b)||void 0===e?void 0:e.authToken)||function(n){if("function"==typeof window.atob){var e=window.atob(n);return JSON.parse(e)}}(t.authToken),r=function(n,e,t,o,i){var r,l,a,u,c,s,v,d,p,f,h,b,P,y,g,C,O,w,I,m,A,_,T,S,E,N,k,j,D,R,L,x,V,B,H,M,q,z,W,U,F,G,$,J,K,Q,X,Y,Z,nn,en,tn,on,rn,ln,an,un,cn,sn,vn,dn,pn,fn,hn,bn,Pn,yn,gn,Cn,On,wn,In,mn,An,_n,Tn,Sn,En={authToken:o,channelOriginId:(null===(r=i)||void 0===r?void 0:r.channelOriginId)||n.channelOriginId,capabilities:n.chatbotCapabilities?(X=n.chatbotCapabilities,X.map((function(n){switch(n){case"CLICKSTREAM":return"Clickstream";case"GLASSBOX":return"Glassbox";default:return""}})).filter((function(n){return""!==n}))):[],containerElement:null===(l=i)||void 0===l?void 0:l.containerElement,conversationProperties:{launchPoint:(null===(u=i)||void 0===u||null===(a=u.conversationProperties)||void 0===a?void 0:a.launchPoint)||n.conversationProperties.launchPoint,traceId:n.conversationProperties.traceId,pageName:e},embedded:null===(c=i)||void 0===c?void 0:c.embedded,enableAutoOpenChatWidget:(null===(s=i)||void 0===s?void 0:s.enableAutoOpenChatWidget)||n.enableAutoOpenChatWidget,enableProactiveConversation:(null===(v=i)||void 0===v?void 0:v.enableProactiveConversation)||n.enableProactiveConversation,fastRender:"V2"===n.version.versionId,intentMessage:null===(d=i)||void 0===d?void 0:d.intentMessage,languageId:(null===(p=i)||void 0===p?void 0:p.languageId)||t,subscribedEvents:null===(f=i)||void 0===f?void 0:f.subscribedEvents,eventHandler:null===(h=i)||void 0===h?void 0:h.eventHandler,userProperties:null===(b=i)||void 0===b?void 0:b.userProperties,configurationOverrides:null===(P=i)||void 0===P?void 0:P.configurationOverrides};return(null===(g=i)||void 0===g||null===(y=g.conversationProperties)||void 0===y?void 0:y.skipWelcome)&&(En.conversationProperties.skipWelcome=null===(Z=i)||void 0===Z||null===(Y=Z.conversationProperties)||void 0===Y?void 0:Y.skipWelcome),(null===(O=i)||void 0===O||null===(C=O.conversationProperties)||void 0===C?void 0:C.listingId)&&(En.conversationProperties.listingId=null===(en=i)||void 0===en||null===(nn=en.conversationProperties)||void 0===nn?void 0:nn.listingId),(null===(I=i)||void 0===I||null===(w=I.conversationProperties)||void 0===w?void 0:w.checkin)&&(En.conversationProperties.checkin=null===(on=i)||void 0===on||null===(tn=on.conversationProperties)||void 0===tn?void 0:tn.checkin),(null===(A=i)||void 0===A||null===(m=A.conversationProperties)||void 0===m?void 0:m.checkout)&&(En.conversationProperties.checkout=null===(ln=i)||void 0===ln||null===(rn=ln.conversationProperties)||void 0===rn?void 0:rn.checkout),(null===(T=i)||void 0===T||null===(_=T.conversationProperties)||void 0===_?void 0:_.adults)&&(En.conversationProperties.adults=null===(un=i)||void 0===un||null===(an=un.conversationProperties)||void 0===an?void 0:an.adults),(null===(E=i)||void 0===E||null===(S=E.conversationProperties)||void 0===S?void 0:S.children)&&(En.conversationProperties.children=null===(sn=i)||void 0===sn||null===(cn=sn.conversationProperties)||void 0===cn?void 0:cn.children),(null===(k=i)||void 0===k||null===(N=k.conversationProperties)||void 0===N?void 0:N.pets)&&(En.conversationProperties.pets=null===(dn=i)||void 0===dn||null===(vn=dn.conversationProperties)||void 0===vn?void 0:vn.pets),(null===(D=i)||void 0===D||null===(j=D.conversationProperties)||void 0===j?void 0:j.currency)&&(En.conversationProperties.currency=null===(fn=i)||void 0===fn||null===(pn=fn.conversationProperties)||void 0===pn?void 0:pn.currency),(null===(L=i)||void 0===L||null===(R=L.conversationProperties)||void 0===R?void 0:R.device)&&(En.conversationProperties.device=null===(bn=i)||void 0===bn||null===(hn=bn.conversationProperties)||void 0===hn?void 0:hn.device),(null===(V=i)||void 0===V||null===(x=V.conversationProperties)||void 0===x?void 0:x.bookNow)&&(En.conversationProperties.bookNow=null===(yn=i)||void 0===yn||null===(Pn=yn.conversationProperties)||void 0===Pn?void 0:Pn.bookNow),(null===(H=i)||void 0===H||null===(B=H.conversationProperties)||void 0===B?void 0:B.havId)&&(En.conversationProperties.havId=null===(Cn=i)||void 0===Cn||null===(gn=Cn.conversationProperties)||void 0===gn?void 0:gn.havId),(null===(q=i)||void 0===q||null===(M=q.conversationProperties)||void 0===M?void 0:M.site)&&(En.conversationProperties.site=null===(wn=i)||void 0===wn||null===(On=wn.conversationProperties)||void 0===On?void 0:On.site),(null===(W=i)||void 0===W||null===(z=W.conversationProperties)||void 0===z?void 0:z.hostname)&&(En.conversationProperties.hostname=null===(mn=i)||void 0===mn||null===(In=mn.conversationProperties)||void 0===In?void 0:In.hostname),(null===(F=i)||void 0===F||null===(U=F.conversationProperties)||void 0===U?void 0:U.chatbotName)&&(En.conversationProperties.chatbotName=null===(_n=i)||void 0===_n||null===(An=_n.conversationProperties)||void 0===An?void 0:An.chatbotName),(null===($=i)||void 0===$||null===(G=$.conversationProperties)||void 0===G?void 0:G.chatbotEntryPoint)&&(En.conversationProperties.chatbotEntryPoint=null===(Sn=i)||void 0===Sn||null===(Tn=Sn.conversationProperties)||void 0===Tn?void 0:Tn.chatbotEntryPoint),(null===(J=i)||void 0===J?void 0:J.conversationId)&&(null===(K=i)||void 0===K?void 0:K.participantId)&&(null===(Q=i)||void 0===Q?void 0:Q.mode)&&(En.conversationId=i.conversationId,En.participantId=i.participantId,En.mode=i.mode),En}(t,P,S,i,b);document.head.appendChild(function(n,e,t){var o=document.createElement("script");return o.src=n,o.onload=e,o.onerror=t,o}(o.value,(function(){(function(n){return C.apply(this,arguments)})(i).then((function(n){n?n.initialize(r).then((function(){O().then((function(n){n?(j(n),z(),m("STRATBOT_VAC_INIT_SUCCEEDED")):I("STRATBOT_VAC_INIT_NO_VALID_CHAT_CLIENT_FOUND")}))})).catch((function(n){I("STRATBOT_VAC_INIT_FAILED",n)})):I("STRATBOT_VAC_FAILED_TO_FIND_INSTANCE_TO_INIT")})).catch((function(n){I("STRATBOT_VAC_ERROR_GETTING_INSTANCE_TO_INIT",n)}))}),W))}}),[k,B,M,R,q,P,S,b,z,I,m,W]),o.useEffect((function(){var n=b||{},e=n.intentMessage,t=n.conversationProperties,o=n.silent;if(k&&(e||t)){var i=Object.assign(t||{},{pageName:P});k.setConversationContext({intentMessage:e,conversationProperties:i},o)}}),[null===(t=b)||void 0===t||null===(e=t.intentMessage)||void 0===e?void 0:e.intent,null===(c=b)||void 0===c||null===(i=c.conversationProperties)||void 0===i?void 0:i.launchPoint,null===(v=b)||void 0===v||null===(s=v.conversationProperties)||void 0===s?void 0:s.skipWelcome]);var U=b||{},F=U.subscribedEvents,G=U.eventHandler,$=o.useMemo((function(){return G}),[]);return o.useEffect((function(){return function(n,e,t,o){var i,r;n&&e&&t&&!1===(null===(r=o)||void 0===r||null===(i=r.localChatClientState)||void 0===i?void 0:i.isEventHandlerRegistered)&&n.on(e,t)}(k,F,$,M),function(){!function(n,e,t,o,i,r){t&&r&&o&&i&&(t.off(o,i),e.writeQuery({query:n,data:{localChatClientState:f(p({},r.localChatClientState),{isEventHandlerRegistered:!1})}}))}(_,q,k,F,$,M)}}),[k,F,$,M,q]),null};S.displayName="sharedui-VirtualAgentControl"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/shopping-pwa/shared-ui-customer-virtual-agent-control.1cd5e0aa70eec249569a.js.map
/*@license For license information please refer to shared-ui-flights-fare-calendar.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2769],{33055:function(e,t,n){n.d(t,{Yk:function(){return P},x3:function(){return A}});var r=n(96540),a=n(20181),o=n.n(a),i=n(15204),c=n(24355),u=n(75826),l=n(1192),s=n(68963),d=n(10159),f=n(15043),g=n(77969),C=n(8142),D=n.n(C),p=n(36360),h=n(2619);function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){m(e,t,n[t])}))}return e}function O(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(u){c=!0,a=u}finally{try{i||null==n.return||n.return()}finally{if(c)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(){var e,t,n=(e=['\n  query FareCalendarQuery(\n    $context: ContextInput!\n    $journeyCriteria: [FlightsJourneyCriteriaInput!]!\n    $flightsSearchContext: FlightsSearchContextInput!\n  ) {\n    flightsFareCalendar(context: $context, journeyCriteria: $journeyCriteria, flightsSearchContext: $flightsSearchContext) {\n      disclaimerText\n      priceLockupText\n      coverageAnalytics {\n        linkName\n        referrerId\n      }\n      datePickerCellContents {\n        date {\n          formatted(format: "yyyy-MM-dd")\n        }\n        accessibility\n        selectAnalytics {\n          linkName\n          referrerId\n        }\n        content {\n          price {\n            amount\n            formatted\n          }\n          priceTheme\n          valueText\n        }\n      }\n    }\n  }\n'],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return F=function(){return n},n}function S(e){var t=Date.parse(e);if(Number.isNaN(t)||!function(e){return/^(\d{4})-(\d{2})-(\d{2})$/.test(e)||/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\dZ$/.test(e)}(e))throw Error("Failed to convert ".concat(e," to a valid date."));var n,r=new Date(e);return n=r,new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())}function B(){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function E(e,t){var n=Math.floor((t.getTime()-e.getTime())/864e5);return n>0?"+".concat(n):"".concat(n)}var _=function(e,t){var n=e?"ONE_WAY":"ROUND_TRIP",r=e?"OW":"RT";return{onChangeEndDateCB:{id:"".concat(n,"_FC_onChangeEndDateCB"),description:"Returning date Change"},onChangeMonthCB:{id:"".concat(n,"_FC_onChangeMonthCB"),description:"Month changed"},onChangeStartDateCB:{id:"".concat(n,"_FC_onChangeStartDateCB"),description:"Departing date Change"},onOpenCB:{id:"".concat(n,"_FC_onOpenCB"),description:"Open Date Picker"},onDismissCB:{id:"".concat(n,"_FC_onDismissCB"),description:"Close Date Picker"},onSubmitCB:{id:"".concat(n,"_FC_onSubmitCB"),description:"Save Dates"},onDoneButtonCB:{id:"FLT.FareCalendar.Done",description:"Done Button Clicked"},onChangeFlexStartDateCB:{id:"FLT.".concat(r,".FareCalendar.DateChange.OB.").concat(t),description:"Outbound Date Change"},onChangeFlexEndDateCB:{id:"FLT.".concat(r,".FareCalendar.DateChange.IB.").concat(t),description:"Inbound Date Change"}}},T=(0,f.J1)(F()),k=function(){var e=b(r.useState({datePickerContent:{},concatenatedResult:{}}),2),t=e[0],n=e[1],a=b(r.useState(""),2),o=a[0],i=a[1],c=b(r.useState(""),2),u=c[0],s=c[1],d=b(r.useState({}),2),f=d[0],C=d[1],y=b(r.useState({}),2),m=y[0],F=y[1],E=b(r.useState(!1),2),_=E[0],k=E[1],P=b(r.useState(""),2),x=P[0],w=P[1],A=b(r.useState(!1),2),M=A[0],N=A[1],R=(0,p.R)().context,j=(0,l.useLocalization)().formatDate,L=(0,h.useLogger)().error,I=b((0,g._)(T,{ssr:!1,fetchPolicy:"no-cache"}),2),Y=I[0],W=I[1],U=W.data,$=W.error;r.useEffect((function(){if(w(""),_||n({datePickerContent:{},concatenatedResult:{}}),$&&L("FARE_CALENDAR_FETCH_ERROR"),(null==U?void 0:U.flightsFareCalendar)&&U.flightsFareCalendar.datePickerCellContents.length>0){var e=b(function(e){var t={},n={},r={};return e.flightsFareCalendar.datePickerCellContents.map((function(e){var a;return t[null===(a=e.date)||void 0===a?void 0:a.formatted]={className:e.content.priceTheme.toLowerCase(),ariaLabel:e.accessibility,text:e.content.valueText},n[e.date.formatted]={analytics:{referrerId:e.selectAnalytics.referrerId,linkName:e.selectAnalytics.linkName}},r[e.date.formatted]={price:e.content.price?e.content.price.amount:e.content.valueText,priceWithCurrency:e.content.valueText},[t,n,r]})),[t,n,r]}(U),3),r=e[0],a=e[1],o=e[2];D()(t.datePickerContent,r)||n({datePickerContent:r,concatenatedResult:_?v({},t.concatenatedResult,r):r}),U.flightsFareCalendar.priceLockupText?(N(!0),w(U.flightsFareCalendar.priceLockupText)):(N(!1),w(U.flightsFareCalendar.disclaimerText)),i(U.flightsFareCalendar.coverageAnalytics.referrerId),s(U.flightsFareCalendar.coverageAnalytics.linkName),C(a),F(o)}}),[U,$,L]);var H=function(e,t){var n,r,a,o,i=B(),c=e<i?i:e,u=c;return t&&(n=j(e,{raw:"yyyy-MM-dd"}),r=14,a=S(n),(o=S(n)).setDate(a.getDate()+r),u=o),{departureDate:c,returnDate:u}};return[function(e,t,n,r,a,o){k(o);var i=H(r,a),c=i.departureDate,u=i.returnDate,l=[{departureDate:{day:c.getDate(),month:c.getMonth()+1,year:c.getFullYear()},destination:t,origin:e}];c!==u&&(l=[{departureDate:{day:c.getDate(),month:c.getMonth()+1,year:c.getFullYear()},destination:t,origin:e},{departureDate:{day:u.getDate(),month:u.getMonth()+1,year:u.getFullYear()},destination:e,origin:t}]);var s=O(v({},{context:R,journeyCriteria:l,flightsSearchContext:{tripType:n}}),{context:R});Y({variables:s})},t.concatenatedResult,x,o,u,f,m,M]},P=function(e){return e.ONE_WAY="ONE_WAY",e.ROUND_TRIP="ROUND_TRIP",e.FLEX_DATE_ONE_WAY="OW",e.FLEX_DATE_ROUND_TRIP="RT",e}(P||{}),x=function(e,t){return e?t(e,{raw:"yyyy-MM-dd"}):""},w=function(e){var t=e.destination,n=e.dateFieldProps,a=e.endDate,s=e.firstDayOfWeek,d=e.onChange,f=e.onMountCB,g=e.origin,C=e.singleMode,D=e.startDate,p=e.tripType,h=e.onSubmitAnalytics,y=e.dialogWrapper,m=e.openDialog,F=e.dismissDialog,T=e.onOpenCB,P=e.autoOpen,w=e.onDoneButtonClickCB,A=e.singleTrigger,M=b(function(e,t,n){var r=b(k(),8),a=r[0];return[function(r,o,i){a(e,t,n,r,o,i)},r[1],r[2],r[3],r[4],r[5],r[6],r[7]]}(g,t,p),8),N=M[0],R=M[1],j=M[2],L=M[3],I=M[4],Y=M[5],W=M[6],U=M[7],$=b(r.useState(!1),2),H=$[0],z=$[1],K=r.useRef(!1),J=r.useRef(!1),V=b(r.useState(!1),2),X=V[0],q=V[1],Q=b(r.useState(!1),2),Z=Q[0],G=Q[1],ee=b(r.useState(!1),2),te=ee[0],ne=ee[1],re=b(r.useState(B()),2),ae=re[0],oe=re[1],ie=b(r.useState(B()),2),ce=ie[0],ue=ie[1],le=b(r.useState(""),2),se=le[0],de=le[1],fe=(0,l.useLocalization)().formatDate,ge=_(C),Ce=(0,u.KY)(),De=function(e){Ce(e.id,e.description)},pe=function(e){var t,n=null===(t=W[x(e,fe)])||void 0===t?void 0:t.priceWithCurrency;de(n&&"-"!==n?n:"")},he=function(){C||(ne(!0),N(ae,!0,!1),pe(ae))},ye=function(e){F(e),De(ge.onDismissCB),z(!1),K.current=!1},me=function(e,t){var n,r,a=x(e,fe),o=x(t,fe);return[{fieldName:"startDate",value:a,price:null===(n=W[a])||void 0===n?void 0:n.price},{fieldName:"endDate",value:o,price:null===(r=W[o])||void 0===r?void 0:r.price}]},ve=function(){if(h){L&&I&&Ce(L,I);var e="ONE_WAY"===p?ae:ce,t=x(e,fe);Y&&e&&Y[t]&&Ce(Y[t].analytics.referrerId,Y[t].analytics.linkName)}};r.useEffect((function(){oe(D?S(D):B()),ue(a?S(a):B()),pe(D?S(D):B())}),[D,a]),r.useEffect((function(){P&&(N(ae,!1,!1),z(!0))}),[]),r.useEffect((function(){C||pe(ce)}),[ce,W]);var Oe=o()((function(e){var t=x(e,fe);te||K.current||(null==R?void 0:R[t])||!J.current||N(e,te,!0),K.current&&(K.current=!1)}),1e3),be=O(v({},n),{routerLinkWrapper:function(e){return r.createElement(r.Fragment,null,e)},onChange:d,showDatePicker:n.showDatePicker?n.showDatePicker:H,endName:"endDate",startName:"startDate"}),Fe=x(new Date(ae.getFullYear(),ae.getMonth(),ae.getDate()),fe),Se=Z?Fe:"",Be={buttonText:n.buttonText,currentPrice:se,dateFieldProps:be,datePickerContent:R,daysBookableInAdvance:330,dialogWrapper:y,doubleMonths:!0,singleDateSelect:!0,endDate:a?x(new Date(ce.getFullYear(),ce.getMonth(),ce.getDate()),fe):"",firstDayOfWeek:s,footerText:j,singleMode:C,midnightBookingOffset:4,onDismissCB:ye,onOpenCB:function(e,t){m(e,t),q(t),pe(D?S(D):B()),z(!0),De(ge.onOpenCB),null==T||T(e),"end"===e?he():(N(new Date(ae.getFullYear(),ae.getMonth(),1),!1,!1),J.current=!0,K.current=!0)},onMountCB:f,onSubmitCB:function(e,t,n){if(e){var r=me(e,t);d(r),ne(!1),De(ge.onSubmitCB)}ve(),ye(n)},onChangeMonthCB:function(e){te&&"ROUND_TRIP"===p||N(e,te,!1),De(ge.onChangeMonthCB)},onChangeStartDateCB:function(e){oe(e),C&&pe(e),C||(ce&&e>ce&&(ue(new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)),J.current=!1),oe(e),G(!0),ne(!0),N(e,!0,!1)),De(ge.onChangeStartDateCB);var t=_(C,E(ae,e));De(t.onChangeFlexStartDateCB)},onChangeEndDateCB:function(e){ue(e),ne(!1),De(ge.onChangeEndDateCB);var t=_(C,E(ce,e));De(t.onChangeFlexEndDateCB)},startDate:D?Fe:Se,onSelectEndModeCB:he,onScrollHandler:Oe,onDoneButtonClickCB:function(e,t){ye(X),De(ge.onDoneButtonCB),ve();var n=me(e,t);null==w||w(e,n,t)},useSingleTrigger:A};return U?r.createElement(i.gs,v({},Be)):r.createElement(c.h,v({},Be))},A=function(e){var t,n,a,o,i,c,u,l,f=b((t=b((0,d.useDialog)("datepicker-start"),3),n=t[0],a=t[1],o=t[2],i=b((0,d.useDialog)("datepicker-end"),3),c=i[0],u=i[1],l=i[2],[function(e,t){return"end"===t?r.createElement(s.h,{isVisible:c},r.createElement(l,null,r.createElement(r.Fragment,null,e))):r.createElement(s.h,{isVisible:n},r.createElement(o,null,r.createElement(r.Fragment,null,e)))},function(e,t){t&&("end"===e?u.openDialog():a.openDialog())},function(e){e&&(c?u.closeDialog():a.closeDialog())}]),3),g=f[0],C=f[1],D=f[2];return r.createElement(w,v({},O(v({},e),{dialogWrapper:g,openDialog:C,dismissDialog:D})))};A.displayName="FareCalendar"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/shopping-pwa/shared-ui-flights-fare-calendar.bb2a5dd3e4c019c6e4e2.js.map
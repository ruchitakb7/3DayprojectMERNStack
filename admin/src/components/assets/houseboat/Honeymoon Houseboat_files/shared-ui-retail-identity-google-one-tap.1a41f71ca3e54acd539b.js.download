/*@license For license information please refer to shared-ui-retail-identity-google-one-tap.licenses.txt*/
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8695],{10452:function(n,e,t){t.d(e,{P:function(){return nn}});var o=t(96540),r=t(36360),a=t(15043),i=t(1723),c=t(75826),u=t(39938),l=t(85625);function s(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}function d(n,e,t,o,r,a,i){try{var c=n[a](i),u=c.value}catch(l){return void t(l)}c.done?e(u):Promise.resolve(u).then(o,r)}function v(n){return function(){var e=this,t=arguments;return new Promise((function(o,r){var a=n.apply(e,t);function i(n){d(a,o,r,i,c,"next",n)}function c(n){d(a,o,r,i,c,"throw",n)}i(void 0)}))}}function f(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function p(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),o.forEach((function(e){f(n,e,t[e])}))}return n}function g(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})),n}function y(n,e){if(null==n)return{};var t,o,r=function(n,e){if(null==n)return{};var t,o,r={},a=Object.keys(n);for(o=0;o<a.length;o++)t=a[o],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(o=0;o<a.length;o++)t=a[o],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function m(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,r,a=[],i=!0,c=!1;try{for(t=t.call(n);!(i=(o=t.next()).done)&&(a.push(o.value),!e||a.length!==e);i=!0);}catch(u){c=!0,r=u}finally{try{i||null==t.return||t.return()}finally{if(c)throw r}}return a}}(n,e)||function(n,e){if(!n)return;if("string"==typeof n)return s(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return s(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function b(n,e){var t,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(c){a=[6,c],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function O(){var n=_(["\n  fragment IdentityAnalyticsInteractionEventFragment on IdentityAnalyticsInteractionEvent {\n    eventName\n    eventVersion\n    payload\n  }\n"]);return O=function(){return n},n}function w(){var n=_(["\n  fragment IdentityAnalyticsOutcomeEventFragment on IdentityAnalyticsOutcomeEvent {\n    eventName\n    eventVersion\n    payload\n  }\n"]);return w=function(){return n},n}function I(){var n=_(["\n  fragment IdentityOneTapSubmitActionFragment on IdentityOneTapSubmitAction {\n    atoActions {\n      ... on IdentityCsrfWidgetAction {\n        inputKeys\n        token\n        type\n      }\n    }\n    nonce\n    context\n    clickStreamAnalytics {\n      ...IdentityAnalyticsInteractionEventFragment\n      ...IdentityAnalyticsOutcomeEventFragment\n    }\n  }\n  ","\n  ","\n"]);return I=function(){return n},n}function T(){var n=_(["\n  mutation GoogleOneTapSubmit($context: ContextInput!, $submitRequest: IdentitySubmitRequestInput!) {\n    googleOneTapSubmit(context: $context, submitRequest: $submitRequest) {\n      ... on IdentityGoogleOneTapMutationResponse {\n        analytics {\n          ...IdentityAnalyticsOutcomeEventFragment\n        }\n        cmsToken\n        flow\n        scenario\n        success\n        variant\n      }\n    }\n  }\n  ","\n"]);return T=function(){return n},n}function h(){var n=_(["\n  fragment IdentityAnalyticsImpressionEventFragment on IdentityAnalyticsImpressionEvent {\n    eventName\n    eventVersion\n    payload\n  }\n"]);return h=function(){return n},n}function E(){var n=_(["\n  fragment IdentityGoogleOneTapResponseFragment on IdentityGoogleOneTapResponse {\n    analytics {\n      ...IdentityAnalyticsImpressionEventFragment\n      ...IdentityAnalyticsInteractionEventFragment\n    }\n    configuration {\n      clientId\n    }\n    action {\n      ...IdentityOneTapSubmitActionFragment\n    }\n    allowIntelligentTrackingPrevention\n  }\n\n  ","\n  ","\n  ","\n"]);return E=function(){return n},n}function A(){var n=_(["\n  query GoogleOneTapQuery($context: ContextInput!) {\n    googleOneTap(context: $context) {\n      ...IdentityGoogleOneTapResponseFragment\n    }\n  }\n\n  ","\n"]);return A=function(){return n},n}var S,k,x,D,N=function(n){var e=function(n){var e=n.event_data.event,t=e.event_type,o=e.event_name,r=e.event_category,a=e.event_version,i=e.action_location,c=e.action_reason,u=e.event_producer,l=n.event_data.experience;return{event:{event_type:t,event_name:o,event_category:r,event_version:a,action_location:i,event_producer:u,action_reason:c},experience:{page_name:l.page_name,page_name_detailed:l.page_name_detailed}}}(n);return"additional_context"in n.event_data&&(e.additional_context=n.event_data.additional_context),"form"in n.event_data&&(e.form=n.event_data.form),"user"in n.event_data&&(e.user=n.event_data.user),"error_list"in n.event_data&&(e.error_list=n.event_data.error_list),e},P=function(n,e){var t=Array.isArray(e),o=t?function(n,e){var t;return null!==(t=n.find((function(n){return e.includes(n.eventName)})))&&void 0!==t?t:null}(n,e):function(n,e){var t;return null!==(t=n.find((function(n){return n.eventName===e})))&&void 0!==t?t:null}(n,e);if(null==o?void 0:o.payload){var r=t?o.eventName:e,a=function(n,e){try{var t=JSON.parse(n);return e in t.events?Object.values(t.events[e]).at(0):null}catch(o){return null}}(o.payload,r);return null!=a?a:null}return null},R=(S=1e3,k=function(n){n()},D=(x||{}).atBegin,function(n,e,t){var o,r=t||{},a=r.noTrailing,i=void 0!==a&&a,c=r.noLeading,u=void 0!==c&&c,l=r.debounceMode,s=void 0===l?void 0:l,d=!1,v=0;function f(){o&&clearTimeout(o)}function p(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var c=this,l=Date.now()-v;function p(){v=Date.now(),e.apply(c,r)}function g(){o=void 0}d||(u||!s||o||p(),f(),void 0===s&&l>n?u?(v=Date.now(),i||(o=setTimeout(s?g:p,n))):p():!0!==i&&(o=setTimeout(s?g:p,void 0===s?n-l:n)))}p.cancel=function(n){var e=(n||{}).upcomingOnly,t=void 0!==e&&e;f(),d=!t}}(S,k,{debounceMode:!1!==(void 0!==D&&D)}),{fragment:(0,a.J1)(O())}),j={fragment:(0,a.J1)(w())},L=(0,a.J1)(I(),R.fragment,j.fragment),C="__googleOneTapScript__",G="idle",F="loading",U="ready",W="error",J="load",q="error",M="google_onetap.failed",$=function(n){var e=n.variant,t=n.cmsToken,o=n.scenario,r=n.success,a="".concat(window.location.pathname).concat(window.location.search),i=encodeURIComponent(a);if(!r)return"/login/error?redirectTo=".concat(i,"&error=googleOneTap");switch(e){case"ONE_KEY":case"BETA_CONSENT_0":case"BETA_CONSENT_1":case"BETA_CONSENT_2":return"/onboarding?originUrl=".concat(i,"&cmsToken=").concat(t,"&scenario=").concat(o);case"ONE_IDENTITY_1":case"ONE_IDENTITY_0":case"ONE_IDENTITY_2":return function(n){var e=n.cmsToken,t=n.scenario,o=n.variant,r=n.accountMergeSharedUiExposure,a="".concat(window.location.pathname).concat(window.location.search),i=encodeURIComponent(a);return 1===(null==r?void 0:r.bucket)?"/accountmerge?redirectTo=".concat(i,"&token=").concat(e,"&scenario=").concat(t,"&variant=").concat(o):"/onboarding?originUrl=".concat(i,"&cmsToken=").concat(e,"&scenario=").concat(t)}(n);case"PASSWORD_1":case"PASSWORD_3":case"PASSWORD_0":case"PASSWORD_2":return"/addpassword?redirectTo=".concat(i,"&token=").concat(t,"&scenario=").concat(o,"&variant=").concat(e);case"PROFILE_DETAIL_0":case"PROFILE_DETAIL_1":return"/accountinfo?redirectTo=".concat(i,"&token=").concat(t,"&scenario=").concat(o,"&variant=").concat(e);case"PROFILE_DETAIL_2":return"/marketingconsent?redirectTo=".concat(i,"&token=").concat(t,"&scenario=").concat(o,"&variant=").concat(e);default:return null}},B=function(n){var e=$(n);null===e?window.location.reload():window.location.assign(e)},K=(0,a.J1)(T(),j.fragment),z=function(n){var e,t,r,a,i=n.disabled,u=n.googleAccountConfigs,l=n.disableCancelOnUnmount,s=void 0!==l&&l,d=n.initialize,v=void 0!==d&&d,f=n.analytics,g=(e="https://accounts.google.com/gsi/client",t=m((0,o.useState)(e?F:G),2),r=t[0],a=t[1],(0,o.useEffect)((function(){if(e){var n=document.querySelector('script[src="'.concat(e,'"]'));if(n)a(n.getAttribute("data-status")||G);else{(n=document.createElement("script")).src=e,n.async=!0,n.setAttribute("data-status",F),document.body.appendChild(n);var t=function(e){n&&n.setAttribute("data-status",e.type===J?U:W)};n.addEventListener(J,t),n.addEventListener(q,t)}var o=function(n){a(n.type===J?U:W)};return n.addEventListener(J,o),n.addEventListener(q,o),function(){n&&(n.removeEventListener(J,o),n.removeEventListener(q,o))}}a(G)}),[e]),r),y=(0,c.iQ)();return(0,o.useEffect)((function(){var n,e,t,o,r,a,c,l,d,m;v&&!(null===(n=window)||void 0===n?void 0:n[C])&&window.google&&"ready"===g&&(null===(a=window)||void 0===a||null===(r=a.google)||void 0===r||null===(o=r.accounts)||void 0===o||null===(t=o.id)||void 0===t||t.initialize(p({},u)),window[C]=!0);if(v&&(null===(e=window)||void 0===e?void 0:e[C])&&window.google&&"ready"===g&&!i)return null===(m=window)||void 0===m||null===(d=m.google)||void 0===d||null===(l=d.accounts)||void 0===l||null===(c=l.id)||void 0===c||c.prompt((function(n){if("user_cancel"===(null==n?void 0:n.getSkippedReason())){var e=P(f,"google_onetap.closed");e&&y(N(e))}if("tap_outside"===(null==n?void 0:n.getSkippedReason())){var t=P(f,"google_onetap.hidden");t&&y(N(t))}if(null==n?void 0:n.isDisplayed()){var o=P(f,"google_onetap.presented");o&&y(N(o))}})),function(){var n,e,t,o;s||(null===(o=window)||void 0===o||null===(t=o.google)||void 0===t||null===(e=t.accounts)||void 0===e||null===(n=e.id)||void 0===n||n.cancel())}}),[g,v,i,s]),null};function Q(n){var e=n.children,t=void 0===e?null:e,o=y(n,["children"]);return z(o),t}var Y={fragment:(0,a.J1)(h())},H=(0,a.J1)(E(),Y.fragment,R.fragment,L),V=function(n){var e=n.data,t=e.configuration,a=e.analytics,i=e.action,s=e.allowIntelligentTrackingPrevention,d=(null==t?void 0:t.clientId)||"",f=s||!1,y=m((0,o.useState)(!1),2),_=y[0],O=y[1];(0,o.useEffect)((function(){O(!0)}),[]);var w,I=(0,c.iQ)(),T=function(){var n,e=(0,r.R)().context,t=(0,l.useExperiment)("Onboarding_v2_Web").exposure,a=m((0,u.n)(K),1)[0],i=(0,c.iQ)(),s=(0,o.useCallback)((n=v((function(n,o){var r,c,u,l,s,d,v,f,y,m,_,O,w,I,T,h,E,A,S;return b(this,(function(b){switch(b.label){case 0:r=o.nonce,c=void 0===r?"":r,u=o.context,l=void 0===u?"":u,s=o.atoActions,d=void 0===s?[]:s,v=o.clickStreamAnalytics,f=(null==d?void 0:d.filter((function(n){return"IdentityCsrfWidgetAction"===n.__typename}))[0])||{},y={type:null==(k=f)?void 0:k.type,inputs:[{key:k.inputKeys[0],value:k[k.inputKeys[0]]}]},b.label=1;case 1:return b.trys.push([1,3,,4]),[4,a({variables:{context:e,submitRequest:{context:l,atoInputs:y,socialInput:{socialType:"GOOGLE",tokenType:"ID",token:n,nonce:c},input:[]}}})];case 2:return _=b.sent(),"IdentityGoogleOneTapMutationResponse"===(null==(O=_.data)||null===(m=O.googleOneTapSubmit)||void 0===m?void 0:m.__typename)&&(w=O.googleOneTapSubmit,I=w.analytics,T=w.variant,w.success?"ORIGIN"!==T?(h=P(I,"google_onetap.succeeded"))&&i(N(h)):(E=P(I,"sign_in.succeeded"))&&i(N(E)):(A=P(I,M))&&i(N(A)),B(g(p({},null==O?void 0:O.googleOneTapSubmit),{accountMergeSharedUiExposure:t}))),[3,4];case 3:return b.sent(),(S=P(v,M))&&i(N(S)),B({success:!1}),[3,4];case 4:return[2]}var k}))})),function(e,t){return n.apply(this,arguments)}),[e]);return{authenticateWithGoogleOneTap:s}}().authenticateWithGoogleOneTap,h=(w=v((function(n){var e,t;return b(this,(function(o){switch(o.label){case 0:return(e=P(null==i?void 0:i.clickStreamAnalytics,"google_onetap.submitted"))&&I(N(e)),(null==n?void 0:n.credential)?[4,T(n.credential,i)]:[3,2];case 1:return o.sent(),[3,3];case 2:(t=P(null==i?void 0:i.clickStreamAnalytics,M))&&I(N(t)),o.label=3;case 3:return[2]}}))})),function(n){return w.apply(this,arguments)});return o.createElement(Q,{googleAccountConfigs:{client_id:d,callback:h,nonce:null==i?void 0:i.nonce,itp_support:f,use_fedcm_for_prompt:!1},initialize:_,analytics:a})};V.fragment=H,V.displayName="IdentityGoogleOneTapResponse";var X=(0,a.J1)(A(),V.fragment),Z=function(n){var e,t=n.skipSsr,a=(0,r.R)().context,c={context:a},u=(0,i.I)(X,{context:a,variables:c,ssr:!t}),l=u.data,s=u.error;return u.loading||s||!l?null:"IdentityGoogleOneTapResponse"===(null===(e=l.googleOneTap)||void 0===e?void 0:e.__typename)?o.createElement(V,{data:l.googleOneTap}):null};Z.displayName="sharedui-GoogleOneTapQueryComponent";var nn=function(n){var e,t=n.skipSsr,a=(0,r.R)().context;return"AUTHENTICATED"===(null==a||null===(e=a.identity)||void 0===e?void 0:e.authState)?null:o.createElement(Z,{skipSsr:t})};nn.displayName="sharedui-GoogleOneTap"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/shopping-pwa/shared-ui-retail-identity-google-one-tap.1a41f71ca3e54acd539b.js.map